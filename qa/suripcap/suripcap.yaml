%YAML 1.1
---

- test: TLS 1
  filename: ../docker/pcaps/tls.pcap
  ruleset: none
  config: ../../suricata.yaml
  options: -k none
  app-layer-events:
    - name: tls
      flow: 5
      tx: 0
  metadata:
    - name: SELKS certificate
      event_type: tls
      count: 4
      filter: "tls.serial='00:97:E6:47:09:8E:EA:C9:B4' tls.issuerdn='C=FR, ST=IDF, L=Paris, O=Stamus, CN=SELKS'"
    - name: Session resumed
      event_type: tls
      count: 1
      filter: "tls.session_resumed=true"

- test: TCP DNS 1
  filename: ../docker/pcaps/tcp-dns.pcap
  ruleset: none
  config: ../../suricata.yaml
  options: -k none
  app-layer-events:
    - name: dns_tcp
      flow: 0
      tx: 0

# Should be working
#- test: TCP DNS 2
#  filename: ../docker/pcaps/tcp-dns.pcap
#  ruleset: none
#  config: ../../suricata.yaml
#  options: -k none --set 'app-layer.protocols.dns.tcp.detection-ports.dp=5353'
#  app-layer-events:
#    - name: dns_tcp
#      flow: 1
#      tx: 0
