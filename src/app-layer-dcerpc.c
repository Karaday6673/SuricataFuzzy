/* Copyright (C) 2007-2013 Open Information Security Foundation
 *
 * You can copy, redistribute or modify this Program under the terms of
 * the GNU General Public License version 2 as published by the Free
 * Software Foundation.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * version 2 along with this program; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA
 * 02110-1301, USA.
 */

/**
 * \file
 *
 * \author Anoop Saldanha <anoopsaldanha@gmail.com>
 */

#include "suricata-common.h"
#include "suricata.h"

#include "util-streaming-parser.h"
#include "app-layer-parser.h"
#include "app-layer-detect-proto.h"
#include "app-layer-dcerpc.h"
#include "util-dcerpc.h"
#include "util-unittest.h"

#define ALIGN_UP(offset, alignment) \
    (offset) = ((offset) + (alignment) - 1) & ~((alignment) - 1)

static enum DCERPCStatus DCERPCStatePDUStart(DCERPCState *state);
static enum DCERPCStatus DCERPCStateParseBindContexts(DCERPCState *state);


#define DCERPC_PTYPE_REQUEST             0
#define DCERPC_PTYPE_RESPONSE            2
#define DCERPC_PTYPE_BIND               11
#define DCERPC_PTYPE_BIND_ACK           12
#define DCERPC_PTYPE_ALTER_CONTEXT      14
#define DCERPC_PTYPE_ALTER_CONTEXT_RESP 15


/*****Utility*****/

static void DCERPCAppendUUID(uint8_t *uuid, uint32_t iv, uint32_t context_id, DCERPCList *l)
{
    UUID *new = SCMalloc(sizeof(*new));
    if (new == NULL)
        return;
    memset(new, 0, sizeof(*new));

    memcpy(new->uuid, uuid, 16);
    new->iv = iv;
    new->context_id = context_id;

    DCERPCListAppend(new, l);

    return;
}

 static void DCERPCFreeUUID(void *uuid)
 {
     SCFree(uuid);

     return;
 }

 static void DCERPCFreeDCERPCTx(void *txv)
 {
     DCERPCTx *tx = txv;

     if (tx->stub[0] != NULL)
         SCFree(tx->stub[0]);
     if (tx->stub[1] != NULL)
         SCFree(tx->stub[1]);

     SCFree(tx);

     return;
 }

/*******request and response states*******/

static enum DCERPCStatus DCERPCStatePDUEnd(DCERPCState *state)
{
    DCERPCConnp *connp = &state->connp[state->curr_direction];
    connp->pdu_bytes_processed = 0;
    connp->CurrState = DCERPCStatePDUStart;

    return DCERPC_OK;
}

static enum DCERPCStatus DCERPCStateIgnorePDU(DCERPCState *state)
{
    int retval;
    uint16_t jumped;
    DCERPCConnp *connp = &state->connp[state->curr_direction];

    if (connp->frag_length < connp->pdu_bytes_processed)
        return DCERPC_ERROR;

    retval = StreamingParserJump(connp->spc,
                                 (connp->frag_length - connp->pdu_bytes_processed),
                                 &jumped);
    connp->pdu_bytes_processed += jumped;
    if (retval == STREAMING_PARSER_RDATA)
        return DCERPC_DATA;

    connp->CurrState = DCERPCStatePDUEnd;

    return DCERPC_OK;
}

static enum DCERPCStatus DCERPCStateParseBindContexts(DCERPCState *state)
{
#define INTERNAL_STATE_P_CONTEXT_ID 0
#define INTERNAL_STATE_N_TRANSFER_SYN 1
#define INTERNAL_STATE_RESERVED 2
#define INTERNAL_STATE_ABSTRACT_SYNTAX_UUID_0_3 3
#define INTERNAL_STATE_ABSTRACT_SYNTAX_UUID_4_5 4
#define INTERNAL_STATE_ABSTRACT_SYNTAX_UUID_6_7 5
#define INTERNAL_STATE_ABSTRACT_SYNTAX_UUID_8_9 6
#define INTERNAL_STATE_ABSTRACT_SYNTAX_UUID_10 7
#define INTERNAL_STATE_ABSTRACT_SYNTAX_UUID_11 8
#define INTERNAL_STATE_ABSTRACT_SYNTAX_UUID_12 9
#define INTERNAL_STATE_ABSTRACT_SYNTAX_UUID_13 10
#define INTERNAL_STATE_ABSTRACT_SYNTAX_UUID_14 11
#define INTERNAL_STATE_ABSTRACT_SYNTAX_UUID_15 12
#define INTERNAL_STATE_ABSTRACT_SYNTAX_UUID_IV 13
#define INTERNAL_STATE_ABSTRACT_SYNTAX_UUID_IV_MINOR 14
#define INTERNAL_STATE_TRANSFER_SYNTAX 15

    /* we start using connp->tmp8[0], connp->tmp16[0] */

    uint8_t tmp8;
    uint32_t tmp32;
    uint16_t tmp16;
    uint16_t jumped;
    int retval;

    DCERPCConnp *connp = &state->connp[state->curr_direction];

    /* connp->tmp8[0] has been set by DCERPCStateParseBind, and it indicates
     * the no of elements.  connp->tmp16[0] is a count variable */
    for (; connp->tmp16[0] < connp->tmp8[0]; connp->tmp16[0]++) {
        /* the fall throughs from the case statements are intentional */
        switch (connp->in_state_progress) {
            case INTERNAL_STATE_P_CONTEXT_ID:
                if (StreamingParserGetU16WithBO(connp->spc, &connp->p_context_id, connp->bo) == STREAMING_PARSER_RDATA)
                    return DCERPC_DATA;
                connp->in_state_progress++;
                connp->pdu_bytes_processed += 2;
            case INTERNAL_STATE_N_TRANSFER_SYN:
                if (StreamingParserGetU8(connp->spc, &connp->tmp8[1]) == STREAMING_PARSER_RDATA)
                    return DCERPC_DATA;
                connp->in_state_progress++;
                connp->pdu_bytes_processed++;
            case INTERNAL_STATE_RESERVED:
                if (StreamingParserGetU8(connp->spc, &tmp8) == STREAMING_PARSER_RDATA)
                    return DCERPC_DATA;
                connp->in_state_progress++;
                connp->pdu_bytes_processed++;
            case INTERNAL_STATE_ABSTRACT_SYNTAX_UUID_0_3:
                if (StreamingParserGetU32WithBO(connp->spc, (uint32_t *)connp->uuid, connp->bo) == STREAMING_PARSER_RDATA)
                    return DCERPC_DATA;
                connp->in_state_progress++;
                connp->pdu_bytes_processed += 4;
            case INTERNAL_STATE_ABSTRACT_SYNTAX_UUID_4_5:
                if (StreamingParserGetU16WithBO(connp->spc, (uint16_t *)(connp->uuid + 4), connp->bo) == STREAMING_PARSER_RDATA)
                    return DCERPC_DATA;
                connp->in_state_progress++;
                connp->pdu_bytes_processed += 2;
            case INTERNAL_STATE_ABSTRACT_SYNTAX_UUID_6_7:
                if (StreamingParserGetU16WithBO(connp->spc, (uint16_t *)(connp->uuid + 6), connp->bo) == STREAMING_PARSER_RDATA)
                    return DCERPC_DATA;
                connp->in_state_progress++;
                connp->pdu_bytes_processed += 2;
            case INTERNAL_STATE_ABSTRACT_SYNTAX_UUID_8_9:
                if (StreamingParserGetU16WithBO(connp->spc, (uint16_t *)(connp->uuid + 8), STREAMING_PARSER_BO_BIG_ENDIAN) == STREAMING_PARSER_RDATA)
                    return DCERPC_DATA;
                connp->in_state_progress++;
                connp->pdu_bytes_processed += 2;
            case INTERNAL_STATE_ABSTRACT_SYNTAX_UUID_10:
                if (StreamingParserGetU8(connp->spc, connp->uuid + 10) == STREAMING_PARSER_RDATA)
                    return DCERPC_DATA;
                connp->in_state_progress++;
                connp->pdu_bytes_processed++;
            case INTERNAL_STATE_ABSTRACT_SYNTAX_UUID_11:
                if (StreamingParserGetU8(connp->spc, connp->uuid + 11) == STREAMING_PARSER_RDATA)
                    return DCERPC_DATA;
                connp->in_state_progress++;
                connp->pdu_bytes_processed++;
            case INTERNAL_STATE_ABSTRACT_SYNTAX_UUID_12:
                if (StreamingParserGetU8(connp->spc, connp->uuid + 12) == STREAMING_PARSER_RDATA)
                    return DCERPC_DATA;
                connp->in_state_progress++;
                connp->pdu_bytes_processed++;
            case INTERNAL_STATE_ABSTRACT_SYNTAX_UUID_13:
                if (StreamingParserGetU8(connp->spc, connp->uuid + 13) == STREAMING_PARSER_RDATA)
                    return DCERPC_DATA;
                connp->in_state_progress++;
                connp->pdu_bytes_processed++;
            case INTERNAL_STATE_ABSTRACT_SYNTAX_UUID_14:
                if (StreamingParserGetU8(connp->spc, connp->uuid + 14) == STREAMING_PARSER_RDATA)
                    return DCERPC_DATA;
                connp->in_state_progress++;
                connp->pdu_bytes_processed++;
            case INTERNAL_STATE_ABSTRACT_SYNTAX_UUID_15:
                if (StreamingParserGetU8(connp->spc, connp->uuid + 15) == STREAMING_PARSER_RDATA)
                    return DCERPC_DATA;
                connp->in_state_progress++;
                connp->pdu_bytes_processed++;
            case INTERNAL_STATE_ABSTRACT_SYNTAX_UUID_IV:
                if (StreamingParserGetU16WithBO(connp->spc, &tmp16, connp->bo) == STREAMING_PARSER_RDATA)
                    return DCERPC_DATA;
                connp->in_state_progress++;
                connp->pdu_bytes_processed += 2;
                DCERPCAppendUUID(connp->uuid, tmp16, connp->p_context_id, &state->uuids);
            case INTERNAL_STATE_ABSTRACT_SYNTAX_UUID_IV_MINOR:
                if (StreamingParserGetU16WithBO(connp->spc, &tmp16, connp->bo) == STREAMING_PARSER_RDATA)
                    return DCERPC_DATA;
                connp->in_state_progress++;
                connp->pdu_bytes_processed += 2;
            case INTERNAL_STATE_TRANSFER_SYNTAX:
                /* connp->tmp8[1] has been set a couple of steps above, and
                 * connp->tmp32[0] is a count */
                tmp32 = connp->tmp8[1] * 20;
                retval = StreamingParserJump(connp->spc, (tmp32 - connp->tmp32[0]), &jumped);
                connp->tmp32[0] += jumped;
                connp->pdu_bytes_processed += jumped;
                if (retval == STREAMING_PARSER_RDATA)
                    return DCERPC_DATA;

                connp->tmp32[0] = 0;
                connp->in_state_progress = 0;
        }
    }

    connp->tmp8[0] = 0;
    connp->tmp8[1] = 0;
    connp->tmp16[0] = 0;
    connp->tmp32[0] = 0;
    connp->in_state_progress = 0;
    connp->CurrState = DCERPCStateIgnorePDU;
    return DCERPC_OK;

#undef INTERNAL_STATE_P_CONTEXT_ID
#undef INTERNAL_STATE_N_TRANSFER_SYN
#undef INTERNAL_STATE_RESERVED
#undef INTERNAL_STATE_ABSTRACT_SYNTAX_UUID_0_3
#undef INTERNAL_STATE_ABSTRACT_SYNTAX_UUID_4_5
#undef INTERNAL_STATE_ABSTRACT_SYNTAX_UUID_6_7
#undef INTERNAL_STATE_ABSTRACT_SYNTAX_UUID_8_9
#undef INTERNAL_STATE_ABSTRACT_SYNTAX_UUID_10
#undef INTERNAL_STATE_ABSTRACT_SYNTAX_UUID_11
#undef INTERNAL_STATE_ABSTRACT_SYNTAX_UUID_12
#undef INTERNAL_STATE_ABSTRACT_SYNTAX_UUID_13
#undef INTERNAL_STATE_ABSTRACT_SYNTAX_UUID_14
#undef INTERNAL_STATE_ABSTRACT_SYNTAX_UUID_15
#undef INTERNAL_STATE_ABSTRACT_SYNTAX_UUID_IV
#undef INTERNAL_STATE_TRANSFER_SYNTAX
}

static enum DCERPCStatus DCERPCStateParseBind(DCERPCState *state)
{
#define INTERNAL_STATE_N_CONTEXT_ELEM 0
#define INTERNAL_STATE_RESERVED 1
#define INTERNAL_STATE_RESERVED2 2
#define INTERNAL_STATE_CONTEXT 3

    uint8_t tmp8;
    uint16_t tmp16;

    DCERPCConnp *connp = &state->connp[state->curr_direction];

    /* the fall throughs from the case statements are intentional */
    switch (connp->in_state_progress) {
        case INTERNAL_STATE_N_CONTEXT_ELEM:
            if (StreamingParserGetU8(connp->spc, &connp->tmp8[0]) == STREAMING_PARSER_RDATA)
                return DCERPC_DATA;
            connp->in_state_progress++;
            connp->pdu_bytes_processed++;
        case INTERNAL_STATE_RESERVED:
            if (StreamingParserGetU8(connp->spc, &tmp8) == STREAMING_PARSER_RDATA)
                return DCERPC_DATA;
            connp->in_state_progress++;
            connp->pdu_bytes_processed++;
        case INTERNAL_STATE_RESERVED2:
            if (StreamingParserGetU16WithBO(connp->spc, &tmp16, connp->bo) == STREAMING_PARSER_RDATA)
                return DCERPC_DATA;
            connp->in_state_progress++;
            connp->pdu_bytes_processed += 2;
    }

    connp->CurrState = DCERPCStateParseBindContexts;
    connp->in_state_progress = 0;
    return DCERPC_OK;

#undef INTERNAL_STATE_N_CONTEXT_ELEM
#undef INTERNAL_STATE_RESERVED
#undef INTERNAL_STATE_RESERVED2
#undef INTERNAL_STATE_CONTEXT
}

static enum DCERPCStatus DCERPCStateParseBindAckResults(DCERPCState *state)
{
#define INTERNAL_STATE_RESULT 0
#define INTERNAL_STATE_REASON 1
#define INTERNAL_STATE_TRANSFER_SYNTAX 2

    uint16_t tmp16;
    int retval;
    uint16_t jumped;

    DCERPCConnp *connp = &state->connp[state->curr_direction];

    /* connp->tmp8[0] has been set by DCERPCStateParseBindAckResultList, and
     * it indicates the no of elements.  connp->tmp16[0] is a count variable */
    for (; connp->tmp16[0] < connp->tmp8[0]; connp->tmp16[0]++) {
        /* the fall throughs from the case statements are intentional */
        switch (connp->in_state_progress) {
            case INTERNAL_STATE_RESULT:
                if (StreamingParserGetU16WithBO(connp->spc, &tmp16, connp->bo) == STREAMING_PARSER_RDATA)
                    return DCERPC_DATA;
                connp->in_state_progress++;
                connp->pdu_bytes_processed += 2;
                UUID *uuid = DCERPCListGetAtIndex(connp->tmp16[0], &state->uuids);
                if (uuid == NULL)
                    return DCERPC_ERROR;
                /* a value of 0 indicates accepted */
                uuid->accepted = (tmp16 == 0);
            case INTERNAL_STATE_REASON:
                if (StreamingParserGetU16WithBO(connp->spc, &tmp16, connp->bo) == STREAMING_PARSER_RDATA)
                    return DCERPC_DATA;
                connp->in_state_progress++;
                connp->pdu_bytes_processed += 2;
            case INTERNAL_STATE_TRANSFER_SYNTAX:
                /* connp->tmp16[1] is a count variable */
                retval = StreamingParserJump(connp->spc, (20 - connp->tmp16[1]), &jumped);
                connp->tmp16[1] += jumped;
                connp->pdu_bytes_processed += jumped;
                if (retval == STREAMING_PARSER_RDATA)
                    return DCERPC_DATA;
                connp->tmp16[1] = 0;
                connp->in_state_progress = 0;
        } /* switch */
    } /* for */

    connp->in_state_progress = 0;
    connp->CurrState = DCERPCStateIgnorePDU;
    return DCERPC_OK;

#undef INTERNAL_STATE_RESULT
#undef INTERNAL_STATE_REASON
#undef INTERNAL_STATE_TRANSFER_SYNTAX
}

static enum DCERPCStatus DCERPCStateParseBindAckResultList(DCERPCState *state)
{
#define INTERNAL_STATE_N_RESULTS 0
#define INTERNAL_STATE_RESERVED 1
#define INTERNAL_STATE_RESERVED2 2

    uint8_t tmp8;
    uint16_t tmp16;

    DCERPCConnp *connp = &state->connp[state->curr_direction];

    /* the fall throughs from the case statements are intentional */
    switch (connp->in_state_progress) {
        case INTERNAL_STATE_N_RESULTS:
            if (StreamingParserGetU8(connp->spc, &connp->tmp8[0]) == STREAMING_PARSER_RDATA)
                return DCERPC_DATA;
            connp->in_state_progress++;
            connp->pdu_bytes_processed++;
        case INTERNAL_STATE_RESERVED:
            if (StreamingParserGetU8(connp->spc, &tmp8) == STREAMING_PARSER_RDATA)
                return DCERPC_DATA;
            connp->in_state_progress++;
            connp->pdu_bytes_processed++;
        case INTERNAL_STATE_RESERVED2:
            if (StreamingParserGetU16WithBO(connp->spc, &tmp16, connp->bo) == STREAMING_PARSER_RDATA)
                return DCERPC_DATA;
            connp->in_state_progress++;
            connp->pdu_bytes_processed += 2;
    }

    connp->CurrState = DCERPCStateParseBindAckResults;
    connp->in_state_progress = 0;
    return DCERPC_OK;

#undef INTERNAL_STATE_N_RESULTS
#undef INTERNAL_STATE_RESERVED
#undef INTERNAL_STATE_RESERVED2
}

static enum DCERPCStatus DCERPCStateParseBindAck(DCERPCState *state)
{
#define INTERNAL_STATE_SEC_ADDR_LENGTH 0
#define INTERNAL_STATE_SEC_ADDR_PORT_SPEC 1
#define INTERNAL_STATE_PAD2_CALCULATE 2
#define INTERNAL_STATE_PAD2_CONSUME 3
#define INTERNAL_STATE_RESULTS_LENGTH 4
#define INTERNAL_STATE_RESULTS_RESERVED 5
#define INTERNAL_STATE_RESULTS_RESERVED2 5

    uint32_t tmp32;
    int retval;
    uint16_t jumped;

    DCERPCConnp *connp = &state->connp[state->curr_direction];

    /* the fall throughs from the case statements are intentional */
    switch (connp->in_state_progress) {
        case INTERNAL_STATE_SEC_ADDR_LENGTH:
            if (StreamingParserGetU16WithBO(connp->spc, &connp->tmp16[0], connp->bo) == STREAMING_PARSER_RDATA)
                return DCERPC_DATA;
            connp->in_state_progress++;
            connp->pdu_bytes_processed += 2;
        case INTERNAL_STATE_SEC_ADDR_PORT_SPEC:
            /* connp->tmp16[0] set by previous case */
            retval = StreamingParserJump(connp->spc, (connp->tmp16[0] - connp->tmp32[0]), &jumped);
            connp->tmp32[0] += jumped;
            connp->pdu_bytes_processed += jumped;
            if (retval == STREAMING_PARSER_RDATA)
                return DCERPC_DATA;
            connp->tmp32[0] = connp->tmp16[0] = 0;
            connp->in_state_progress++;
        case INTERNAL_STATE_PAD2_CALCULATE:
            tmp32 = connp->pdu_bytes_processed;
            ALIGN_UP(tmp32, 4);
            connp->tmp8[0] = tmp32 - connp->pdu_bytes_processed;
            connp->in_state_progress++;
        case INTERNAL_STATE_PAD2_CONSUME:
            /* connp->tmp8[0] set by previous case */
            retval = StreamingParserJump(connp->spc, (connp->tmp8[0] - connp->tmp16[0]), &jumped);
            connp->tmp16[0] += jumped;
            connp->pdu_bytes_processed += jumped;
            if (retval == STREAMING_PARSER_RDATA)
                return DCERPC_DATA;
            connp->tmp16[0] = connp->tmp8[0] = 0;
    }

    connp->CurrState = DCERPCStateParseBindAckResultList;
    connp->in_state_progress = 0;
    return DCERPC_OK;

#undef INTERNAL_STATE_SEC_ADDR_LENGTH
#undef INTERNAL_STATE_SEC_ADDR_PORT_SPEC
#undef INTERNAL_STATE_PAD2_CALCULATE
#undef INTERNAL_STATE_PAD2_CONSUME
}

static enum DCERPCStatus DCERPCStateParseBindAndAckCommon(DCERPCState *state)
{
#define INTERNAL_STATE_MAX_XMIT_FRAG 0
#define INTERNAL_STATE_MAX_RECV_FRAG 1
#define INTERNAL_STATE_ASSOC_GROUP_ID 2

    uint16_t tmp16;

    DCERPCConnp *connp = &state->connp[state->curr_direction];

    /* the fall throughs from the case statements are intentional */
    switch (connp->in_state_progress) {
        case INTERNAL_STATE_MAX_XMIT_FRAG:
            if (StreamingParserGetU16WithBO(connp->spc, &tmp16, connp->bo) == STREAMING_PARSER_RDATA)
                return DCERPC_DATA;
            connp->in_state_progress++;
            connp->pdu_bytes_processed += 2;
        case INTERNAL_STATE_MAX_RECV_FRAG:
            if (StreamingParserGetU16WithBO(connp->spc, &tmp16, connp->bo) == STREAMING_PARSER_RDATA)
                return DCERPC_DATA;
            connp->in_state_progress++;
            connp->pdu_bytes_processed += 2;
        case INTERNAL_STATE_ASSOC_GROUP_ID:
            if (StreamingParserGetU32WithBO(connp->spc, &connp->assoc_group_id, connp->bo) == STREAMING_PARSER_RDATA)
                return DCERPC_DATA;
            connp->in_state_progress++;
            connp->pdu_bytes_processed += 4;
    }

    if (connp->ptype == DCERPC_PTYPE_BIND || connp->ptype == DCERPC_PTYPE_ALTER_CONTEXT)
        connp->CurrState = DCERPCStateParseBind;
    else
        connp->CurrState = DCERPCStateParseBindAck;
    connp->in_state_progress = 0;
    return DCERPC_OK;

#undef INTERNAL_STATE_MAX_XMIT_FRAG
#undef INTERNAL_STATE_MAX_RECV_FRAG
#undef INTERNAL_STATE_ASSOC_GROUP_ID
}

static enum DCERPCStatus DCERPCStateParseStub(DCERPCState *state)
{
    DCERPCConnp *connp = &state->connp[state->curr_direction];
    DCERPCTx *tx = connp->curr_tx;
    uint16_t copied;
    int retval;

    /* connp->tmp16[0] set by DCERPCStateDetermineStub, connp->tmp32[0]
     * used as a counter */
    retval = StreamingParserGetChunk(connp->spc,
                                     tx->stub[state->curr_direction] + tx->stub_len[state->curr_direction],
                                     connp->tmp16[0] - connp->tmp32[0],
                                     &copied);
    connp->pdu_bytes_processed += copied;
    connp->tmp32[0] += copied;
    connp->curr_tx->stub_len[state->curr_direction] += copied;
    if (retval == STREAMING_PARSER_RDATA)
        return DCERPC_DATA;

    /* it's the last frag */
    if (connp->pfc_flags & 0x02) {
        connp->curr_tx->progress[state->curr_direction] = DCERPC_TX_DONE;
    }

    connp->tmp32[0] = connp->tmp16[0] = 0;
    connp->CurrState = DCERPCStateIgnorePDU;
    return DCERPC_OK;
}

static enum DCERPCStatus DCERPCStateDetermineStub(DCERPCState *state)
{
    DCERPCConnp *connp = &state->connp[state->curr_direction];
    DCERPCTx *tx = connp->curr_tx;

    if (connp->frag_length < (connp->pdu_bytes_processed + connp->auth_length))
        return DCERPC_ERROR;

    connp->tmp16[0] = connp->frag_length - connp->pdu_bytes_processed - connp->auth_length;

    tx->stub[state->curr_direction] = SCRealloc(tx->stub[state->curr_direction],
                                                tx->stub_len[state->curr_direction] + connp->tmp16[0]);
    if (connp->curr_tx->stub == NULL)
        return DCERPC_ERROR;

    if (tx->stub_len[state->curr_direction] == 0) {
        tx->bo[state->curr_direction] = connp->bo;
    } else {
        if (tx->bo[state->curr_direction] != connp->bo) {
            ; /* calls for an event */
        }
    }

    connp->CurrState = DCERPCStateParseStub;
    return DCERPC_OK;
}

static enum DCERPCStatus DCERPCStateParseRequest(DCERPCState *state)
{
#define INTERNAL_STATE_ALLOC_HINT 0
#define INTERNAL_STATE_P_CONT_ID 1
#define INTERNAL_STATE_OPNUM 2
#define INTERNAL_STATE_OBJECT 3

    uint16_t tmp16;
    uint32_t tmp32;
    int retval;
    uint16_t jumped;

    DCERPCConnp *connp = &state->connp[state->curr_direction];

    /* the fall throughs from the case statements are intentional */
    switch (connp->in_state_progress) {
        case INTERNAL_STATE_ALLOC_HINT:
            if (StreamingParserGetU32WithBO(connp->spc, &tmp32, connp->bo) == STREAMING_PARSER_RDATA)
                return DCERPC_DATA;
            connp->in_state_progress++;
            connp->pdu_bytes_processed += 4;
        case INTERNAL_STATE_P_CONT_ID:
            if (StreamingParserGetU16WithBO(connp->spc, &tmp16, connp->bo) == STREAMING_PARSER_RDATA)
                return DCERPC_DATA;
            connp->in_state_progress++;
            connp->pdu_bytes_processed += 2;

            UUID *uuid = state->uuids.head;
            while (uuid != NULL) {
                if (tmp16 == uuid->context_id)
                    break;
                uuid = uuid->next;
            }
            /* \todo This section is not entirely right.  We might receive
             * a new bind with an old association, while retaining all the old
             * contexts registered, and a request might be sent against a
             * context id that was registered by the old bind but now has been
             * reset when we received a new bind. */
            if (uuid != NULL)
                connp->curr_tx->iface = *uuid;
            connp->curr_tx->progress[state->curr_direction] = DCERPC_TX_OPNUM;

        case INTERNAL_STATE_OPNUM:
            if (StreamingParserGetU16WithBO(connp->spc, &tmp16, connp->bo) == STREAMING_PARSER_RDATA)
                return DCERPC_DATA;
            connp->in_state_progress++;
            connp->pdu_bytes_processed += 2;

            connp->curr_tx->opnum = tmp16;
            connp->curr_tx->progress[state->curr_direction] = DCERPC_TX_STUB_BUFFERING;

        case INTERNAL_STATE_OBJECT:
            if (connp->pfc_flags & 0x80) {
                retval = StreamingParserJump(connp->spc, (16 - connp->tmp8[0]), &jumped);
                connp->tmp8[0] += jumped;
                connp->pdu_bytes_processed += jumped;
                if (retval == STREAMING_PARSER_RDATA)
                    return DCERPC_DATA;
                connp->tmp8[0] = 0;
            }
            connp->in_state_progress++;
    }

    connp->CurrState = DCERPCStateDetermineStub;
    connp->in_state_progress = 0;
    return DCERPC_OK;

#undef INTERNAL_STATE_ALLOC_HINT
#undef INTERNAL_STATE_P_CONT_ID
#undef INTERNAL_STATE_OPNUM
#undef INTERNAL_STATE_OBJECT
}

static enum DCERPCStatus DCERPCStateParseResponse(DCERPCState *state)
{
#define INTERNAL_STATE_ALLOC_HINT 0
#define INTERNAL_STATE_P_CONT_ID 1
#define INTERNAL_STATE_CANCEL_COUNT 2
#define INTERNAL_STATE_RESERVED 3

    uint8_t tmp8;
    uint16_t tmp16;
    uint32_t tmp32;

    DCERPCConnp *connp = &state->connp[state->curr_direction];

    /* the fall throughs from the case statements are intentional */
    switch (connp->in_state_progress) {
        case INTERNAL_STATE_ALLOC_HINT:
            if (StreamingParserGetU32WithBO(connp->spc, &tmp32, connp->bo) == STREAMING_PARSER_RDATA)
                return DCERPC_DATA;
            connp->in_state_progress++;
            connp->pdu_bytes_processed += 4;
        case INTERNAL_STATE_P_CONT_ID:
            if (StreamingParserGetU16WithBO(connp->spc, &tmp16, connp->bo) == STREAMING_PARSER_RDATA)
                return DCERPC_DATA;
            connp->in_state_progress++;
            connp->pdu_bytes_processed += 2;
        case INTERNAL_STATE_CANCEL_COUNT:
            if (StreamingParserGetU8(connp->spc, &tmp8) == STREAMING_PARSER_RDATA)
                return DCERPC_DATA;
            connp->in_state_progress++;
            connp->pdu_bytes_processed++;
        case INTERNAL_STATE_RESERVED:
            if (StreamingParserGetU8(connp->spc, &tmp8) == STREAMING_PARSER_RDATA)
                return DCERPC_DATA;
            connp->in_state_progress++;
            connp->pdu_bytes_processed++;
    }

    connp->CurrState = DCERPCStateDetermineStub;
    connp->in_state_progress = 0;
    return DCERPC_OK;

#undef INTERNAL_STATE_ALLOC_HINT
#undef INTERNAL_STATE_P_CONT_ID
#undef INTERNAL_STATE_CANCEL_COUNT
#undef INTERNAL_STATE_RESERVED
}

static enum DCERPCStatus DCERPCStateParsePType(DCERPCState *state)
{
    DCERPCConnp *connp = &state->connp[state->curr_direction];
    uint8_t ptype = connp->ptype;
    enum DCERPCStatus (*CurrState)(DCERPCState *);
    DCERPCTx *tx = NULL;

    if (ptype == DCERPC_PTYPE_BIND ||
        ptype == DCERPC_PTYPE_BIND_ACK ||
        ptype == DCERPC_PTYPE_ALTER_CONTEXT ||
        ptype == DCERPC_PTYPE_ALTER_CONTEXT_RESP) {
        /* if we have a minor version of 0, we assume no fragmentation.
         * If it's not, the first frag always contains the contexts and
         * the subsequent frags would contain the auth data, in which
         * case we just ignore the auth data.
         *
         * \todo We don't have pcaps for the case described above.
         *       Search for corresponding wild traffic or rig one up. */
        if (connp->rpc_vers_minor == 0 || connp->pfc_flags & 0x01) {
            if (ptype == DCERPC_PTYPE_BIND || ptype == DCERPC_PTYPE_ALTER_CONTEXT)
                DCERPCListReset(&state->uuids, DCERPCFreeUUID);
            CurrState = DCERPCStateParseBindAndAckCommon;
        } else {
            CurrState = DCERPCStateIgnorePDU;
        }
    } else if (ptype == DCERPC_PTYPE_REQUEST) {
        /* a tx per request(whole request, including fragments) */
        if (connp->pfc_flags & 0x01) {
            tx = SCMalloc(sizeof(*tx));
            if (tx == NULL)
                return DCERPC_ERROR;
            memset(tx, 0, sizeof(*tx));
            tx->call_id = connp->call_id;
            DCERPCListAppend(tx, &state->transactions);

            /* if it's not the first frag, search for the
             * corresponding tx using the call_id */
        } else {
            tx = state->transactions.tail;
            while (tx != NULL) {
                if (tx->call_id == connp->call_id)
                    break;
                tx = tx->prev;
            }
            if (tx == NULL)
                return DCERPC_ERROR;
        }
        connp->curr_tx = tx;
        CurrState = DCERPCStateParseRequest;
    } else if (ptype == DCERPC_PTYPE_RESPONSE) {
        tx = state->transactions.tail;
        while (tx != NULL) {
            if (tx->call_id == connp->call_id)
                break;
            tx = tx->prev;
        }
        if (tx == NULL)
            return DCERPC_ERROR;
        connp->curr_tx = tx;

        CurrState = DCERPCStateParseResponse;
    } else {
        CurrState = DCERPCStateIgnorePDU;
    }

    state->connp[state->curr_direction].CurrState = CurrState;

    return DCERPC_OK;
}

static enum DCERPCStatus DCERPCStateParseHeader(DCERPCState *state)
{
#define INTERNAL_STATE_PH_RPC_VERS 0
#define INTERNAL_STATE_PH_RPC_VERS_MINOR 1
#define INTERNAL_STATE_PH_PTYPE 2
#define INTERNAL_STATE_PH_PFC_FLAGS 3
#define INTERNAL_STATE_PH_PACKED_DREP_0 4
#define INTERNAL_STATE_PH_PACKED_DREP_1 5
#define INTERNAL_STATE_PH_PACKED_DREP_23 6
#define INTERNAL_STATE_PH_FRAG_LENGTH 7
#define INTERNAL_STATE_PH_AUTH_LENGTH 8
#define INTERNAL_STATE_PH_CALL_ID 9

    uint8_t tmp8;
    uint16_t tmp16;
    uint16_t jumped;

    DCERPCConnp *connp = &state->connp[state->curr_direction];
    void *spc = connp->spc;

    /* the fall throughs from the case statements are intentional */
    switch (connp->in_state_progress) {
        case INTERNAL_STATE_PH_RPC_VERS:
            if (StreamingParserJump(spc, 1, &jumped) == STREAMING_PARSER_RDATA)
                return DCERPC_DATA;
            connp->in_state_progress++;
            connp->pdu_bytes_processed++;
        case INTERNAL_STATE_PH_RPC_VERS_MINOR:
            if (StreamingParserGetU8(spc, &connp->rpc_vers_minor) == STREAMING_PARSER_RDATA)
                return DCERPC_DATA;
            connp->in_state_progress++;
            connp->pdu_bytes_processed++;
        case INTERNAL_STATE_PH_PTYPE:
            if (StreamingParserGetU8(spc, &connp->ptype) == STREAMING_PARSER_RDATA)
                return DCERPC_DATA;
            connp->in_state_progress++;
            connp->pdu_bytes_processed++;
        case INTERNAL_STATE_PH_PFC_FLAGS:
            if (StreamingParserGetU8(spc, &connp->pfc_flags) == STREAMING_PARSER_RDATA)
                return DCERPC_DATA;
            connp->in_state_progress++;
            connp->pdu_bytes_processed++;
        case INTERNAL_STATE_PH_PACKED_DREP_0:
            if (StreamingParserGetU8(spc, &tmp8) == STREAMING_PARSER_RDATA)
                return DCERPC_DATA;
            connp->in_state_progress++;
            connp->pdu_bytes_processed++;
            if (tmp8 & 0x10)
                connp->bo = STREAMING_PARSER_BO_LITTLE_ENDIAN;
            else
                connp->bo = STREAMING_PARSER_BO_BIG_ENDIAN;
        case INTERNAL_STATE_PH_PACKED_DREP_1:
            if (StreamingParserJump(spc, 1, &jumped) == STREAMING_PARSER_RDATA)
                return DCERPC_DATA;
            connp->in_state_progress++;
            connp->pdu_bytes_processed++;
        case INTERNAL_STATE_PH_PACKED_DREP_23:
            if (StreamingParserGetU16WithBO(spc, &tmp16, connp->bo) == STREAMING_PARSER_RDATA)
                return DCERPC_DATA;
            connp->in_state_progress++;
            connp->pdu_bytes_processed += 2;
        case INTERNAL_STATE_PH_FRAG_LENGTH:
            if (StreamingParserGetU16WithBO(spc, &connp->frag_length, connp->bo) == STREAMING_PARSER_RDATA)
                return DCERPC_DATA;
            connp->in_state_progress++;
            connp->pdu_bytes_processed += 2;
        case INTERNAL_STATE_PH_AUTH_LENGTH:
            if (StreamingParserGetU16WithBO(spc, &connp->auth_length, connp->bo) == STREAMING_PARSER_RDATA)
                return DCERPC_DATA;
            connp->in_state_progress++;
            connp->pdu_bytes_processed += 2;
        case INTERNAL_STATE_PH_CALL_ID:
            if (StreamingParserGetU32WithBO(spc, &connp->call_id, connp->bo) == STREAMING_PARSER_RDATA)
                return DCERPC_DATA;
            connp->in_state_progress++;
            connp->pdu_bytes_processed += 4;
    }

    connp->CurrState = DCERPCStateParsePType;
    connp->in_state_progress = 0;
    return DCERPC_OK;

#undef INTERNAL_STATE_PH_RPC_VERS
#undef INTERNAL_STATE_PH_RPC_VERS_MINOR
#undef INTERNAL_STATE_PH_PTYPE
#undef INTERNAL_STATE_PH_PFC_FLAGS
#undef INTERNAL_STATE_PH_PACKED_DREP_0
#undef INTERNAL_STATE_PH_PACKED_DREP_1
#undef INTERNAL_STATE_PH_PACKED_DREP_23
#undef INTERNAL_STATE_PH_FRAG_LENGTH
#undef INTERNAL_STATE_PH_AUTH_LENGTH
#undef INTERNAL_STATE_PH_CALL_ID
}

static enum DCERPCStatus DCERPCStatePDUStart(DCERPCState *state)
{
    DCERPCConnp *connp = &state->connp[state->curr_direction];

    uint16_t ret_input;
    int r = StreamingParserTestU16WithBO(connp->spc, &ret_input, STREAMING_PARSER_BO_BIG_ENDIAN);
    if (r == STREAMING_PARSER_RDATA)
        return DCERPC_DATA;

    if (ret_input != 0x0500)
        return DCERPC_ERROR;

    connp->CurrState = DCERPCStateParseHeader;

    return DCERPC_OK;
}

/* parser entry callbacks */

int DCERPCParseRequest(Flow *f, void *alstate,
                      AppLayerParserState *pstate,
                      uint8_t *input, uint32_t input_len,
                      void *local_data,
                      AppLayerParserResult *output)
{
    DCERPCState *state = (DCERPCState *)alstate;

    state->curr_direction = 0;
    StreamingParserSetData(state->connp[state->curr_direction].spc, input, input_len);

    while (1) {
        enum DCERPCStatus r = state->connp[state->curr_direction].CurrState(state);
        if (r == DCERPC_STOP || r == DCERPC_ERROR) {
            return -1;
        } else if (r == DCERPC_DATA) {
            return 0;
        }
    }
    //printf(">>anoop request: DONE\n");
}

int DCERPCParseResponse(Flow *f, void *alstate,
                        AppLayerParserState *pstate,
                        uint8_t *input, uint32_t input_len,
                        void *local_data,
                        AppLayerParserResult *output)
{
    DCERPCState *state = (DCERPCState *)alstate;

    state->curr_direction = 1;
    StreamingParserSetData(state->connp[state->curr_direction].spc, input, input_len);

    while (1) {
        enum DCERPCStatus r = state->connp[state->curr_direction].CurrState(state);
        if (r == DCERPC_STOP || r == DCERPC_ERROR) {
            return -1;
        } else if (r == DCERPC_DATA) {
            return 0;
        }
    }
    //printf(">>anoop response: DONE\n");
}

/*******utility functions*******/

static int DCERPCStateSetup(DCERPCState *state)
{
    state->connp[0].spc = StreamingParserNewContext();
    if (state->connp[0].spc == NULL)
        return -1;
    state->connp[1].spc = StreamingParserNewContext();
    if (state->connp[1].spc == NULL) {
        StreamingParserFreeContext(state->connp[0].spc);
        return -1;
    }

    state->connp[0].CurrState = DCERPCStatePDUStart;
    state->connp[1].CurrState = DCERPCStatePDUStart;

    return 0;
}

void *DCERPCStateAlloc(void)
{
    DCERPCState *state = SCMalloc(sizeof(DCERPCState));
    if (unlikely(state == NULL))
        return NULL;
    memset(state, 0, sizeof(DCERPCState));

    if (DCERPCStateSetup(state) < 0) {
        SCFree(state);
        return NULL;
    }

    return state;
}

void DCERPCStateFree(void *s)
{
    DCERPCState *state = (DCERPCState *)s;

    if (state->connp[0].spc != NULL)
        StreamingParserFreeContext(state->connp[0].spc);
    if (state->connp[1].spc != NULL)
        StreamingParserFreeContext(state->connp[1].spc);

    DCERPCListReset(&state->uuids, DCERPCFreeUUID);
    DCERPCListReset(&state->transactions, DCERPCFreeDCERPCTx);

    SCFree(s);

    return;
}

static int DCERPCStateGetAlstateProgress(void *tx, uint8_t direction)
{
    return ((DCERPCTx *)tx)->progress[direction];
}

static uint64_t DCERPCStateGetTxCnt(void *alstate)
{
    return (uint64_t)DCERPCListSize(&((DCERPCState *)alstate)->transactions);
}

static void *DCERPCStateGetTx(void *alstate, uint64_t tx_id)
{
    return DCERPCListGetAtIndex(tx_id, &((DCERPCState *)alstate)->transactions);
}

static int DCERPCStateGetAlstateProgressCompletionStatus(uint8_t direction)
{
    return DCERPC_TX_DONE;
}

void DCERPCStateTransactionFree(void *alstate, uint16_t id)
{
    DCERPCState *state = (DCERPCState *)alstate;
    uint64_t tx_id;
    DCERPCTx *tx;

    for (tx_id = DCERPCListIndex(&state->transactions); tx_id < id; tx_id++) {
        tx = DCERPCListGetAtIndex(tx_id, &state->transactions);
        BUG_ON(tx == NULL);
        DCERPCListRemoveItem(tx, &state->transactions);
        SCFree(tx->stub[0]);
        SCFree(tx->stub[1]);
        SCFree(tx);
    }

    return;
}

void RegisterDCERPCParsers(void)
{
    char *proto_name = "dcerpc";

    AlpProtoAdd(&alp_proto_ctx, proto_name, IPPROTO_TCP, ALPROTO_DCERPC, "|05 00|", 2, 0, STREAM_TOSERVER);

    AppLayerRegisterProto(proto_name, ALPROTO_DCERPC, STREAM_TOSERVER,
                          DCERPCParseRequest);
    AppLayerRegisterProto(proto_name, ALPROTO_DCERPC, STREAM_TOCLIENT,
                          DCERPCParseResponse);

    AppLayerRegisterStateFuncs(ALPROTO_DCERPC, DCERPCStateAlloc, DCERPCStateFree);
    AppLayerRegisterTransactionIdFuncs(ALPROTO_DCERPC, NULL, DCERPCStateTransactionFree);

    AppLayerRegisterGetAlstateProgressFunc(ALPROTO_DCERPC, DCERPCStateGetAlstateProgress);
    AppLayerRegisterGetTxCnt(ALPROTO_DCERPC, DCERPCStateGetTxCnt);
    AppLayerRegisterGetTx(ALPROTO_DCERPC, DCERPCStateGetTx);
    AppLayerRegisterGetAlstateProgressCompletionStatus(ALPROTO_DCERPC, DCERPCStateGetAlstateProgressCompletionStatus);

    return;
}

/***************Unittests***************/

#ifdef UNITTESTS

#include "stream-tcp-private.h"
#include "stream-tcp.h"
#include "flow.h"
#include "flow-util.h"

/**
 * \test bind, bind_ack, request, response
 *       211d4500. private_3329-0.pcap. pdus 5, 6, 7, 8.
 */
int DCERPCParserTest01(void)
{
    int result = 0;

    uint8_t bind[] = {
        0x05, 0x00, 0x0b, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x48, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0xd0, 0x16, 0xd0, 0x16, 0x00, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00,
        0xc4, 0xfe, 0xfc, 0x99, 0x60, 0x52, 0x1b, 0x10,
        0xbb, 0xcb, 0x00, 0xaa, 0x00, 0x21, 0x34, 0x7a,
        0x00, 0x00, 0x00, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00
    };
    uint32_t bind_len = sizeof(bind);

    uint8_t bindack[] = {
        0x05, 0x00, 0x0c, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x3c, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0xd0, 0x16, 0xd0, 0x16, 0xe4, 0x94, 0xde, 0x10,
        0x04, 0x00, 0x31, 0x33, 0x35, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00
    };
    uint32_t bindack_len = sizeof(bindack);

    /* request has no stub data */
    uint8_t request[] = {
        0x05, 0x00, 0x00, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x18, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x05, 0x00
    };
    uint32_t request_len = sizeof(request);

    uint8_t response[] = {
        0x05, 0x00, 0x02, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x88, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x70, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x05, 0x00, 0x06, 0x00, 0x50, 0xdd, 0x08, 0x00,
        0x2c, 0x00, 0x00, 0x00, 0x2c, 0x00, 0x19, 0x00,
        0x07, 0x00, 0x78, 0x00, 0x65, 0x00, 0x73, 0x00,
        0x70, 0x00, 0x72, 0x00, 0x69, 0x00, 0x31, 0x00,
        0x37, 0x00, 0x31, 0x00, 0x00, 0x00, 0x07, 0x00,
        0x34, 0x00, 0x34, 0x00, 0x2e, 0x00, 0x31, 0x00,
        0x30, 0x00, 0x2e, 0x00, 0x31, 0x00, 0x2e, 0x00,
        0x31, 0x00, 0x38, 0x00, 0x36, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x09, 0x00, 0xff, 0xff, 0x00, 0x00,
        0x10, 0x00, 0xff, 0xff, 0x00, 0x00, 0x0a, 0x00,
        0xff, 0xff, 0x00, 0x00, 0x0e, 0x00, 0xff, 0xff,
        0x00, 0x00, 0x11, 0x00, 0xff, 0xff, 0x00, 0x00,
        0x12, 0x00, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
    };
    uint32_t response_len = sizeof(response);

    DCERPCState *state;
    Flow f;
    TcpSession ssn;
    int r;
    UUID *uuid = NULL;
    DCERPCTx *tx = NULL;

    memset(&f, 0, sizeof(f));
    memset(&ssn, 0, sizeof(ssn));
    FLOW_INITIALIZE(&f);
    f.protoctx = (void *)&ssn;

    StreamTcpInitConfig(TRUE);

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER | STREAM_START, bind, bind_len);
    if (r != 0) {
        printf("failure parsing bind\n");
        goto end;
    }
    state = f.alstate;
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 11 ||
        state->connp[0].pfc_flags != 0x03 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 72 ||
        state->connp[0].call_id != 1 ||
        state->connp[0].assoc_group_id != 0 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[0].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 0) {
        printf("failure1\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x99fcfec4 ||
         *((uint16_t *)uuid->uuid + 2) != 0x5260 ||
         *((uint16_t *)uuid->uuid + 3) != 0x101b ||
         *((uint16_t *)uuid->uuid + 4) != 0xbbcb ||
         uuid->uuid[10] != 0x00 || uuid->uuid[11] != 0xaa ||
         uuid->uuid[12] != 0x00 || uuid->uuid[13] != 0x21 ||
         uuid->uuid[14] != 0x34 || uuid->uuid[15] != 0x7a) ||
        uuid->accepted != 0 ||
        uuid->iv != 0 ||
        uuid->context_id != 0) {
        printf("failure 1_1\n");
        goto end;
    }

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, bindack, bindack_len);
    if (r != 0) {
        printf("failure parsing bindack\n");
        goto end;
    }
    if (state->connp[1].rpc_vers_minor != 0 ||
        state->connp[1].ptype != 12 ||
        state->connp[1].pfc_flags != 0x03 ||
        state->connp[1].auth_length != 0 ||
        state->connp[1].frag_length != 60 ||
        state->connp[1].call_id != 1 ||
        state->connp[1].assoc_group_id != 0x10de94e4 ||
        state->connp[1].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 0) {
        printf("failure2\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x99fcfec4 ||
         *((uint16_t *)uuid->uuid + 2) != 0x5260 ||
         *((uint16_t *)uuid->uuid + 3) != 0x101b ||
         *((uint16_t *)uuid->uuid + 4) != 0xbbcb ||
         uuid->uuid[10] != 0x00 || uuid->uuid[11] != 0xaa ||
         uuid->uuid[12] != 0x00 || uuid->uuid[13] != 0x21 ||
         uuid->uuid[14] != 0x34 || uuid->uuid[15] != 0x7a) ||
        uuid->accepted != 1 ||
        uuid->iv != 0 ||
        uuid->context_id != 0) {
        printf("failure 2_1\n");
        goto end;
    }

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER, request, request_len);
    if (r != 0) {
        printf("failure parsing request\n");
        goto end;
    }
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 0 ||
        state->connp[0].pfc_flags != 0x03 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 24 ||
        state->connp[0].call_id != 1 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure3\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x99fcfec4 ||
         *((uint16_t *)uuid->uuid + 2) != 0x5260 ||
         *((uint16_t *)uuid->uuid + 3) != 0x101b ||
         *((uint16_t *)uuid->uuid + 4) != 0xbbcb ||
         uuid->uuid[10] != 0x00 || uuid->uuid[11] != 0xaa ||
         uuid->uuid[12] != 0x00 || uuid->uuid[13] != 0x21 ||
         uuid->uuid[14] != 0x34 || uuid->uuid[15] != 0x7a) ||
        uuid->accepted != 1 ||
        uuid->iv != 0 ||
        uuid->context_id != 0) {
        printf("failure 3_1\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 1 ||
        tx->opnum != 5 ||
        tx->stub_len[0] != 0 ||
        tx->stub_len[1] != 0) {
        printf("failure 3_2\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x99fcfec4 ||
         *((uint16_t *)tx->iface.uuid + 2) != 0x5260 ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x101b ||
         *((uint16_t *)tx->iface.uuid + 4) != 0xbbcb ||
         tx->iface.uuid[10] != 0x00 || tx->iface.uuid[11] != 0xaa ||
         tx->iface.uuid[12] != 0x00 || tx->iface.uuid[13] != 0x21 ||
         tx->iface.uuid[14] != 0x34 || tx->iface.uuid[15] != 0x7a)) {
        printf("failure 3_3\n");
        goto end;
    }

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, response, response_len);
    if (r != 0) {
        printf("failure parsing response\n");
        goto end;
    }
    if (state->connp[1].rpc_vers_minor != 0 ||
        state->connp[1].ptype != 2 ||
        state->connp[1].pfc_flags != 0x03 ||
        state->connp[1].auth_length != 0 ||
        state->connp[1].frag_length != 136 ||
        state->connp[1].call_id != 1 ||
        state->connp[1].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure4\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x99fcfec4 ||
         *((uint16_t *)uuid->uuid + 2) != 0x5260 ||
         *((uint16_t *)uuid->uuid + 3) != 0x101b ||
         *((uint16_t *)uuid->uuid + 4) != 0xbbcb ||
         uuid->uuid[10] != 0x00 || uuid->uuid[11] != 0xaa ||
         uuid->uuid[12] != 0x00 || uuid->uuid[13] != 0x21 ||
         uuid->uuid[14] != 0x34 || uuid->uuid[15] != 0x7a) ||
        uuid->accepted != 1 ||
        uuid->iv != 0 ||
        uuid->context_id != 0) {
        printf("failure 4_1\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 1 ||
        tx->opnum != 5 ||
        tx->stub_len[0] != 0 ||
        tx->stub_len[1] != 112) {
        printf("failure 4_2\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x99fcfec4 ||
         *((uint16_t *)tx->iface.uuid + 2) != 0x5260 ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x101b ||
         *((uint16_t *)tx->iface.uuid + 4) != 0xbbcb ||
         tx->iface.uuid[10] != 0x00 || tx->iface.uuid[11] != 0xaa ||
         tx->iface.uuid[12] != 0x00 || tx->iface.uuid[13] != 0x21 ||
         tx->iface.uuid[14] != 0x34 || tx->iface.uuid[15] != 0x7a)) {
        printf("failure 4_3\n");
        goto end;
    }

    result = 1;

end:
    StreamTcpFreeConfig(TRUE);
    FLOW_DESTROY(&f);
    return result;
}

/**
 * \test bind, bindack, request, fault.
 *       211e2d002d01. private_3330-0-1.pcap.  pdus 4, 5, 7, 9.
 *
 *       All binds rejected, but the client still sends the request.
 *       private_3330-0-1.pcap.  Pdus 4, 5, 7, 9.
 */
int DCERPCParserTest02(void)
{
    int result = 0;

    uint8_t bind[] = {
        0x05, 0x00, 0x0b, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x48, 0x00, 0x00, 0x00, 0x7f, 0x00, 0x00, 0x00,
        0xd0, 0x16, 0xd0, 0x16, 0x00, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x01, 0x00, 0x01, 0x00,
        0xa0, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0xc0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x46,
        0x00, 0x00, 0x00, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
    };
    uint32_t bind_len = sizeof(bind);

    uint8_t bindack[] = {
        0x05, 0x00, 0x0c, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x3c, 0x00, 0x00, 0x00, 0x7f, 0x00, 0x00, 0x00,
        0xd0, 0x16, 0xd0, 0x16, 0x64, 0x1c, 0x01, 0x00,
        0x04, 0x00, 0x31, 0x33, 0x35, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00,
    };
    uint32_t bindack_len = sizeof(bindack);

    uint8_t request[] = {
        0x05, 0x00, 0x00, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x38, 0x06, 0x00, 0x00, 0xe5, 0x00, 0x00, 0x00,
        0x20, 0x06, 0x00, 0x00, 0x01, 0x00, 0x04, 0x00,
        0x05, 0x00, 0x06, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x32, 0x24, 0x58, 0xfd,
        0xcc, 0x45, 0x64, 0x49, 0xb0, 0x70, 0xdd, 0xae,
        0x74, 0x2c, 0x96, 0xd2, 0x60, 0x5e, 0x0d, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x70, 0x5e, 0x0d, 0x00, 0x02, 0x00, 0x00, 0x00,
        0x7c, 0x5e, 0x0d, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x10, 0x00, 0x00, 0x00, 0x80, 0x96, 0xf1, 0xf1,
        0x2a, 0x4d, 0xce, 0x11, 0xa6, 0x6a, 0x00, 0x20,
        0xaf, 0x6e, 0x72, 0xf4, 0x0c, 0x00, 0x00, 0x00,
        0x4d, 0x41, 0x52, 0x42, 0x01, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x0d, 0xf0, 0xad, 0xba,
        0x00, 0x00, 0x00, 0x00, 0xa8, 0xf4, 0x0b, 0x00,
        0xb0, 0x05, 0x00, 0x00, 0xb0, 0x05, 0x00, 0x00,
        0x4d, 0x45, 0x4f, 0x57, 0x04, 0x00, 0x00, 0x00,
        0xa2, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0xc0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x46,
        0x38, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0xc0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x46,
        0x00, 0x00, 0x00, 0x00, 0x80, 0x05, 0x00, 0x00,
        0x78, 0x05, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x01, 0x10, 0x08, 0x00, 0xcc, 0xcc, 0xcc, 0xcc,
        0xc8, 0x00, 0x00, 0x00, 0x4d, 0x45, 0x4f, 0x57,
        0x78, 0x05, 0x00, 0x00, 0xd8, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x00, 0x00,
        0x07, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0xc4, 0x28, 0xcd, 0x00,
        0x64, 0x29, 0xcd, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x07, 0x00, 0x00, 0x00, 0xb9, 0x01, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0xc0, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x46, 0xab, 0x01, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0xc0, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x46, 0xa5, 0x01, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0xc0, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x46, 0xa6, 0x01, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0xc0, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x46, 0xa4, 0x01, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0xc0, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x46, 0xad, 0x01, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0xc0, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x46, 0xaa, 0x01, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0xc0, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x46, 0x07, 0x00, 0x00, 0x00,
        0x60, 0x00, 0x00, 0x00, 0x58, 0x00, 0x00, 0x00,
        0x90, 0x00, 0x00, 0x00, 0x40, 0x00, 0x00, 0x00,
        0x20, 0x00, 0x00, 0x00, 0xc8, 0x02, 0x00, 0x00,
        0x30, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x01, 0x10, 0x08, 0x00, 0xcc, 0xcc, 0xcc, 0xcc,
        0x50, 0x00, 0x00, 0x00, 0x4f, 0xb6, 0x88, 0x20,
        0xff, 0xff, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x01, 0x10, 0x08, 0x00, 0xcc, 0xcc, 0xcc, 0xcc,
        0x48, 0x00, 0x00, 0x00, 0x07, 0x00, 0x66, 0x00,
        0x06, 0x09, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00,
        0xc0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x46,
        0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x78, 0x19, 0x0c, 0x00,
        0x58, 0x00, 0x00, 0x00, 0x05, 0x00, 0x06, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x70, 0xd8, 0x98, 0x93,
        0x98, 0x4f, 0xd2, 0x11, 0xa9, 0x3d, 0xbe, 0x57,
        0xb2, 0x00, 0x00, 0x00, 0x32, 0x00, 0x31, 0x00,
        0x01, 0x10, 0x08, 0x00, 0xcc, 0xcc, 0xcc, 0xcc,
        0x80, 0x00, 0x00, 0x00, 0x0d, 0xf0, 0xad, 0xba,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x18, 0x43, 0x14, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x60, 0x00, 0x00, 0x00, 0x60, 0x00, 0x00, 0x00,
        0x4d, 0x45, 0x4f, 0x57, 0x04, 0x00, 0x00, 0x00,
        0xc0, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0xc0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x46,
        0x3b, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0xc0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x46,
        0x00, 0x00, 0x00, 0x00, 0x30, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x01, 0x00, 0x81, 0xc5, 0x17, 0x03,
        0x80, 0x0e, 0xe9, 0x4a, 0x99, 0x99, 0xf1, 0x8a,
        0x50, 0x6f, 0x7a, 0x85, 0x02, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x01, 0x10, 0x08, 0x00, 0xcc, 0xcc, 0xcc, 0xcc,
        0x30, 0x00, 0x00, 0x00, 0x78, 0x00, 0x6e, 0x00,
        0x00, 0x00, 0x00, 0x00, 0xd8, 0xda, 0x0d, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x20, 0x2f, 0x0c, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x03, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x03, 0x00, 0x00, 0x00,
        0x46, 0x00, 0x58, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x01, 0x10, 0x08, 0x00, 0xcc, 0xcc, 0xcc, 0xcc,
        0x10, 0x00, 0x00, 0x00, 0x30, 0x00, 0x2e, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x01, 0x10, 0x08, 0x00, 0xcc, 0xcc, 0xcc, 0xcc,
        0x68, 0x00, 0x00, 0x00, 0x0e, 0x00, 0xff, 0xff,
        0x68, 0x8b, 0x0b, 0x00, 0x02, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x4e, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x4e, 0x01, 0x00, 0x00, 0x5c, 0x00, 0x5c, 0x00,
        0x31, 0x00, 0x32, 0x00, 0x37, 0x00, 0x2e, 0x00,
        0x30, 0x00, 0x2e, 0x00, 0x30, 0x00, 0x2e, 0x00,
        0x31, 0x00, 0x5c, 0x00, 0x49, 0x00, 0x50, 0x00,
        0x43, 0x00, 0x24, 0x00, 0x5c, 0x00, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0xeb, 0x10, 0x5a, 0x4a,
        0x33, 0xc9, 0x66, 0xb9, 0x3e, 0x01, 0x80, 0x34,
        0x0a, 0x99, 0xe2, 0xfa, 0xeb, 0x05, 0xe8, 0xeb,
        0xff, 0xff, 0xff, 0x70, 0x31, 0x99, 0x99, 0x99,
        0xc3, 0x21, 0x95, 0x69, 0x64, 0xe6, 0x12, 0x99,
        0x12, 0xe9, 0x85, 0x34, 0x12, 0xd9, 0x91, 0x12,
        0x41, 0x12, 0xea, 0xa5, 0x9a, 0x6a, 0x12, 0xef,
        0xe1, 0x9a, 0x6a, 0x12, 0xe7, 0xb9, 0x9a, 0x62,
        0x12, 0xd7, 0x8d, 0xaa, 0x74, 0xcf, 0xce, 0xc8,
        0x12, 0xa6, 0x9a, 0x62, 0x12, 0x6b, 0xf3, 0x97,
        0xc0, 0x6a, 0x3f, 0xed, 0x91, 0xc0, 0xc6, 0x1a,
        0x5e, 0x9d, 0xdc, 0x7b, 0x70, 0xc0, 0xc6, 0xc7,
        0x12, 0x54, 0x12, 0xdf, 0xbd, 0x9a, 0x5a, 0x48,
        0x78, 0x9a, 0x58, 0xaa, 0x50, 0xff, 0x12, 0x91,
        0x12, 0xdf, 0x85, 0x9a, 0x5a, 0x58, 0x78, 0x9b,
        0x9a, 0x58, 0x12, 0x99, 0x9a, 0x5a, 0x12, 0x63,
        0x12, 0x6e, 0x1a, 0x5f, 0x97, 0x12, 0x49, 0xf3,
        0x9a, 0xc0, 0x71, 0xbd, 0x99, 0x99, 0x99, 0xf1,
        0x66, 0x66, 0x66, 0x99, 0xf1, 0x99, 0x89, 0x99,
        0x99, 0xf3, 0x9d, 0x66, 0xce, 0x6d, 0x22, 0x81,
        0x69, 0x64, 0xe6, 0x10, 0x9a, 0x1a, 0x5f, 0x95,
        0xaa, 0x59, 0xc9, 0xcf, 0x66, 0xce, 0x61, 0xc9,
        0x66, 0xce, 0x65, 0xaa, 0x59, 0x35, 0x1c, 0x59,
        0xec, 0x60, 0xc8, 0xcb, 0xcf, 0xca, 0x66, 0x4b,
        0xc3, 0xc0, 0x32, 0x7b, 0x77, 0xaa, 0x59, 0x5a,
        0x71, 0xca, 0x66, 0x66, 0x66, 0xde, 0xfc, 0xed,
        0xc9, 0xeb, 0xf6, 0xfa, 0xd8, 0xfd, 0xfd, 0xeb,
        0xfc, 0xea, 0xea, 0x99, 0xd1, 0xfc, 0xf8, 0xe9,
        0xda, 0xeb, 0xfc, 0xf8, 0xed, 0xfc, 0x99, 0xce,
        0xf0, 0xf7, 0xdc, 0xe1, 0xfc, 0xfa, 0x99, 0xdc,
        0xe1, 0xf0, 0xed, 0xc9, 0xeb, 0xf6, 0xfa, 0xfc,
        0xea, 0xea, 0x99, 0xfa, 0xf4, 0xfd, 0xb9, 0xb6,
        0xfa, 0xb9, 0xf7, 0xfc, 0xed, 0xb9, 0xec, 0xea,
        0xfc, 0xeb, 0xb9, 0xfc, 0xb9, 0xf8, 0xea, 0xfd,
        0xba, 0xaa, 0xab, 0xa8, 0xb9, 0xb6, 0xf8, 0xfd,
        0xfd, 0xb9, 0xbf, 0xbf, 0xb9, 0xf7, 0xfc, 0xed,
        0xb9, 0xf5, 0xf6, 0xfa, 0xf8, 0xf5, 0xfe, 0xeb,
        0xf6, 0xec, 0xe9, 0xb9, 0xf8, 0xfd, 0xf4, 0xf0,
        0xf7, 0xf0, 0xea, 0xed, 0xeb, 0xf8, 0xed, 0xf6,
        0xeb, 0xea, 0xb9, 0xfc, 0xb9, 0xb6, 0xf8, 0xfd,
        0xfd, 0x99, 0x00, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0xe9, 0xf3, 0xfd, 0xff,
        0xff, 0x45, 0x45, 0x45, 0x96, 0xb4, 0xa1, 0x77,
        0x4c, 0x14, 0x54, 0x7c, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x00, 0x5c, 0x00, 0x43, 0x00,
        0x24, 0x00, 0x5c, 0x00, 0x31, 0x00, 0x32, 0x00,
        0x33, 0x00, 0x34, 0x00, 0x35, 0x00, 0x36, 0x00,
        0x31, 0x00, 0x31, 0x00, 0x31, 0x00, 0x31, 0x00,
        0x31, 0x00, 0x31, 0x00, 0x31, 0x00, 0x31, 0x00,
        0x31, 0x00, 0x31, 0x00, 0x31, 0x00, 0x31, 0x00,
        0x31, 0x00, 0x31, 0x00, 0x31, 0x00, 0x2e, 0x00,
        0x64, 0x00, 0x6f, 0x00, 0x63, 0x00, 0x00, 0x00,
        0x01, 0x10, 0x08, 0x00, 0xcc, 0xcc, 0xcc, 0xcc,
        0x20, 0x00, 0x00, 0x00, 0x30, 0x00, 0x2d, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x88, 0x2a, 0x0c, 0x00,
        0x02, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x28, 0x8c, 0x0c, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x07, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    };
    uint32_t request_len = sizeof(request);

    uint8_t fault[] = {
        0x05, 0x00, 0x03, 0x23, 0x10, 0x00, 0x00, 0x00,
        0x20, 0x00, 0x00, 0x00, 0xe5, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x03, 0x00, 0x01, 0x1c, 0x00, 0x00, 0x00, 0x00,
    };
    uint32_t fault_len = sizeof(fault);

    DCERPCState *state;
    Flow f;
    TcpSession ssn;
    int r;
    UUID *uuid = NULL;
    DCERPCTx *tx = NULL;

    memset(&f, 0, sizeof(f));
    memset(&ssn, 0, sizeof(ssn));
    FLOW_INITIALIZE(&f);
    f.protoctx = (void *)&ssn;

    StreamTcpInitConfig(TRUE);

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER | STREAM_START, bind, bind_len);
    if (r != 0) {
        printf("failure parsing bind\n");
        goto end;
    }
    state = f.alstate;
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 11 ||
        state->connp[0].pfc_flags != 0x03 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 72 ||
        state->connp[0].call_id != 127 ||
        state->connp[0].assoc_group_id != 0 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[0].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 0) {
        printf("failure1\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x000001a0 ||
         *((uint16_t *)uuid->uuid + 2) != 0x0000 ||
         *((uint16_t *)uuid->uuid + 3) != 0x0000 ||
         *((uint16_t *)uuid->uuid + 4) != 0xc000 ||
         uuid->uuid[10] != 0x00 || uuid->uuid[11] != 0x00 ||
         uuid->uuid[12] != 0x00 || uuid->uuid[13] != 0x00 ||
         uuid->uuid[14] != 0x00 || uuid->uuid[15] != 0x46) ||
        uuid->accepted != 0 ||
        uuid->iv != 0 ||
        uuid->context_id != 1) {
        printf("failure 1_1\n");
        goto end;
    }

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, bindack, bindack_len);
    if (r != 0) {
        printf("failure parsing bindack\n");
        goto end;
    }
    if (state->connp[1].rpc_vers_minor != 0 ||
        state->connp[1].ptype != 12 ||
        state->connp[1].pfc_flags != 0x03 ||
        state->connp[1].auth_length != 0 ||
        state->connp[1].frag_length != 60 ||
        state->connp[1].call_id != 127 ||
        state->connp[1].assoc_group_id != 0x00011c64 ||
        state->connp[1].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 0) {
        printf("failure2\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x000001a0 ||
         *((uint16_t *)uuid->uuid + 2) != 0x0000 ||
         *((uint16_t *)uuid->uuid + 3) != 0x0000 ||
         *((uint16_t *)uuid->uuid + 4) != 0xc000 ||
         uuid->uuid[10] != 0x00 || uuid->uuid[11] != 0x00 ||
         uuid->uuid[12] != 0x00 || uuid->uuid[13] != 0x00 ||
         uuid->uuid[14] != 0x00 || uuid->uuid[15] != 0x46) ||
        uuid->accepted != 0 ||
        uuid->iv != 0 ||
        uuid->context_id != 1) {
        printf("failure 2_1\n");
        goto end;
    }

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER, request, request_len);
    if (r != 0) {
        printf("failure parsing request\n");
        goto end;
    }
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 0 ||
        state->connp[0].pfc_flags != 0x03 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 1592 ||
        state->connp[0].call_id != 229 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[0].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure3\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x000001a0 ||
         *((uint16_t *)uuid->uuid + 2) != 0x0000 ||
         *((uint16_t *)uuid->uuid + 3) != 0x0000 ||
         *((uint16_t *)uuid->uuid + 4) != 0xc000 ||
         uuid->uuid[10] != 0x00 || uuid->uuid[11] != 0x00 ||
         uuid->uuid[12] != 0x00 || uuid->uuid[13] != 0x00 ||
         uuid->uuid[14] != 0x00 || uuid->uuid[15] != 0x46) ||
        uuid->accepted != 0 ||
        uuid->iv != 0 ||
        uuid->context_id != 1) {
        printf("failure 3_1\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 229 ||
        tx->opnum != 4 ||
        tx->stub_len[0] != 1568 ||
        tx->stub_len[1] != 0) {
        printf("failure 3_2\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x000001a0 ||
         *((uint16_t *)tx->iface.uuid + 2) != 0x0000 ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x0000 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0xc000 ||
         tx->iface.uuid[10] != 0x00 || tx->iface.uuid[11] != 0x00 ||
         tx->iface.uuid[12] != 0x00 || tx->iface.uuid[13] != 0x00 ||
         tx->iface.uuid[14] != 0x00 || tx->iface.uuid[15] != 0x46)) {
        printf("failure 3_3\n");
        goto end;
    }

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, fault, fault_len);
    if (r != 0) {
        printf("failure parsing fault\n");
        goto end;
    }
    if (state->connp[1].rpc_vers_minor != 0 ||
        state->connp[1].ptype != 3 ||
        state->connp[1].pfc_flags != 0x23 ||
        state->connp[1].auth_length != 0 ||
        state->connp[1].frag_length != 32 ||
        state->connp[1].call_id != 229 ||
        state->connp[1].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure4\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x000001a0 ||
         *((uint16_t *)uuid->uuid + 2) != 0x0000 ||
         *((uint16_t *)uuid->uuid + 3) != 0x0000 ||
         *((uint16_t *)uuid->uuid + 4) != 0xc000 ||
         uuid->uuid[10] != 0x00 || uuid->uuid[11] != 0x00 ||
         uuid->uuid[12] != 0x00 || uuid->uuid[13] != 0x00 ||
         uuid->uuid[14] != 0x00 || uuid->uuid[15] != 0x46) ||
        uuid->accepted != 0 ||
        uuid->iv != 0 ||
        uuid->context_id != 1) {
        printf("failure 4_1\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 229 ||
        tx->opnum != 4 ||
        tx->stub_len[0] != 1568 ||
        tx->stub_len[1] != 0) {
        printf("failure 4_2\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x000001a0 ||
         *((uint16_t *)tx->iface.uuid + 2) != 0x0000 ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x0000 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0xc000 ||
         tx->iface.uuid[10] != 0x00 || tx->iface.uuid[11] != 0x00 ||
         tx->iface.uuid[12] != 0x00 || tx->iface.uuid[13] != 0x00 ||
         tx->iface.uuid[14] != 0x00 || tx->iface.uuid[15] != 0x46)) {
        printf("failure 4_3\n");
        goto end;
    }

    result = 1;

end:
    StreamTcpFreeConfig(TRUE);
    FLOW_DESTROY(&f);
    return result;
}

/**
 * \test bind, bind_ack, auth3,
 *       private_workstation_1_31_dynamic_encrypted_nofrags.pcap.
 *       pdus 10, 11, 12.
 */
int DCERPCParserTest03(void)
{
    int result = 0;

    uint8_t bind[] = {
        0x05, 0x00, 0x0b, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x70, 0x00, 0x20, 0x00, 0x01, 0x00, 0x00, 0x00,
        0xb8, 0x10, 0xb8, 0x10, 0x00, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00,
        0x98, 0xd0, 0xff, 0x6b, 0x12, 0xa1, 0x10, 0x36,
        0x98, 0x33, 0x46, 0xc3, 0xf8, 0x7e, 0x34, 0x5a,
        0x01, 0x00, 0x00, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
        0x0a, 0x06, 0x00, 0x00, 0x7f, 0x35, 0x01, 0x00,
        0x4e, 0x54, 0x4c, 0x4d, 0x53, 0x53, 0x50, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x31, 0x02, 0x00, 0x60,
        0x00, 0x00, 0x00, 0x00, 0x20, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x20, 0x00, 0x00, 0x00
    };
    uint32_t bind_len = sizeof(bind);

    uint8_t bindack[] = {
        0x05, 0x00, 0x0c, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x74, 0x00, 0x30, 0x00, 0x01, 0x00, 0x00, 0x00,
        0xb8, 0x10, 0xb8, 0x10, 0x7f, 0xa8, 0x00, 0x00,
        0x05, 0x00, 0x31, 0x30, 0x32, 0x35, 0x00, 0x01,
        0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00, 0x0a, 0x06, 0x00, 0x00,
        0x7f, 0x35, 0x01, 0x00, 0x4e, 0x54, 0x4c, 0x4d,
        0x53, 0x53, 0x50, 0x00, 0x02, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x30, 0x00, 0x00, 0x00,
        0x31, 0x02, 0x00, 0x60, 0x27, 0x0b, 0xdb, 0x2f,
        0x5c, 0x27, 0x4c, 0xff, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x30, 0x00, 0x00, 0x00
    };
    uint32_t bindack_len = sizeof(bindack);

    uint8_t auth3[] = {
        0x05, 0x00, 0x10, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x70, 0x00, 0x58, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x0a, 0x06, 0x00, 0x00, 0x7f, 0x35, 0x01, 0x00,
        0x4e, 0x54, 0x4c, 0x4d, 0x53, 0x53, 0x50, 0x00,
        0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x48, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x48, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x40, 0x00, 0x00, 0x00, 0x08, 0x00, 0x08, 0x00,
        0x40, 0x00, 0x00, 0x00, 0x10, 0x00, 0x10, 0x00,
        0x48, 0x00, 0x00, 0x00, 0x31, 0x02, 0x00, 0x60,
        0x4e, 0x00, 0x55, 0x00, 0x4c, 0x00, 0x4c, 0x00,
        0x9f, 0x59, 0xc8, 0x00, 0xe2, 0x76, 0x1c, 0x7b,
        0xcb, 0x47, 0x5f, 0x26, 0x16, 0x2f, 0xd3, 0x2c
    };
    uint32_t auth3_len = sizeof(auth3);

    DCERPCState *state;
    Flow f;
    TcpSession ssn;
    int r;
    UUID *uuid = NULL;

    memset(&f, 0, sizeof(f));
    memset(&ssn, 0, sizeof(ssn));
    FLOW_INITIALIZE(&f);
    f.protoctx = (void *)&ssn;

    StreamTcpInitConfig(TRUE);

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER | STREAM_START, bind, bind_len);
    if (r != 0) {
        printf("failure parsing bind\n");
        goto end;
    }
    state = f.alstate;
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 11 ||
        state->connp[0].pfc_flags != 0x03 ||
        state->connp[0].auth_length != 32 ||
        state->connp[0].frag_length != 112 ||
        state->connp[0].call_id != 1 ||
        state->connp[0].assoc_group_id != 0 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[0].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 0) {
        printf("failure1\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x6bffd098 ||
         *((uint16_t *)uuid->uuid + 2) != 0xa112 ||
         *((uint16_t *)uuid->uuid + 3) != 0x3610 ||
         *((uint16_t *)uuid->uuid + 4) != 0x9833 ||
         uuid->uuid[10] != 0x46 || uuid->uuid[11] != 0xc3 ||
         uuid->uuid[12] != 0xf8 || uuid->uuid[13] != 0x7e ||
         uuid->uuid[14] != 0x34 || uuid->uuid[15] != 0x5a) ||
        uuid->accepted != 0 ||
        uuid->iv != 1 ||
        uuid->context_id != 0) {
        printf("failure 1_1\n");
        goto end;
    }

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, bindack, bindack_len);
    if (r != 0) {
        printf("failure parsing bindack\n");
        goto end;
    }
    if (state->connp[1].rpc_vers_minor != 0 ||
        state->connp[1].ptype != 12 ||
        state->connp[1].pfc_flags != 0x03 ||
        state->connp[1].auth_length != 48 ||
        state->connp[1].frag_length != 116 ||
        state->connp[1].call_id != 1 ||
        state->connp[1].assoc_group_id != 0x0000a87f ||
        state->connp[1].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0) {
        printf("failure2\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x6bffd098 ||
         *((uint16_t *)uuid->uuid + 2) != 0xa112 ||
         *((uint16_t *)uuid->uuid + 3) != 0x3610 ||
         *((uint16_t *)uuid->uuid + 4) != 0x9833 ||
         uuid->uuid[10] != 0x46 || uuid->uuid[11] != 0xc3 ||
         uuid->uuid[12] != 0xf8 || uuid->uuid[13] != 0x7e ||
         uuid->uuid[14] != 0x34 || uuid->uuid[15] != 0x5a) ||
        uuid->accepted != 1 ||
        uuid->iv != 1 ||
        uuid->context_id != 0) {
        printf("failure 2_1\n");
        goto end;
    }

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER, auth3, auth3_len);
    if (r != 0) {
        printf("failure parsing auth3\n");
        goto end;
    }
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 16 ||
        state->connp[0].pfc_flags != 0x03 ||
        state->connp[0].auth_length != 88 ||
        state->connp[0].frag_length != 112 ||
        state->connp[0].call_id != 1 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[0].pdu_bytes_processed != 0) {
        printf("failure3\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x6bffd098 ||
         *((uint16_t *)uuid->uuid + 2) != 0xa112 ||
         *((uint16_t *)uuid->uuid + 3) != 0x3610 ||
         *((uint16_t *)uuid->uuid + 4) != 0x9833 ||
         uuid->uuid[10] != 0x46 || uuid->uuid[11] != 0xc3 ||
         uuid->uuid[12] != 0xf8 || uuid->uuid[13] != 0x7e ||
         uuid->uuid[14] != 0x34 || uuid->uuid[15] != 0x5a) ||
        uuid->accepted != 1 ||
        uuid->iv != 1 ||
        uuid->context_id != 0) {
        printf("failure 3_1\n");
        goto end;
    }

    result = 1;

end:
    StreamTcpFreeConfig(TRUE);
    FLOW_DESTROY(&f);
    return result;
}

/**
 * \test bind, bind_ack, request, response, alter_context, alter_context_resp.
 *       private_3328-2.pcap. pdus 12, 13, 14, 15, 33, 34.
 */
int DCERPCParserTest04(void)
{
    int result = 0;

    uint8_t bind[] = {
        0x05, 0x00, 0x0b, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x48, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0xd0, 0x16, 0xd0, 0x16, 0x00, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00,
        0x40, 0xfd, 0x2c, 0x34, 0x6c, 0x3c, 0xce, 0x11,
        0xa8, 0x93, 0x08, 0x00, 0x2b, 0x2e, 0x9c, 0x6d,
        0x00, 0x00, 0x00, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
    };
    uint32_t bind_len = sizeof(bind);

    uint8_t bindack[] = {
        0x05, 0x00, 0x0c, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x44, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0xb8, 0x10, 0xb8, 0x10, 0x7d, 0xd8, 0x00, 0x00,
        0x0d, 0x00, 0x5c, 0x70, 0x69, 0x70, 0x65, 0x5c,
        0x6c, 0x6c, 0x73, 0x72, 0x70, 0x63, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00,
    };
    uint32_t bindack_len = sizeof(bindack);

    uint8_t request[] = {
        0x05, 0x00, 0x00, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x38, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x20, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x09, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x09, 0x00, 0x00, 0x00, 0x47, 0x00, 0x41, 0x00,
        0x52, 0x00, 0x4c, 0x00, 0x4f, 0x00, 0x41, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
    };
    uint32_t request_len = sizeof(request);

    uint8_t response[] = {
        0x05, 0x00, 0x02, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x30, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x18, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x07, 0x9f, 0x13, 0xd9,
        0x2d, 0x97, 0xf4, 0x4a, 0xac, 0xc2, 0xbc, 0x70,
        0xec, 0xaa, 0x9a, 0xd3, 0x00, 0x00, 0x00, 0x00,
    };
    uint32_t response_len = sizeof(response);

    uint8_t alter_context[] = {
        0x05, 0x00, 0x0e, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x48, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0xd0, 0x16, 0xd0, 0x16, 0x00, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x01, 0x00, 0x01, 0x00,
        0xd0, 0x4c, 0x67, 0x57, 0x00, 0x52, 0xce, 0x11,
        0xa8, 0x97, 0x08, 0x00, 0x2b, 0x2e, 0x9c, 0x6d,
        0x01, 0x00, 0x00, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
    };
    uint32_t alter_context_len = sizeof(alter_context);

    uint8_t alter_context_resp[] = {
        0x05, 0x00, 0x0f, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x38, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0xb8, 0x10, 0xb8, 0x10, 0x7d, 0xd8, 0x00, 0x00,
        0x00, 0x00, 0x08, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
    };
    uint32_t alter_context_resp_len = sizeof(alter_context_resp);

    DCERPCState *state;
    Flow f;
    TcpSession ssn;
    int r;
    UUID *uuid = NULL;
    DCERPCTx *tx = NULL;

    memset(&f, 0, sizeof(f));
    memset(&ssn, 0, sizeof(ssn));
    FLOW_INITIALIZE(&f);
    f.protoctx = (void *)&ssn;

    StreamTcpInitConfig(TRUE);

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER | STREAM_START, bind, bind_len);
    if (r != 0) {
        printf("failure parsing bind\n");
        goto end;
    }
    state = f.alstate;
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 11 ||
        state->connp[0].pfc_flags != 0x03 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 72 ||
        state->connp[0].call_id != 1 ||
        state->connp[0].assoc_group_id != 0 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[0].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 0) {
        printf("failure1\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x342cfd40 ||
         *((uint16_t *)uuid->uuid + 2) != 0x3c6c ||
         *((uint16_t *)uuid->uuid + 3) != 0x11ce ||
         *((uint16_t *)uuid->uuid + 4) != 0xa893 ||
         uuid->uuid[10] != 0x08 || uuid->uuid[11] != 0x00 ||
         uuid->uuid[12] != 0x2b || uuid->uuid[13] != 0x2e ||
         uuid->uuid[14] != 0x9c || uuid->uuid[15] != 0x6d) ||
        uuid->accepted != 0 ||
        uuid->iv != 0 ||
        uuid->context_id != 0) {
        printf("failure 1_1\n");
        goto end;
    }

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, bindack, bindack_len);
    if (r != 0) {
        printf("failure parsing bindack\n");
        goto end;
    }
    if (state->connp[1].rpc_vers_minor != 0 ||
        state->connp[1].ptype != 12 ||
        state->connp[1].pfc_flags != 0x03 ||
        state->connp[1].auth_length != 0 ||
        state->connp[1].frag_length != 68 ||
        state->connp[1].call_id != 1 ||
        state->connp[1].assoc_group_id != 0x0000d87d ||
        state->connp[1].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 0) {
        printf("failure2\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x342cfd40 ||
         *((uint16_t *)uuid->uuid + 2) != 0x3c6c ||
         *((uint16_t *)uuid->uuid + 3) != 0x11ce ||
         *((uint16_t *)uuid->uuid + 4) != 0xa893 ||
         uuid->uuid[10] != 0x08 || uuid->uuid[11] != 0x00 ||
         uuid->uuid[12] != 0x2b || uuid->uuid[13] != 0x2e ||
         uuid->uuid[14] != 0x9c || uuid->uuid[15] != 0x6d) ||
        uuid->accepted != 1 ||
        uuid->iv != 0 ||
        uuid->context_id != 0) {
        printf("failure 2_1\n");
        goto end;
    }

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER, request, request_len);
    if (r != 0) {
        printf("failure parsing request\n");
        goto end;
    }
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 0 ||
        state->connp[0].pfc_flags != 0x03 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 56 ||
        state->connp[0].call_id != 1 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[0].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure3\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x342cfd40 ||
         *((uint16_t *)uuid->uuid + 2) != 0x3c6c ||
         *((uint16_t *)uuid->uuid + 3) != 0x11ce ||
         *((uint16_t *)uuid->uuid + 4) != 0xa893 ||
         uuid->uuid[10] != 0x08 || uuid->uuid[11] != 0x00 ||
         uuid->uuid[12] != 0x2b || uuid->uuid[13] != 0x2e ||
         uuid->uuid[14] != 0x9c || uuid->uuid[15] != 0x6d) ||
        uuid->accepted != 1 ||
        uuid->iv != 0 ||
        uuid->context_id != 0) {
        printf("failure 3_1\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 1 ||
        tx->opnum != 0 ||
        tx->stub_len[0] != 32 ||
        tx->stub_len[1] != 0) {
        printf("failure 3_2\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x342cfd40 ||
         *((uint16_t *)tx->iface.uuid + 2) != 0x3c6c ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x11ce ||
         *((uint16_t *)tx->iface.uuid + 4) != 0xa893 ||
         tx->iface.uuid[10] != 0x08 || tx->iface.uuid[11] != 0x00 ||
         tx->iface.uuid[12] != 0x2b || tx->iface.uuid[13] != 0x2e ||
         tx->iface.uuid[14] != 0x9c || tx->iface.uuid[15] != 0x6d)) {
        printf("failure 3_3\n");
        goto end;
    }

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, response, response_len);
    if (r != 0) {
        printf("failure parsing response\n");
        goto end;
    }
    if (state->connp[1].rpc_vers_minor != 0 ||
        state->connp[1].ptype != 2 ||
        state->connp[1].pfc_flags != 0x03 ||
        state->connp[1].auth_length != 0 ||
        state->connp[1].frag_length != 48 ||
        state->connp[1].call_id != 1 ||
        state->connp[1].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure4\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x342cfd40 ||
         *((uint16_t *)uuid->uuid + 2) != 0x3c6c ||
         *((uint16_t *)uuid->uuid + 3) != 0x11ce ||
         *((uint16_t *)uuid->uuid + 4) != 0xa893 ||
         uuid->uuid[10] != 0x08 || uuid->uuid[11] != 0x00 ||
         uuid->uuid[12] != 0x2b || uuid->uuid[13] != 0x2e ||
         uuid->uuid[14] != 0x9c || uuid->uuid[15] != 0x6d) ||
        uuid->accepted != 1 ||
        uuid->iv != 0 ||
        uuid->context_id != 0) {
        printf("failure 4_1\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 1 ||
        tx->opnum != 0 ||
        tx->stub_len[0] != 32 ||
        tx->stub_len[1] != 24) {
        printf("failure 4_2\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x342cfd40 ||
         *((uint16_t *)tx->iface.uuid + 2) != 0x3c6c ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x11ce ||
         *((uint16_t *)tx->iface.uuid + 4) != 0xa893 ||
         tx->iface.uuid[10] != 0x08 || tx->iface.uuid[11] != 0x00 ||
         tx->iface.uuid[12] != 0x2b || tx->iface.uuid[13] != 0x2e ||
         tx->iface.uuid[14] != 0x9c || tx->iface.uuid[15] != 0x6d)) {
        printf("failure 4_3\n");
        goto end;
    }

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER, alter_context, alter_context_len);
    if (r != 0) {
        printf("failure parsing alter_context\n");
        goto end;
    }
    state = f.alstate;
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 14 ||
        state->connp[0].pfc_flags != 0x03 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 72 ||
        state->connp[0].call_id != 1 ||
        state->connp[0].assoc_group_id != 0 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[0].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure5\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x57674cd0 ||
         *((uint16_t *)uuid->uuid + 2) != 0x5200 ||
         *((uint16_t *)uuid->uuid + 3) != 0x11ce ||
         *((uint16_t *)uuid->uuid + 4) != 0xa897 ||
         uuid->uuid[10] != 0x08 || uuid->uuid[11] != 0x00 ||
         uuid->uuid[12] != 0x2b || uuid->uuid[13] != 0x2e ||
         uuid->uuid[14] != 0x9c || uuid->uuid[15] != 0x6d) ||
        uuid->accepted != 0 ||
        uuid->iv != 1 ||
        uuid->context_id != 1) {
        printf("failure 5_1\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 1 ||
        tx->opnum != 0 ||
        tx->stub_len[0] != 32 ||
        tx->stub_len[1] != 24) {
        printf("failure 5_2\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x342cfd40 ||
         *((uint16_t *)tx->iface.uuid + 2) != 0x3c6c ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x11ce ||
         *((uint16_t *)tx->iface.uuid + 4) != 0xa893 ||
         tx->iface.uuid[10] != 0x08 || tx->iface.uuid[11] != 0x00 ||
         tx->iface.uuid[12] != 0x2b || tx->iface.uuid[13] != 0x2e ||
         tx->iface.uuid[14] != 0x9c || tx->iface.uuid[15] != 0x6d)) {
        printf("failure 5_3\n");
        goto end;
    }

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, alter_context_resp, alter_context_resp_len);
    if (r != 0) {
        printf("failure parsing alter_context_resp\n");
        goto end;
    }
    if (state->connp[1].rpc_vers_minor != 0 ||
        state->connp[1].ptype != 15 ||
        state->connp[1].pfc_flags != 0x03 ||
        state->connp[1].auth_length != 0 ||
        state->connp[1].frag_length != 56 ||
        state->connp[1].call_id != 1 ||
        state->connp[1].assoc_group_id != 0x0000d87d ||
        state->connp[1].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure6\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x57674cd0 ||
         *((uint16_t *)uuid->uuid + 2) != 0x5200 ||
         *((uint16_t *)uuid->uuid + 3) != 0x11ce ||
         *((uint16_t *)uuid->uuid + 4) != 0xa897 ||
         uuid->uuid[10] != 0x08 || uuid->uuid[11] != 0x00 ||
         uuid->uuid[12] != 0x2b || uuid->uuid[13] != 0x2e ||
         uuid->uuid[14] != 0x9c || uuid->uuid[15] != 0x6d) ||
        uuid->accepted != 1 ||
        uuid->iv != 1 ||
        uuid->context_id != 1) {
        printf("failure 6_1\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 1 ||
        tx->opnum != 0 ||
        tx->stub_len[0] != 32 ||
        tx->stub_len[1] != 24) {
        printf("failure 6_2\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x342cfd40 ||
         *((uint16_t *)tx->iface.uuid + 2) != 0x3c6c ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x11ce ||
         *((uint16_t *)tx->iface.uuid + 4) != 0xa893 ||
         tx->iface.uuid[10] != 0x08 || tx->iface.uuid[11] != 0x00 ||
         tx->iface.uuid[12] != 0x2b || tx->iface.uuid[13] != 0x2e ||
         tx->iface.uuid[14] != 0x9c || tx->iface.uuid[15] != 0x6d)) {
        printf("failure 6_3\n");
        goto end;
    }

    result = 1;

end:
    StreamTcpFreeConfig(TRUE);
    FLOW_DESTROY(&f);
    return result;
}

/**
 * \test private_5547-0.pcap.
 *
 *       Multiple binds.  bind, bindack, request, response, bind, bindack,
 *       request, response.
 *
 *       Pdus 15, 16, 17, 18, 23, 24.
 */
int DCERPCParserTest05(void)
{
    int result = 0;

    uint8_t bind1[] = {
        0x05, 0x00, 0x0b, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x48, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0xb8, 0x10, 0xb8, 0x10, 0x00, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00,
        0x98, 0xd0, 0xff, 0x6b, 0x12, 0xa1, 0x10, 0x36,
        0x98, 0x33, 0x46, 0xc3, 0xf8, 0x7e, 0x34, 0x5a,
        0x01, 0x00, 0x00, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
    };
    uint32_t bind1_len = sizeof(bind1);

    uint8_t bindack1[] = {
        0x05, 0x00, 0x0c, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x44, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0xb8, 0x10, 0xb8, 0x10, 0x56, 0x47, 0x00, 0x00,
        0x0d, 0x00, 0x5c, 0x50, 0x49, 0x50, 0x45, 0x5c,
        0x77, 0x6b, 0x73, 0x73, 0x76, 0x63, 0x00, 0xff,
        0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00
    };
    uint32_t bindack1_len = sizeof(bindack1);

    uint8_t request1[] = {
        0x05, 0x00, 0x00, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x4c, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x34, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0xb0, 0xe2, 0xe3, 0x00, 0x10, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00,
        0x5c, 0x00, 0x5c, 0x00, 0x36, 0x00, 0x34, 0x00,
        0x2e, 0x00, 0x31, 0x00, 0x30, 0x00, 0x31, 0x00,
        0x2e, 0x00, 0x31, 0x00, 0x38, 0x00, 0x32, 0x00,
        0x2e, 0x00, 0x39, 0x00, 0x30, 0x00, 0x00, 0x00,
        0x64, 0x00, 0x00, 0x00,
    };
    uint32_t request1_len = sizeof(request1);

    uint8_t response1[] = {
        0x05, 0x00, 0x02, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x78, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x60, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x64, 0x00, 0x00, 0x00, 0xb8, 0x0f, 0x16, 0x00,
        0xf4, 0x01, 0x00, 0x00, 0xe6, 0x0f, 0x16, 0x00,
        0xd2, 0x0f, 0x16, 0x00, 0x05, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x0a, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x0a, 0x00, 0x00, 0x00,
        0x53, 0x00, 0x45, 0x00, 0x52, 0x00, 0x56, 0x00,
        0x49, 0x00, 0x43, 0x00, 0x45, 0x00, 0x50, 0x00,
        0x43, 0x00, 0x00, 0x00, 0x0a, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x0a, 0x00, 0x00, 0x00,
        0x57, 0x00, 0x4f, 0x00, 0x52, 0x00, 0x4b, 0x00,
        0x47, 0x00, 0x52, 0x00, 0x4f, 0x00, 0x55, 0x00,
        0x50, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    };
    uint32_t response1_len = sizeof(response1);


    uint8_t bind2[] = {
        0x05, 0x00, 0x0b, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x48, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0xb8, 0x10, 0xb8, 0x10, 0x00, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00,
        0xc8, 0x4f, 0x32, 0x4b, 0x70, 0x16, 0xd3, 0x01,
        0x12, 0x78, 0x5a, 0x47, 0xbf, 0x6e, 0xe1, 0x88,
        0x03, 0x00, 0x00, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00
    };
    uint32_t bind2_len = sizeof(bind2);

    uint8_t bindack2[] = {
        0x05, 0x00, 0x0c, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x44, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0xb8, 0x10, 0xb8, 0x10, 0x57, 0x47, 0x00, 0x00,
        0x0d, 0x00, 0x5c, 0x50, 0x49, 0x50, 0x45, 0x5c,
        0x73, 0x72, 0x76, 0x73, 0x76, 0x63, 0x00, 0xff,
        0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00,
    };
    uint32_t bindack2_len = sizeof(bindack2);

    uint8_t request2[] = {
        0x05, 0x00, 0x00, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x4c, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x34, 0x00, 0x00, 0x00, 0x00, 0x00, 0x15, 0x00,
        0xb0, 0xe2, 0xe3, 0x00, 0x10, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00,
        0x5c, 0x00, 0x5c, 0x00, 0x36, 0x00, 0x34, 0x00,
        0x2e, 0x00, 0x31, 0x00, 0x30, 0x00, 0x31, 0x00,
        0x2e, 0x00, 0x31, 0x00, 0x38, 0x00, 0x32, 0x00,
        0x2e, 0x00, 0x39, 0x00, 0x30, 0x00, 0x00, 0x00,
        0x65, 0x00, 0x00, 0x00,
    };
    uint32_t request2_len = sizeof(request2);

    uint8_t response2[] = {
        0x05, 0x00, 0x02, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x74, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x5c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x65, 0x00, 0x00, 0x00, 0x68, 0x3d, 0x14, 0x00,
        0xf4, 0x01, 0x00, 0x00, 0x80, 0x3d, 0x14, 0x00,
        0x05, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x03, 0x10, 0x05, 0x00, 0x9c, 0x3d, 0x14, 0x00,
        0x0e, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x0e, 0x00, 0x00, 0x00, 0x31, 0x00, 0x39, 0x00,
        0x32, 0x00, 0x2e, 0x00, 0x31, 0x00, 0x36, 0x00,
        0x38, 0x00, 0x2e, 0x00, 0x32, 0x00, 0x2e, 0x00,
        0x31, 0x00, 0x30, 0x00, 0x33, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x55, 0x00,
        0x00, 0x00, 0x00, 0x00,
    };
    uint32_t response2_len = sizeof(response2);


    DCERPCState *state;
    Flow f;
    TcpSession ssn;
    int r;
    UUID *uuid = NULL;
    DCERPCTx *tx = NULL;

    memset(&f, 0, sizeof(f));
    memset(&ssn, 0, sizeof(ssn));
    FLOW_INITIALIZE(&f);
    f.protoctx = (void *)&ssn;

    StreamTcpInitConfig(TRUE);

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER | STREAM_START, bind1, bind1_len);
    if (r != 0) {
        printf("failure parsing bind1\n");
        goto end;
    }
    state = f.alstate;
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 11 ||
        state->connp[0].pfc_flags != 0x03 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 72 ||
        state->connp[0].call_id != 1 ||
        state->connp[0].assoc_group_id != 0 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[0].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 0) {
        printf("failure1\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x6bffd098 ||
         *((uint16_t *)uuid->uuid + 2) != 0xa112 ||
         *((uint16_t *)uuid->uuid + 3) != 0x3610 ||
         *((uint16_t *)uuid->uuid + 4) != 0x9833 ||
         uuid->uuid[10] != 0x46 || uuid->uuid[11] != 0xc3 ||
         uuid->uuid[12] != 0xf8 || uuid->uuid[13] != 0x7e ||
         uuid->uuid[14] != 0x34 || uuid->uuid[15] != 0x5a) ||
        uuid->accepted != 0 ||
        uuid->iv != 1 ||
        uuid->context_id != 0) {
        printf("failure 1_1\n");
        goto end;
    }

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, bindack1, bindack1_len);
    if (r != 0) {
        printf("failure parsing bindack1\n");
        goto end;
    }
    if (state->connp[1].rpc_vers_minor != 0 ||
        state->connp[1].ptype != 12 ||
        state->connp[1].pfc_flags != 0x03 ||
        state->connp[1].auth_length != 0 ||
        state->connp[1].frag_length != 68 ||
        state->connp[1].call_id != 1 ||
        state->connp[1].assoc_group_id != 0x00004756 ||
        state->connp[1].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 0) {
        printf("failure2\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x6bffd098 ||
         *((uint16_t *)uuid->uuid + 2) != 0xa112 ||
         *((uint16_t *)uuid->uuid + 3) != 0x3610 ||
         *((uint16_t *)uuid->uuid + 4) != 0x9833 ||
         uuid->uuid[10] != 0x46 || uuid->uuid[11] != 0xc3 ||
         uuid->uuid[12] != 0xf8 || uuid->uuid[13] != 0x7e ||
         uuid->uuid[14] != 0x34 || uuid->uuid[15] != 0x5a) ||
        uuid->accepted != 1 ||
        uuid->iv != 1 ||
        uuid->context_id != 0) {
        printf("failure 2_1\n");
        goto end;
    }

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER, request1, request1_len);
    if (r != 0) {
        printf("failure parsing request1\n");
        goto end;
    }
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 0 ||
        state->connp[0].pfc_flags != 0x03 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 76 ||
        state->connp[0].call_id != 1 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[0].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure3\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x6bffd098 ||
         *((uint16_t *)uuid->uuid + 2) != 0xa112 ||
         *((uint16_t *)uuid->uuid + 3) != 0x3610 ||
         *((uint16_t *)uuid->uuid + 4) != 0x9833 ||
         uuid->uuid[10] != 0x46 || uuid->uuid[11] != 0xc3 ||
         uuid->uuid[12] != 0xf8 || uuid->uuid[13] != 0x7e ||
         uuid->uuid[14] != 0x34 || uuid->uuid[15] != 0x5a) ||
        uuid->accepted != 1 ||
        uuid->iv != 1 ||
        uuid->context_id != 0) {
        printf("failure 3_1\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 1 ||
        tx->opnum != 0 ||
        tx->stub_len[0] != 52 ||
        tx->stub_len[1] != 0) {
        printf("failure 3_2\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x6bffd098 ||
         *((uint16_t *)tx->iface.uuid + 2) != 0xa112 ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x3610 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0x9833 ||
         tx->iface.uuid[10] != 0x46 || tx->iface.uuid[11] != 0xc3 ||
         tx->iface.uuid[12] != 0xf8 || tx->iface.uuid[13] != 0x7e ||
         tx->iface.uuid[14] != 0x34 || tx->iface.uuid[15] != 0x5a)) {
        printf("failure 3_3\n");
        goto end;
    }

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, response1, response1_len);
    if (r != 0) {
        printf("failure parsing response1\n");
        goto end;
    }
    if (state->connp[1].rpc_vers_minor != 0 ||
        state->connp[1].ptype != 2 ||
        state->connp[1].pfc_flags != 0x03 ||
        state->connp[1].auth_length != 0 ||
        state->connp[1].frag_length != 120 ||
        state->connp[1].call_id != 1 ||
        state->connp[1].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure4\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x6bffd098 ||
         *((uint16_t *)uuid->uuid + 2) != 0xa112 ||
         *((uint16_t *)uuid->uuid + 3) != 0x3610 ||
         *((uint16_t *)uuid->uuid + 4) != 0x9833 ||
         uuid->uuid[10] != 0x46 || uuid->uuid[11] != 0xc3 ||
         uuid->uuid[12] != 0xf8 || uuid->uuid[13] != 0x7e ||
         uuid->uuid[14] != 0x34 || uuid->uuid[15] != 0x5a) ||
        uuid->accepted != 1 ||
        uuid->iv != 1 ||
        uuid->context_id != 0) {
        printf("failure 4_1\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 1 ||
        tx->opnum != 0 ||
        tx->stub_len[0] != 52 ||
        tx->stub_len[1] != 96) {
        printf("failure 4_2\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x6bffd098 ||
         *((uint16_t *)tx->iface.uuid + 2) != 0xa112 ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x3610 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0x9833 ||
         tx->iface.uuid[10] != 0x46 || tx->iface.uuid[11] != 0xc3 ||
         tx->iface.uuid[12] != 0xf8 || tx->iface.uuid[13] != 0x7e ||
         tx->iface.uuid[14] != 0x34 || tx->iface.uuid[15] != 0x5a)) {
        printf("failure 4_3\n");
        goto end;
    }

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER | STREAM_START, bind2, bind2_len);
    if (r != 0) {
        printf("failure parsing bind2\n");
        goto end;
    }
    state = f.alstate;
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 11 ||
        state->connp[0].pfc_flags != 0x03 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 72 ||
        state->connp[0].call_id != 1 ||
        state->connp[0].assoc_group_id != 0 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[0].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure5\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x4b324fc8 ||
         *((uint16_t *)uuid->uuid + 2) != 0x1670 ||
         *((uint16_t *)uuid->uuid + 3) != 0x01d3 ||
         *((uint16_t *)uuid->uuid + 4) != 0x1278 ||
         uuid->uuid[10] != 0x5a || uuid->uuid[11] != 0x47 ||
         uuid->uuid[12] != 0xbf || uuid->uuid[13] != 0x6e ||
         uuid->uuid[14] != 0xe1 || uuid->uuid[15] != 0x88) ||
        uuid->accepted != 0 ||
        uuid->iv != 3 ||
        uuid->context_id != 0) {
        printf("failure 5_1\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 1 ||
        tx->opnum != 0 ||
        tx->stub_len[0] != 52 ||
        tx->stub_len[1] != 96) {
        printf("failure 5_2\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x6bffd098 ||
         *((uint16_t *)tx->iface.uuid + 2) != 0xa112 ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x3610 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0x9833 ||
         tx->iface.uuid[10] != 0x46 || tx->iface.uuid[11] != 0xc3 ||
         tx->iface.uuid[12] != 0xf8 || tx->iface.uuid[13] != 0x7e ||
         tx->iface.uuid[14] != 0x34 || tx->iface.uuid[15] != 0x5a)) {
        printf("failure 5_3\n");
        goto end;
    }

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, bindack2, bindack2_len);
    if (r != 0) {
        printf("failure parsing bindack2\n");
        goto end;
    }
    if (state->connp[1].rpc_vers_minor != 0 ||
        state->connp[1].ptype != 12 ||
        state->connp[1].pfc_flags != 0x03 ||
        state->connp[1].auth_length != 0 ||
        state->connp[1].frag_length != 68 ||
        state->connp[1].call_id != 1 ||
        state->connp[1].assoc_group_id != 0x00004757 ||
        state->connp[1].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure6\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x4b324fc8 ||
         *((uint16_t *)uuid->uuid + 2) != 0x1670 ||
         *((uint16_t *)uuid->uuid + 3) != 0x01d3 ||
         *((uint16_t *)uuid->uuid + 4) != 0x1278 ||
         uuid->uuid[10] != 0x5a || uuid->uuid[11] != 0x47 ||
         uuid->uuid[12] != 0xbf || uuid->uuid[13] != 0x6e ||
         uuid->uuid[14] != 0xe1 || uuid->uuid[15] != 0x88) ||
        uuid->accepted != 1 ||
        uuid->iv != 3 ||
        uuid->context_id != 0) {
        printf("failure 6_1\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 1 ||
        tx->opnum != 0 ||
        tx->stub_len[0] != 52 ||
        tx->stub_len[1] != 96) {
        printf("failure 6_2\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x6bffd098 ||
         *((uint16_t *)tx->iface.uuid + 2) != 0xa112 ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x3610 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0x9833 ||
         tx->iface.uuid[10] != 0x46 || tx->iface.uuid[11] != 0xc3 ||
         tx->iface.uuid[12] != 0xf8 || tx->iface.uuid[13] != 0x7e ||
         tx->iface.uuid[14] != 0x34 || tx->iface.uuid[15] != 0x5a)) {
        printf("failure 6_3\n");
        goto end;
    }

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER, request2, request2_len);
    if (r != 0) {
        printf("failure parsing request2\n");
        goto end;
    }
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 0 ||
        state->connp[0].pfc_flags != 0x03 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 76 ||
        state->connp[0].call_id != 1 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[0].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 2) {
        printf("failure7\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x4b324fc8 ||
         *((uint16_t *)uuid->uuid + 2) != 0x1670 ||
         *((uint16_t *)uuid->uuid + 3) != 0x01d3 ||
         *((uint16_t *)uuid->uuid + 4) != 0x1278 ||
         uuid->uuid[10] != 0x5a || uuid->uuid[11] != 0x47 ||
         uuid->uuid[12] != 0xbf || uuid->uuid[13] != 0x6e ||
         uuid->uuid[14] != 0xe1 || uuid->uuid[15] != 0x88) ||
        uuid->accepted != 1 ||
        uuid->iv != 3 ||
        uuid->context_id != 0) {
        printf("failure 7_1\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 1 ||
        tx->opnum != 0 ||
        tx->stub_len[0] != 52 ||
        tx->stub_len[1] != 96) {
        printf("failure 7_2\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x6bffd098 ||
         *((uint16_t *)tx->iface.uuid + 2) != 0xa112 ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x3610 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0x9833 ||
         tx->iface.uuid[10] != 0x46 || tx->iface.uuid[11] != 0xc3 ||
         tx->iface.uuid[12] != 0xf8 || tx->iface.uuid[13] != 0x7e ||
         tx->iface.uuid[14] != 0x34 || tx->iface.uuid[15] != 0x5a)) {
        printf("failure 7_3\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(1, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 1 ||
        tx->opnum != 21 ||
        tx->stub_len[0] != 52 ||
        tx->stub_len[1] != 0) {
        printf("failure 7_2\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x4b324fc8 ||
         *((uint16_t *)tx->iface.uuid + 2) != 0x1670 ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x01d3 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0x1278 ||
         tx->iface.uuid[10] != 0x5a || tx->iface.uuid[11] != 0x47 ||
         tx->iface.uuid[12] != 0xbf || tx->iface.uuid[13] != 0x6e ||
         tx->iface.uuid[14] != 0xe1 || tx->iface.uuid[15] != 0x88)) {
        printf("failure 7_3\n");
        goto end;
    }

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, response2, response2_len);
    if (r != 0) {
        printf("failure parsing response2\n");
        goto end;
    }
    if (state->connp[1].rpc_vers_minor != 0 ||
        state->connp[1].ptype != 2 ||
        state->connp[1].pfc_flags != 0x03 ||
        state->connp[1].auth_length != 0 ||
        state->connp[1].frag_length != 116 ||
        state->connp[1].call_id != 1 ||
        state->connp[1].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 2) {
        printf("failure8\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x4b324fc8 ||
         *((uint16_t *)uuid->uuid + 2) != 0x1670 ||
         *((uint16_t *)uuid->uuid + 3) != 0x01d3 ||
         *((uint16_t *)uuid->uuid + 4) != 0x1278 ||
         uuid->uuid[10] != 0x5a || uuid->uuid[11] != 0x47 ||
         uuid->uuid[12] != 0xbf || uuid->uuid[13] != 0x6e ||
         uuid->uuid[14] != 0xe1 || uuid->uuid[15] != 0x88) ||
        uuid->accepted != 1 ||
        uuid->iv != 3 ||
        uuid->context_id != 0) {
        printf("failure 8_1\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 1 ||
        tx->opnum != 0 ||
        tx->stub_len[0] != 52 ||
        tx->stub_len[1] != 96) {
        printf("failure 8_2\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x6bffd098 ||
         *((uint16_t *)tx->iface.uuid + 2) != 0xa112 ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x3610 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0x9833 ||
         tx->iface.uuid[10] != 0x46 || tx->iface.uuid[11] != 0xc3 ||
         tx->iface.uuid[12] != 0xf8 || tx->iface.uuid[13] != 0x7e ||
         tx->iface.uuid[14] != 0x34 || tx->iface.uuid[15] != 0x5a)) {
        printf("failure 8_3\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(1, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 1 ||
        tx->opnum != 21 ||
        tx->stub_len[0] != 52 ||
        tx->stub_len[1] != 92) {
        printf("failure 8_2\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x4b324fc8 ||
         *((uint16_t *)tx->iface.uuid + 2) != 0x1670 ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x01d3 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0x1278 ||
         tx->iface.uuid[10] != 0x5a || tx->iface.uuid[11] != 0x47 ||
         tx->iface.uuid[12] != 0xbf || tx->iface.uuid[13] != 0x6e ||
         tx->iface.uuid[14] != 0xe1 || tx->iface.uuid[15] != 0x88)) {
        printf("failure 8_3\n");
        goto end;
    }

    result = 1;

end:
    StreamTcpFreeConfig(TRUE);
    FLOW_DESTROY(&f);
    return result;
}

/*
 * \test private_5565-0-0.pcap.  Pdus 20, 23, 27.
 *       bind, bind, ack, request with object uuid set.
 */
int DCERPCParserTest06(void)
{
    int result = 0;

    uint8_t bind[] = {
        0x05, 0x00, 0x0b, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x48, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0xb8, 0x10, 0xb8, 0x10, 0x00, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00,
        0x78, 0x56, 0x34, 0x12, 0x34, 0x12, 0xcd, 0xab,
        0xef, 0x00, 0x01, 0x23, 0x45, 0x67, 0x89, 0xab,
        0x01, 0x00, 0x00, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
    };
    uint32_t bind_len = sizeof(bind);

    uint8_t bindack[] = {
        0x05, 0x00, 0x0c, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x44, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0xb8, 0x10, 0xb8, 0x10, 0xf3, 0x43, 0x00, 0x00,
        0x0e, 0x00, 0x5c, 0x70, 0x69, 0x70, 0x65, 0x5c,
        0x73, 0x70, 0x6f, 0x6f, 0x6c, 0x73, 0x73, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00,
    };
    uint32_t bindack_len = sizeof(bindack);

    uint8_t request[] = {
        0x05, 0x00, 0x00, 0x81, 0x10, 0x00, 0x00, 0x00,
        0xb8, 0x10, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x20, 0x17, 0x00, 0x00, 0x00, 0x00, 0x05, 0x00,
        0x78, 0x56, 0x34, 0x12, 0x34, 0x12, 0xcd, 0xab,
        0xef, 0x00, 0x01, 0x23, 0x45, 0x67, 0x89, 0xab,
        0xc0, 0xf4, 0x19, 0x00, 0xf8, 0x0a, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0xf8, 0x0a, 0x00, 0x00,
        0x5c, 0x00, 0x5c, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
    };
    uint32_t request_len = sizeof(request);

    DCERPCState *state;
    Flow f;
    TcpSession ssn;
    int r;
    UUID *uuid = NULL;
    DCERPCTx *tx = NULL;

    memset(&f, 0, sizeof(f));
    memset(&ssn, 0, sizeof(ssn));
    FLOW_INITIALIZE(&f);
    f.protoctx = (void *)&ssn;

    StreamTcpInitConfig(TRUE);

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER | STREAM_START, bind, bind_len);
    if (r != 0) {
        printf("failure parsing bind\n");
        goto end;
    }
    state = f.alstate;
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 11 ||
        state->connp[0].pfc_flags != 0x03 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 72 ||
        state->connp[0].call_id != 1 ||
        state->connp[0].assoc_group_id != 0 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[0].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 0) {
        printf("failure1\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x12345678 ||
         *((uint16_t *)uuid->uuid + 2) != 0x1234 ||
         *((uint16_t *)uuid->uuid + 3) != 0xabcd ||
         *((uint16_t *)uuid->uuid + 4) != 0xef00 ||
         uuid->uuid[10] != 0x01 || uuid->uuid[11] != 0x23 ||
         uuid->uuid[12] != 0x45 || uuid->uuid[13] != 0x67 ||
         uuid->uuid[14] != 0x89 || uuid->uuid[15] != 0xab) ||
        uuid->accepted != 0 ||
        uuid->iv != 1 ||
        uuid->context_id != 0) {
        printf("failure 1_1\n");
        goto end;
    }

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, bindack, bindack_len);
    if (r != 0) {
        printf("failure parsing bindack\n");
        goto end;
    }
    if (state->connp[1].rpc_vers_minor != 0 ||
        state->connp[1].ptype != 12 ||
        state->connp[1].pfc_flags != 0x03 ||
        state->connp[1].auth_length != 0 ||
        state->connp[1].frag_length != 68 ||
        state->connp[1].call_id != 1 ||
        state->connp[1].assoc_group_id != 0x000043f3 ||
        state->connp[1].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 0) {
        printf("failure2\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x12345678 ||
         *((uint16_t *)uuid->uuid + 2) != 0x1234 ||
         *((uint16_t *)uuid->uuid + 3) != 0xabcd ||
         *((uint16_t *)uuid->uuid + 4) != 0xef00 ||
         uuid->uuid[10] != 0x01 || uuid->uuid[11] != 0x23 ||
         uuid->uuid[12] != 0x45 || uuid->uuid[13] != 0x67 ||
         uuid->uuid[14] != 0x89 || uuid->uuid[15] != 0xab) ||
        uuid->accepted != 1 ||
        uuid->iv != 1 ||
        uuid->context_id != 0) {
        printf("failure 2_1\n");
        goto end;
    }

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER, request, request_len);
    if (r != 0) {
        printf("failure parsing request\n");
        goto end;
    }
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 0 ||
        state->connp[0].pfc_flags != 0x81 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 4280 ||
        state->connp[0].call_id != 1 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[0].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure3\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x12345678 ||
         *((uint16_t *)uuid->uuid + 2) != 0x1234 ||
         *((uint16_t *)uuid->uuid + 3) != 0xabcd ||
         *((uint16_t *)uuid->uuid + 4) != 0xef00 ||
         uuid->uuid[10] != 0x01 || uuid->uuid[11] != 0x23 ||
         uuid->uuid[12] != 0x45 || uuid->uuid[13] != 0x67 ||
         uuid->uuid[14] != 0x89 || uuid->uuid[15] != 0xab) ||
        uuid->accepted != 1 ||
        uuid->iv != 1 ||
        uuid->context_id != 0) {
        printf("failure 3_1\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 1 ||
        tx->opnum != 5 ||
        tx->stub_len[0] != 4240 ||
        tx->stub_len[1] != 0) {
        printf("failure 3_2\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x12345678 ||
         *((uint16_t *)tx->iface.uuid + 2) != 0x1234 ||
         *((uint16_t *)tx->iface.uuid + 3) != 0xabcd ||
         *((uint16_t *)tx->iface.uuid + 4) != 0xef00 ||
         tx->iface.uuid[10] != 0x01 || tx->iface.uuid[11] != 0x23 ||
         tx->iface.uuid[12] != 0x45 || tx->iface.uuid[13] != 0x67 ||
         tx->iface.uuid[14] != 0x89 || tx->iface.uuid[15] != 0xab)) {
        printf("failure 3_3\n");
        goto end;
    }

    result = 1;

end:
    StreamTcpFreeConfig(TRUE);
    FLOW_DESTROY(&f);
    return result;
}

/**
 * \test Incremental call ids.
 *       bind, bind_ack, request, response, request, response, request.
 *       private_5581-0.pcap.  Pdus 24, 27, 28, 29, 30, 31, 32
 */
int DCERPCParserTest07(void)
{
    int result = 0;

    uint8_t bind[] = {
        0x05, 0x00, 0x0b, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x48, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0xb8, 0x10, 0xb8, 0x10, 0x00, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00,
        0x81, 0xbb, 0x7a, 0x36, 0x44, 0x98, 0xf1, 0x35,
        0xad, 0x32, 0x98, 0xf0, 0x38, 0x00, 0x10, 0x03,
        0x02, 0x00, 0x00, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
    };
    uint32_t bind_len = sizeof(bind);

    uint8_t bindack[] = {
        0x05, 0x00, 0x0c, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x44, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0xb8, 0x10, 0xb8, 0x10, 0x74, 0x73, 0x00, 0x00,
        0x0d, 0x00, 0x5c, 0x50, 0x49, 0x50, 0x45, 0x5c,
        0x6e, 0x74, 0x73, 0x76, 0x63, 0x73, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00,
    };
    uint32_t bindack_len = sizeof(bindack);

    uint8_t request1[] = {
        0x05, 0x00, 0x00, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x40, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x28, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1b, 0x00,
        0x64, 0x7e, 0x32, 0x00, 0x0f, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x0f, 0x00, 0x00, 0x00,
        0x5c, 0x5c, 0x31, 0x37, 0x31, 0x2e, 0x37, 0x31,
        0x2e, 0x38, 0x34, 0x2e, 0x36, 0x37, 0x00, 0x8a,
        0x00, 0x00, 0x00, 0x00, 0x3f, 0x00, 0x0f, 0x00,
    };
    uint32_t request1_len = sizeof(request1);

    uint8_t response1[] = {
        0x05, 0x00, 0x02, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x30, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x18, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0xd2, 0xc4, 0x88, 0x14,
        0xef, 0x31, 0xbb, 0x4d, 0xa8, 0x13, 0xb7, 0x1b,
        0x47, 0x49, 0xb5, 0xd7, 0x00, 0x00, 0x00, 0x00,
    };
    uint32_t response1_len = sizeof(response1);

    uint8_t request2[] = {
        0x05, 0x00, 0x00, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x40, 0x00, 0x00, 0x00, 0x02, 0x00, 0x00, 0x00,
        0x28, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1a, 0x00,
        0x00, 0x00, 0x00, 0x00, 0xd2, 0xc4, 0x88, 0x14,
        0xef, 0x31, 0xbb, 0x4d, 0xa8, 0x13, 0xb7, 0x1b,
        0x47, 0x49, 0xb5, 0xd7, 0x30, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x24, 0x00, 0x00, 0x00,
        0x04, 0xfa, 0x7f, 0x01, 0x00, 0x00, 0x00, 0x00,
    };
    uint32_t request2_len = sizeof(request2);

    uint8_t response2[] = {
        0x05, 0x00, 0x02, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x54, 0x00, 0x00, 0x00, 0x02, 0x00, 0x00, 0x00,
        0x3c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x24, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x7e, 0x17, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x8c, 0x9c, 0x0c, 0x00, 0x00, 0x00, 0x00, 0x00,
        0xea, 0x00, 0x00, 0x00,
    };
    uint32_t response2_len = sizeof(response2);

    uint8_t request3[] = {
        0x05, 0x00, 0x00, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x40, 0x00, 0x00, 0x00, 0x03, 0x00, 0x00, 0x00,
        0x28, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1a, 0x00,
        0x00, 0x00, 0x00, 0x00, 0xd2, 0xc4, 0x88, 0x14,
        0xef, 0x31, 0xbb, 0x4d, 0xa8, 0x13, 0xb7, 0x1b,
        0x47, 0x49, 0xb5, 0xd7, 0x30, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x7e, 0x17, 0x00, 0x00,
        0x04, 0xfa, 0x7f, 0x01, 0x00, 0x00, 0x00, 0x00,
    };
    uint32_t request3_len = sizeof(request3);

    DCERPCState *state;
    Flow f;
    TcpSession ssn;
    int r;
    UUID *uuid = NULL;
    DCERPCTx *tx = NULL;

    memset(&f, 0, sizeof(f));
    memset(&ssn, 0, sizeof(ssn));
    FLOW_INITIALIZE(&f);
    f.protoctx = (void *)&ssn;

    StreamTcpInitConfig(TRUE);

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER | STREAM_START, bind, bind_len);
    if (r != 0) {
        printf("failure parsing bind\n");
        goto end;
    }
    state = f.alstate;
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 11 ||
        state->connp[0].pfc_flags != 0x03 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 72 ||
        state->connp[0].call_id != 1 ||
        state->connp[0].assoc_group_id != 0 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[0].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 0) {
        printf("failure1\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x367abb81 ||
         *((uint16_t *)uuid->uuid + 2) != 0x9844 ||
         *((uint16_t *)uuid->uuid + 3) != 0x35f1 ||
         *((uint16_t *)uuid->uuid + 4) != 0xad32 ||
         uuid->uuid[10] != 0x98 || uuid->uuid[11] != 0xf0 ||
         uuid->uuid[12] != 0x38 || uuid->uuid[13] != 0x00 ||
         uuid->uuid[14] != 0x10 || uuid->uuid[15] != 0x03) ||
        uuid->accepted != 0 ||
        uuid->iv != 2 ||
        uuid->context_id != 0) {
        printf("failure 1_1\n");
        goto end;
    }

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, bindack, bindack_len);
    if (r != 0) {
        printf("failure parsing bindack\n");
        goto end;
    }
    if (state->connp[1].rpc_vers_minor != 0 ||
        state->connp[1].ptype != 12 ||
        state->connp[1].pfc_flags != 0x03 ||
        state->connp[1].auth_length != 0 ||
        state->connp[1].frag_length != 68 ||
        state->connp[1].call_id != 1 ||
        state->connp[1].assoc_group_id != 0x00007374 ||
        state->connp[1].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 0) {
        printf("failure2\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x367abb81 ||
         *((uint16_t *)uuid->uuid + 2) != 0x9844 ||
         *((uint16_t *)uuid->uuid + 3) != 0x35f1 ||
         *((uint16_t *)uuid->uuid + 4) != 0xad32 ||
         uuid->uuid[10] != 0x98 || uuid->uuid[11] != 0xf0 ||
         uuid->uuid[12] != 0x38 || uuid->uuid[13] != 0x00 ||
         uuid->uuid[14] != 0x10 || uuid->uuid[15] != 0x03) ||
        uuid->accepted != 1 ||
        uuid->iv != 2 ||
        uuid->context_id != 0) {
        printf("failure 2_1\n");
        goto end;
    }

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER, request1, request1_len);
    if (r != 0) {
        printf("failure parsing request1\n");
        goto end;
    }
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 0 ||
        state->connp[0].pfc_flags != 0x03 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 64 ||
        state->connp[0].call_id != 1 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[0].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure3\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x367abb81 ||
         *((uint16_t *)uuid->uuid + 2) != 0x9844 ||
         *((uint16_t *)uuid->uuid + 3) != 0x35f1 ||
         *((uint16_t *)uuid->uuid + 4) != 0xad32 ||
         uuid->uuid[10] != 0x98 || uuid->uuid[11] != 0xf0 ||
         uuid->uuid[12] != 0x38 || uuid->uuid[13] != 0x00 ||
         uuid->uuid[14] != 0x10 || uuid->uuid[15] != 0x03) ||
        uuid->accepted != 1 ||
        uuid->iv != 2 ||
        uuid->context_id != 0) {
        printf("failure 3_1\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 1 ||
        tx->opnum != 27 ||
        tx->stub_len[0] != 40 ||
        tx->stub_len[1] != 0) {
        printf("failure 3_2\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x367abb81 ||
         *((uint16_t *)tx->iface.uuid + 2) != 0x9844 ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x35f1 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0xad32 ||
         tx->iface.uuid[10] != 0x98 || tx->iface.uuid[11] != 0xf0 ||
         tx->iface.uuid[12] != 0x38 || tx->iface.uuid[13] != 0x00 ||
         tx->iface.uuid[14] != 0x10 || tx->iface.uuid[15] != 0x03)) {
        printf("failure 3_3\n");
        goto end;
    }

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, response1, response1_len);
    if (r != 0) {
        printf("failure parsing response1\n");
        goto end;
    }
    if (state->connp[1].rpc_vers_minor != 0 ||
        state->connp[1].ptype != 2 ||
        state->connp[1].pfc_flags != 0x03 ||
        state->connp[1].auth_length != 0 ||
        state->connp[1].frag_length != 48 ||
        state->connp[1].call_id != 1 ||
        state->connp[1].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure4\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x367abb81 ||
         *((uint16_t *)uuid->uuid + 2) != 0x9844 ||
         *((uint16_t *)uuid->uuid + 3) != 0x35f1 ||
         *((uint16_t *)uuid->uuid + 4) != 0xad32 ||
         uuid->uuid[10] != 0x98 || uuid->uuid[11] != 0xf0 ||
         uuid->uuid[12] != 0x38 || uuid->uuid[13] != 0x00 ||
         uuid->uuid[14] != 0x10 || uuid->uuid[15] != 0x03) ||
        uuid->accepted != 1 ||
        uuid->iv != 2 ||
        uuid->context_id != 0) {
        printf("failure 4_1\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 1 ||
        tx->opnum != 27 ||
        tx->stub_len[0] != 40 ||
        tx->stub_len[1] != 24) {
        printf("failure 4_2\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x367abb81 ||
         *((uint16_t *)tx->iface.uuid + 2) != 0x9844 ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x35f1 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0xad32 ||
         tx->iface.uuid[10] != 0x98 || tx->iface.uuid[11] != 0xf0 ||
         tx->iface.uuid[12] != 0x38 || tx->iface.uuid[13] != 0x00 ||
         tx->iface.uuid[14] != 0x10 || tx->iface.uuid[15] != 0x03)) {
        printf("failure 4_3\n");
        goto end;
    }

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER, request2, request2_len);
    if (r != 0) {
        printf("failure parsing request2\n");
        goto end;
    }
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 0 ||
        state->connp[0].pfc_flags != 0x03 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 64 ||
        state->connp[0].call_id != 2 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[0].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 2) {
        printf("failure5\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x367abb81 ||
         *((uint16_t *)uuid->uuid + 2) != 0x9844 ||
         *((uint16_t *)uuid->uuid + 3) != 0x35f1 ||
         *((uint16_t *)uuid->uuid + 4) != 0xad32 ||
         uuid->uuid[10] != 0x98 || uuid->uuid[11] != 0xf0 ||
         uuid->uuid[12] != 0x38 || uuid->uuid[13] != 0x00 ||
         uuid->uuid[14] != 0x10 || uuid->uuid[15] != 0x03) ||
        uuid->accepted != 1 ||
        uuid->iv != 2 ||
        uuid->context_id != 0) {
        printf("failure 5_1\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 1 ||
        tx->opnum != 27 ||
        tx->stub_len[0] != 40 ||
        tx->stub_len[1] != 24) {
        printf("failure 5_2\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x367abb81 ||
         *((uint16_t *)tx->iface.uuid + 2) != 0x9844 ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x35f1 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0xad32 ||
         tx->iface.uuid[10] != 0x98 || tx->iface.uuid[11] != 0xf0 ||
         tx->iface.uuid[12] != 0x38 || tx->iface.uuid[13] != 0x00 ||
         tx->iface.uuid[14] != 0x10 || tx->iface.uuid[15] != 0x03)) {
        printf("failure 5_3\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(1, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 2 ||
        tx->opnum != 26 ||
        tx->stub_len[0] != 40 ||
        tx->stub_len[1] != 0) {
        printf("failure 5_4\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x367abb81 ||
         *((uint16_t *)tx->iface.uuid + 2) != 0x9844 ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x35f1 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0xad32 ||
         tx->iface.uuid[10] != 0x98 || tx->iface.uuid[11] != 0xf0 ||
         tx->iface.uuid[12] != 0x38 || tx->iface.uuid[13] != 0x00 ||
         tx->iface.uuid[14] != 0x10 || tx->iface.uuid[15] != 0x03)) {
        printf("failure 5_5\n");
        goto end;
    }

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, response2, response2_len);
    if (r != 0) {
        printf("failure parsing response2\n");
        goto end;
    }
    if (state->connp[1].rpc_vers_minor != 0 ||
        state->connp[1].ptype != 2 ||
        state->connp[1].pfc_flags != 0x03 ||
        state->connp[1].auth_length != 0 ||
        state->connp[1].frag_length != 84 ||
        state->connp[1].call_id != 2 ||
        state->connp[1].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 2) {
        printf("failure6\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x367abb81 ||
         *((uint16_t *)uuid->uuid + 2) != 0x9844 ||
         *((uint16_t *)uuid->uuid + 3) != 0x35f1 ||
         *((uint16_t *)uuid->uuid + 4) != 0xad32 ||
         uuid->uuid[10] != 0x98 || uuid->uuid[11] != 0xf0 ||
         uuid->uuid[12] != 0x38 || uuid->uuid[13] != 0x00 ||
         uuid->uuid[14] != 0x10 || uuid->uuid[15] != 0x03) ||
        uuid->accepted != 1 ||
        uuid->iv != 2 ||
        uuid->context_id != 0) {
        printf("failure 6_1\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 1 ||
        tx->opnum != 27 ||
        tx->stub_len[0] != 40 ||
        tx->stub_len[1] != 24) {
        printf("failure 6_2\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x367abb81 ||
         *((uint16_t *)tx->iface.uuid + 2) != 0x9844 ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x35f1 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0xad32 ||
         tx->iface.uuid[10] != 0x98 || tx->iface.uuid[11] != 0xf0 ||
         tx->iface.uuid[12] != 0x38 || tx->iface.uuid[13] != 0x00 ||
         tx->iface.uuid[14] != 0x10 || tx->iface.uuid[15] != 0x03)) {
        printf("failure 6_3\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(1, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 2 ||
        tx->opnum != 26 ||
        tx->stub_len[0] != 40 ||
        tx->stub_len[1] != 60) {
        printf("failure 6_4\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x367abb81 ||
         *((uint16_t *)tx->iface.uuid + 2) != 0x9844 ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x35f1 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0xad32 ||
         tx->iface.uuid[10] != 0x98 || tx->iface.uuid[11] != 0xf0 ||
         tx->iface.uuid[12] != 0x38 || tx->iface.uuid[13] != 0x00 ||
         tx->iface.uuid[14] != 0x10 || tx->iface.uuid[15] != 0x03)) {
        printf("failure 6_5\n");
        goto end;
    }

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER, request3, request3_len);
    if (r != 0) {
        printf("failure parsing request2\n");
        goto end;
    }
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 0 ||
        state->connp[0].pfc_flags != 0x03 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 64 ||
        state->connp[0].call_id != 3 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[0].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 3) {
        printf("failure7\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x367abb81 ||
         *((uint16_t *)uuid->uuid + 2) != 0x9844 ||
         *((uint16_t *)uuid->uuid + 3) != 0x35f1 ||
         *((uint16_t *)uuid->uuid + 4) != 0xad32 ||
         uuid->uuid[10] != 0x98 || uuid->uuid[11] != 0xf0 ||
         uuid->uuid[12] != 0x38 || uuid->uuid[13] != 0x00 ||
         uuid->uuid[14] != 0x10 || uuid->uuid[15] != 0x03) ||
        uuid->accepted != 1 ||
        uuid->iv != 2 ||
        uuid->context_id != 0) {
        printf("failure 7_1\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 1 ||
        tx->opnum != 27 ||
        tx->stub_len[0] != 40 ||
        tx->stub_len[1] != 24) {
        printf("failure 7_2\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x367abb81 ||
         *((uint16_t *)tx->iface.uuid + 2) != 0x9844 ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x35f1 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0xad32 ||
         tx->iface.uuid[10] != 0x98 || tx->iface.uuid[11] != 0xf0 ||
         tx->iface.uuid[12] != 0x38 || tx->iface.uuid[13] != 0x00 ||
         tx->iface.uuid[14] != 0x10 || tx->iface.uuid[15] != 0x03)) {
        printf("failure 7_3\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(1, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 2 ||
        tx->opnum != 26 ||
        tx->stub_len[0] != 40 ||
        tx->stub_len[1] != 60) {
        printf("failure 7_4\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x367abb81 ||
         *((uint16_t *)tx->iface.uuid + 2) != 0x9844 ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x35f1 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0xad32 ||
         tx->iface.uuid[10] != 0x98 || tx->iface.uuid[11] != 0xf0 ||
         tx->iface.uuid[12] != 0x38 || tx->iface.uuid[13] != 0x00 ||
         tx->iface.uuid[14] != 0x10 || tx->iface.uuid[15] != 0x03)) {
        printf("failure 7_5\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(2, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 3 ||
        tx->opnum != 26 ||
        tx->stub_len[0] != 40 ||
        tx->stub_len[1] != 0) {
        printf("failure 7_6\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x367abb81 ||
         *((uint16_t *)tx->iface.uuid + 2) != 0x9844 ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x35f1 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0xad32 ||
         tx->iface.uuid[10] != 0x98 || tx->iface.uuid[11] != 0xf0 ||
         tx->iface.uuid[12] != 0x38 || tx->iface.uuid[13] != 0x00 ||
         tx->iface.uuid[14] != 0x10 || tx->iface.uuid[15] != 0x03)) {
        printf("failure 7_7\n");
        goto end;
    }

    result = 1;

end:
    StreamTcpFreeConfig(TRUE);
    FLOW_DESTROY(&f);
    return result;
}

/**
 * \test Multiple uuids in bind.
 *       private_metasploit3_0_lsass_v1_2_bind_tcp.pcap.
 *       Pdus 19, 23, 25, 28.
 */
int DCERPCParserTest08(void)
{
    int result = 0;

    uint8_t bind[] = {
        0x05, 0x00, 0x0b, 0x03, 0x10, 0x00, 0x00, 0x00,
        0xdc, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0xd0, 0x16, 0xd0, 0x16, 0x00, 0x00, 0x00, 0x00,
        0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00,
        0x7e, 0x6f, 0x8e, 0xd6, 0xb0, 0x97, 0xde, 0x71,
        0x8c, 0x44, 0x78, 0x3c, 0x54, 0x60, 0x97, 0xf1,
        0x05, 0x00, 0x02, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x01, 0x00, 0x18, 0xc4, 0x7e, 0xf1,
        0xd2, 0x10, 0x02, 0x6b, 0x0e, 0x0c, 0xf6, 0x0b,
        0x02, 0x95, 0xae, 0xa1, 0x03, 0x00, 0x02, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x70, 0xe4, 0x3d, 0x31, 0x26, 0xf9, 0x94, 0xfe,
        0x3c, 0x90, 0x8b, 0x6a, 0x51, 0xa9, 0xbb, 0x95,
        0x01, 0x00, 0x02, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
        0x03, 0x00, 0x01, 0x00, 0xe8, 0xed, 0xf1, 0xd5,
        0xa6, 0x82, 0xc5, 0x76, 0xce, 0x2d, 0xd8, 0x7c,
        0x6c, 0x11, 0x6f, 0xa0, 0x01, 0x00, 0x01, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00, 0x04, 0x00, 0x01, 0x00,
        0x09, 0x61, 0x07, 0x86, 0xef, 0xb1, 0x05, 0xb8,
        0xd3, 0xd5, 0xfa, 0x2d, 0x04, 0x6c, 0x90, 0x5e,
        0x00, 0x00, 0x00, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
        0x05, 0x00, 0x01, 0x00, 0x8f, 0xed, 0x01, 0xb4,
        0xdc, 0x4b, 0x55, 0x86, 0x99, 0xa7, 0x6a, 0x64,
        0x7f, 0x32, 0xe9, 0x2f, 0x03, 0x00, 0x00, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00, 0x06, 0x00, 0x01, 0x00,
        0xec, 0xc5, 0xe7, 0x53, 0xae, 0x20, 0xc3, 0x34,
        0x97, 0x14, 0x77, 0xf0, 0xfe, 0x68, 0x05, 0xa8,
        0x03, 0x00, 0x00, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
        0x07, 0x00, 0x01, 0x00, 0xd7, 0x92, 0x02, 0xb5,
        0xcd, 0xbd, 0x35, 0x35, 0x1e, 0x94, 0x88, 0x3d,
        0x79, 0x63, 0x2c, 0x10, 0x00, 0x00, 0x03, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00, 0x08, 0x00, 0x01, 0x00,
        0xb9, 0x33, 0x65, 0x7e, 0xd9, 0xcd, 0x03, 0x1a,
        0xa9, 0xb8, 0xfc, 0x12, 0x9b, 0x0d, 0xb9, 0x8b,
        0x02, 0x00, 0x01, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
        0x09, 0x00, 0x01, 0x00, 0xe7, 0xf1, 0x0e, 0x3d,
        0x1a, 0xb1, 0x4d, 0xb0, 0xaa, 0x43, 0x65, 0x58,
        0x48, 0xad, 0xf2, 0xf4, 0x01, 0x00, 0x02, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00, 0x0a, 0x00, 0x01, 0x00,
        0x09, 0x29, 0x3e, 0xf7, 0x45, 0x32, 0xf5, 0x10,
        0x28, 0x68, 0xc7, 0x39, 0xef, 0x17, 0x8a, 0xfc,
        0x03, 0x00, 0x00, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
        0x0b, 0x00, 0x01, 0x00, 0x46, 0xea, 0xcc, 0x19,
        0x76, 0x04, 0xf4, 0x0c, 0x9c, 0x2f, 0x17, 0xb2,
        0x72, 0xf4, 0x84, 0x4f, 0x02, 0x00, 0x00, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00, 0x0c, 0x00, 0x01, 0x00,
        0x6a, 0x28, 0x19, 0x39, 0x0c, 0xb1, 0xd0, 0x11,
        0x9b, 0xa8, 0x00, 0xc0, 0x4f, 0xd9, 0x2e, 0xf5,
        0x00, 0x00, 0x00, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
        0x0d, 0x00, 0x01, 0x00, 0x8d, 0x42, 0x65, 0xbd,
        0x57, 0x32, 0x4d, 0x06, 0x10, 0x1c, 0x01, 0x75,
        0x78, 0x9c, 0x8d, 0xf5, 0x01, 0x00, 0x01, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00, 0x0e, 0x00, 0x01, 0x00,
        0x72, 0xd8, 0xa0, 0x14, 0xa6, 0xb2, 0xf7, 0xaf,
        0x59, 0x09, 0x3b, 0x93, 0xcd, 0x86, 0xa5, 0xf4,
        0x00, 0x00, 0x01, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
        0x0f, 0x00, 0x01, 0x00, 0x65, 0x51, 0xbd, 0x9d,
        0x21, 0x1e, 0x2e, 0x7d, 0x5e, 0x2a, 0x71, 0x4b,
        0x66, 0xe9, 0xf0, 0xde, 0x03, 0x00, 0x03, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00,
    };
    uint32_t bind_len = sizeof(bind);

    uint8_t bindack[] = {
        0x05, 0x00, 0x0c, 0x03, 0x10, 0x00, 0x00, 0x00,
        0xac, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0xb8, 0x10, 0xb8, 0x10, 0xe3, 0x43, 0x00, 0x00,
        0x0c, 0x00, 0x5c, 0x50, 0x49, 0x50, 0x45, 0x5c,
        0x6c, 0x73, 0x61, 0x73, 0x73, 0x00, 0x00, 0x0c,
        0x10, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00,
    };
    uint32_t bindack_len = sizeof(bindack);

    uint8_t request1[] = {
        0x05, 0x00, 0x00, 0x01, 0x10, 0x00, 0x00, 0x00,
        0x97, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x7f, 0x00, 0x00, 0x00, 0x0c, 0x00, 0x09, 0x00,
        0xad, 0x0d, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0xad, 0x0d, 0x00, 0x00, 0x4c, 0x00, 0x66, 0x00,
        0x31, 0x00, 0x78, 0x00, 0x58, 0x00, 0x63, 0x00,
        0x4b, 0x00, 0x48, 0x00, 0x6d, 0x00, 0x70, 0x00,
        0x73, 0x00, 0x58, 0x00, 0x59, 0x00, 0x5a, 0x00,
        0x48, 0x00, 0x70, 0x00, 0x7a, 0x00, 0x62, 0x00,
        0x34, 0x00, 0x53, 0x00, 0x7a, 0x00, 0x4e, 0x00,
        0x61, 0x00, 0x78, 0x00, 0x30, 0x00, 0x75, 0x00,
        0x71, 0x00, 0x69, 0x00, 0x42, 0x00, 0x45, 0x00,
        0x4e, 0x00, 0x44, 0x00, 0x74, 0x00, 0x47, 0x00,
        0x4b, 0x00, 0x49, 0x00, 0x36, 0x00, 0x75, 0x00,
        0x36, 0x00, 0x4c, 0x00, 0x5a, 0x00, 0x74, 0x00,
        0x54, 0x00, 0x49, 0x00, 0x45, 0x00, 0x4f, 0x00,
        0x30, 0x00, 0x4e, 0x00, 0x6c, 0x00, 0x4a, 0x00,
        0x6d, 0x00, 0x6f, 0x00, 0x33, 0x00, 0x73, 0x00,
        0x68, 0x00, 0x6f, 0x00, 0x4b, 0x00, 0x6a,
    };

    uint32_t request1_len = sizeof(request1);

    uint8_t request2[] = {
        0x05, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00,
        0x97, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x7f, 0x00, 0x00, 0x00, 0x0c, 0x00, 0x09, 0x00,
        0x00, 0x39, 0x00, 0x6e, 0x00, 0x65, 0x00, 0x71,
        0x00, 0x38, 0x00, 0x69, 0x00, 0x4d, 0x00, 0x71,
        0x00, 0x5a, 0x00, 0x4d, 0x00, 0x33, 0x00, 0x36,
        0x00, 0x77, 0x00, 0x72, 0x00, 0x47, 0x00, 0x38,
        0x00, 0x71, 0x00, 0x43, 0x00, 0x44, 0x00, 0x52,
        0x00, 0x39, 0x00, 0x33, 0x00, 0x54, 0x00, 0x45,
        0x00, 0x63, 0x00, 0x4c, 0x00, 0x79, 0x00, 0x74,
        0x00, 0x62, 0x00, 0x52, 0x00, 0x32, 0x00, 0x4f,
        0x00, 0x4e, 0x00, 0x65, 0x00, 0x7a, 0x00, 0x37,
        0x00, 0x57, 0x00, 0x39, 0x00, 0x4b, 0x00, 0x71,
        0x00, 0x4c, 0x00, 0x35, 0x00, 0x67, 0x00, 0x41,
        0x00, 0x68, 0x00, 0x67, 0x00, 0x6c, 0x00, 0x38,
        0x00, 0x42, 0x00, 0x30, 0x00, 0x53, 0x00, 0x38,
        0x00, 0x53, 0x00, 0x7a, 0x00, 0x42, 0x00, 0x66,
        0x00, 0x63, 0x00, 0x4a, 0x00, 0x77, 0x00, 0x75,
        0x00, 0x52, 0x00, 0x48, 0x00, 0x35, 0x00,
    };

    uint32_t request2_len = sizeof(request2);

    DCERPCState *state;
    Flow f;
    TcpSession ssn;
    int r;
    UUID *uuid = NULL;
    DCERPCTx *tx = NULL;

    memset(&f, 0, sizeof(f));
    memset(&ssn, 0, sizeof(ssn));
    FLOW_INITIALIZE(&f);
    f.protoctx = (void *)&ssn;

    StreamTcpInitConfig(TRUE);

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER | STREAM_START, bind, bind_len);
    if (r != 0) {
        printf("failure parsing bind\n");
        goto end;
    }
    state = f.alstate;
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 11 ||
        state->connp[0].pfc_flags != 0x03 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 732 ||
        state->connp[0].call_id != 0 ||
        state->connp[0].assoc_group_id != 0 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[0].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 16 ||
        DCERPCListSize(&state->transactions) != 0) {
        printf("failure1\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xd68e6f7e ||
         *((uint16_t *)uuid->uuid + 2) != 0x97b0 ||
         *((uint16_t *)uuid->uuid + 3) != 0x71de ||
         *((uint16_t *)uuid->uuid + 4) != 0x8c44 ||
         uuid->uuid[10] != 0x78 || uuid->uuid[11] != 0x3c ||
         uuid->uuid[12] != 0x54 || uuid->uuid[13] != 0x60 ||
         uuid->uuid[14] != 0x97 || uuid->uuid[15] != 0xf1) ||
        uuid->accepted != 0 ||
        uuid->iv != 5 ||
        uuid->context_id != 0) {
        printf("failure 1_0\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(1, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xf17ec418 ||
         *((uint16_t *)uuid->uuid + 2) != 0x10d2 ||
         *((uint16_t *)uuid->uuid + 3) != 0x6b02 ||
         *((uint16_t *)uuid->uuid + 4) != 0x0e0c ||
         uuid->uuid[10] != 0xf6 || uuid->uuid[11] != 0x0b ||
         uuid->uuid[12] != 0x02 || uuid->uuid[13] != 0x95 ||
         uuid->uuid[14] != 0xae || uuid->uuid[15] != 0xa1) ||
        uuid->accepted != 0 ||
        uuid->iv != 3 ||
        uuid->context_id != 1) {
        printf("failure 1_1\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(2, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x313de470 ||
         *((uint16_t *)uuid->uuid + 2) != 0xf926 ||
         *((uint16_t *)uuid->uuid + 3) != 0xfe94 ||
         *((uint16_t *)uuid->uuid + 4) != 0x3c90 ||
         uuid->uuid[10] != 0x8b || uuid->uuid[11] != 0x6a ||
         uuid->uuid[12] != 0x51 || uuid->uuid[13] != 0xa9 ||
         uuid->uuid[14] != 0xbb || uuid->uuid[15] != 0x95) ||
        uuid->accepted != 0 ||
        uuid->iv != 1 ||
        uuid->context_id != 2) {
        printf("failure 1_2\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(3, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xd5f1ede8 ||
         *((uint16_t *)uuid->uuid + 2) != 0x82a6 ||
         *((uint16_t *)uuid->uuid + 3) != 0x76c5 ||
         *((uint16_t *)uuid->uuid + 4) != 0xce2d ||
         uuid->uuid[10] != 0xd8 || uuid->uuid[11] != 0x7c ||
         uuid->uuid[12] != 0x6c || uuid->uuid[13] != 0x11 ||
         uuid->uuid[14] != 0x6f || uuid->uuid[15] != 0xa0) ||
        uuid->accepted != 0 ||
        uuid->iv != 1 ||
        uuid->context_id != 3) {
        printf("failure 1_3\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(4, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x86076109 ||
         *((uint16_t *)uuid->uuid + 2) != 0xb1ef ||
         *((uint16_t *)uuid->uuid + 3) != 0xb805 ||
         *((uint16_t *)uuid->uuid + 4) != 0xd3d5 ||
         uuid->uuid[10] != 0xfa || uuid->uuid[11] != 0x2d ||
         uuid->uuid[12] != 0x04 || uuid->uuid[13] != 0x6c ||
         uuid->uuid[14] != 0x90 || uuid->uuid[15] != 0x5e) ||
        uuid->accepted != 0 ||
        uuid->iv != 0 ||
        uuid->context_id != 4) {
        printf("failure 1_4\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(5, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xb401ed8f ||
         *((uint16_t *)uuid->uuid + 2) != 0x4bdc ||
         *((uint16_t *)uuid->uuid + 3) != 0x8655 ||
         *((uint16_t *)uuid->uuid + 4) != 0x99a7 ||
         uuid->uuid[10] != 0x6a || uuid->uuid[11] != 0x64 ||
         uuid->uuid[12] != 0x7f || uuid->uuid[13] != 0x32 ||
         uuid->uuid[14] != 0xe9 || uuid->uuid[15] != 0x2f) ||
        uuid->accepted != 0 ||
        uuid->iv != 3 ||
        uuid->context_id != 5) {
        printf("failure 1_5\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(6, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x53e7c5ec ||
         *((uint16_t *)uuid->uuid + 2) != 0x20ae ||
         *((uint16_t *)uuid->uuid + 3) != 0x34c3 ||
         *((uint16_t *)uuid->uuid + 4) != 0x9714 ||
         uuid->uuid[10] != 0x77 || uuid->uuid[11] != 0xf0 ||
         uuid->uuid[12] != 0xfe || uuid->uuid[13] != 0x68 ||
         uuid->uuid[14] != 0x05 || uuid->uuid[15] != 0xa8) ||
        uuid->accepted != 0 ||
        uuid->iv != 3 ||
        uuid->context_id != 6) {
        printf("failure 1_6\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(7, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xb50292d7 ||
         *((uint16_t *)uuid->uuid + 2) != 0xbdcd ||
         *((uint16_t *)uuid->uuid + 3) != 0x3535 ||
         *((uint16_t *)uuid->uuid + 4) != 0x1e94 ||
         uuid->uuid[10] != 0x88 || uuid->uuid[11] != 0x3d ||
         uuid->uuid[12] != 0x79 || uuid->uuid[13] != 0x63 ||
         uuid->uuid[14] != 0x2c || uuid->uuid[15] != 0x10) ||
        uuid->accepted != 0 ||
        uuid->iv != 0 ||
        uuid->context_id != 7) {
        printf("failure 1_7\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(8, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x7e6533b9 ||
         *((uint16_t *)uuid->uuid + 2) != 0xcdd9 ||
         *((uint16_t *)uuid->uuid + 3) != 0x1a03 ||
         *((uint16_t *)uuid->uuid + 4) != 0xa9b8 ||
         uuid->uuid[10] != 0xfc || uuid->uuid[11] != 0x12 ||
         uuid->uuid[12] != 0x9b || uuid->uuid[13] != 0x0d ||
         uuid->uuid[14] != 0xb9 || uuid->uuid[15] != 0x8b) ||
        uuid->accepted != 0 ||
        uuid->iv != 2 ||
        uuid->context_id != 8) {
        printf("failure 1_8\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(9, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x3d0ef1e7 ||
         *((uint16_t *)uuid->uuid + 2) != 0xb11a ||
         *((uint16_t *)uuid->uuid + 3) != 0xb04d ||
         *((uint16_t *)uuid->uuid + 4) != 0xaa43 ||
         uuid->uuid[10] != 0x65 || uuid->uuid[11] != 0x58 ||
         uuid->uuid[12] != 0x48 || uuid->uuid[13] != 0xad ||
         uuid->uuid[14] != 0xf2 || uuid->uuid[15] != 0xf4) ||
        uuid->accepted != 0 ||
        uuid->iv != 1 ||
        uuid->context_id != 9) {
        printf("failure 1_9\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(10, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xf73e2909 ||
         *((uint16_t *)uuid->uuid + 2) != 0x3245 ||
         *((uint16_t *)uuid->uuid + 3) != 0x10f5 ||
         *((uint16_t *)uuid->uuid + 4) != 0x2868 ||
         uuid->uuid[10] != 0xc7 || uuid->uuid[11] != 0x39 ||
         uuid->uuid[12] != 0xef || uuid->uuid[13] != 0x17 ||
         uuid->uuid[14] != 0x8a || uuid->uuid[15] != 0xfc) ||
        uuid->accepted != 0 ||
        uuid->iv != 3 ||
        uuid->context_id != 10) {
        printf("failure 1_10\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(11, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x19ccea46 ||
         *((uint16_t *)uuid->uuid + 2) != 0x0476 ||
         *((uint16_t *)uuid->uuid + 3) != 0x0cf4 ||
         *((uint16_t *)uuid->uuid + 4) != 0x9c2f ||
         uuid->uuid[10] != 0x17 || uuid->uuid[11] != 0xb2 ||
         uuid->uuid[12] != 0x72 || uuid->uuid[13] != 0xf4 ||
         uuid->uuid[14] != 0x84 || uuid->uuid[15] != 0x4f) ||
        uuid->accepted != 0 ||
        uuid->iv != 2 ||
        uuid->context_id != 11) {
        printf("failure 1_11\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(12, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x3919286a ||
         *((uint16_t *)uuid->uuid + 2) != 0xb10c ||
         *((uint16_t *)uuid->uuid + 3) != 0x11d0 ||
         *((uint16_t *)uuid->uuid + 4) != 0x9ba8 ||
         uuid->uuid[10] != 0x00 || uuid->uuid[11] != 0xc0 ||
         uuid->uuid[12] != 0x4f || uuid->uuid[13] != 0xd9 ||
         uuid->uuid[14] != 0x2e || uuid->uuid[15] != 0xf5) ||
        uuid->accepted != 0 ||
        uuid->iv != 0 ||
        uuid->context_id != 12) {
        printf("failure 1_12\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(13, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xbd65428d ||
         *((uint16_t *)uuid->uuid + 2) != 0x3257 ||
         *((uint16_t *)uuid->uuid + 3) != 0x064d ||
         *((uint16_t *)uuid->uuid + 4) != 0x101c ||
         uuid->uuid[10] != 0x01 || uuid->uuid[11] != 0x75 ||
         uuid->uuid[12] != 0x78 || uuid->uuid[13] != 0x9c ||
         uuid->uuid[14] != 0x8d || uuid->uuid[15] != 0xf5) ||
        uuid->accepted != 0 ||
        uuid->iv != 1 ||
        uuid->context_id != 13) {
        printf("failure 1_13\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(14, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x14a0d872 ||
         *((uint16_t *)uuid->uuid + 2) != 0xb2a6 ||
         *((uint16_t *)uuid->uuid + 3) != 0xaff7 ||
         *((uint16_t *)uuid->uuid + 4) != 0x5909 ||
         uuid->uuid[10] != 0x3b || uuid->uuid[11] != 0x93 ||
         uuid->uuid[12] != 0xcd || uuid->uuid[13] != 0x86 ||
         uuid->uuid[14] != 0xa5 || uuid->uuid[15] != 0xf4) ||
        uuid->accepted != 0 ||
        uuid->iv != 0 ||
        uuid->context_id != 14) {
        printf("failure 1_14\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(15, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x9dbd5165 ||
         *((uint16_t *)uuid->uuid + 2) != 0x1e21 ||
         *((uint16_t *)uuid->uuid + 3) != 0x7d2e ||
         *((uint16_t *)uuid->uuid + 4) != 0x5e2a ||
         uuid->uuid[10] != 0x71 || uuid->uuid[11] != 0x4b ||
         uuid->uuid[12] != 0x66 || uuid->uuid[13] != 0xe9 ||
         uuid->uuid[14] != 0xf0 || uuid->uuid[15] != 0xde) ||
        uuid->accepted != 0 ||
        uuid->iv != 3 ||
        uuid->context_id != 15) {
        printf("failure 1_15\n");
        goto end;
    }

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, bindack, bindack_len);
    if (r != 0) {
        printf("failure parsing bindack\n");
        goto end;
    }
    if (state->connp[1].rpc_vers_minor != 0 ||
        state->connp[1].ptype != 12 ||
        state->connp[1].pfc_flags != 0x03 ||
        state->connp[1].auth_length != 0 ||
        state->connp[1].frag_length != 428 ||
        state->connp[1].call_id != 0 ||
        state->connp[1].assoc_group_id != 0x000043e3 ||
        state->connp[1].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 16 ||
        DCERPCListSize(&state->transactions) != 0) {
        printf("failure2\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xd68e6f7e ||
         *((uint16_t *)uuid->uuid + 2) != 0x97b0 ||
         *((uint16_t *)uuid->uuid + 3) != 0x71de ||
         *((uint16_t *)uuid->uuid + 4) != 0x8c44 ||
         uuid->uuid[10] != 0x78 || uuid->uuid[11] != 0x3c ||
         uuid->uuid[12] != 0x54 || uuid->uuid[13] != 0x60 ||
         uuid->uuid[14] != 0x97 || uuid->uuid[15] != 0xf1) ||
        uuid->accepted != 0 ||
        uuid->iv != 5 ||
        uuid->context_id != 0) {
        printf("failure 2_0\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(1, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xf17ec418 ||
         *((uint16_t *)uuid->uuid + 2) != 0x10d2 ||
         *((uint16_t *)uuid->uuid + 3) != 0x6b02 ||
         *((uint16_t *)uuid->uuid + 4) != 0x0e0c ||
         uuid->uuid[10] != 0xf6 || uuid->uuid[11] != 0x0b ||
         uuid->uuid[12] != 0x02 || uuid->uuid[13] != 0x95 ||
         uuid->uuid[14] != 0xae || uuid->uuid[15] != 0xa1) ||
        uuid->accepted != 0 ||
        uuid->iv != 3 ||
        uuid->context_id != 1) {
        printf("failure 2_1\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(2, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x313de470 ||
         *((uint16_t *)uuid->uuid + 2) != 0xf926 ||
         *((uint16_t *)uuid->uuid + 3) != 0xfe94 ||
         *((uint16_t *)uuid->uuid + 4) != 0x3c90 ||
         uuid->uuid[10] != 0x8b || uuid->uuid[11] != 0x6a ||
         uuid->uuid[12] != 0x51 || uuid->uuid[13] != 0xa9 ||
         uuid->uuid[14] != 0xbb || uuid->uuid[15] != 0x95) ||
        uuid->accepted != 0 ||
        uuid->iv != 1 ||
        uuid->context_id != 2) {
        printf("failure 2_2\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(3, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xd5f1ede8 ||
         *((uint16_t *)uuid->uuid + 2) != 0x82a6 ||
         *((uint16_t *)uuid->uuid + 3) != 0x76c5 ||
         *((uint16_t *)uuid->uuid + 4) != 0xce2d ||
         uuid->uuid[10] != 0xd8 || uuid->uuid[11] != 0x7c ||
         uuid->uuid[12] != 0x6c || uuid->uuid[13] != 0x11 ||
         uuid->uuid[14] != 0x6f || uuid->uuid[15] != 0xa0) ||
        uuid->accepted != 0 ||
        uuid->iv != 1 ||
        uuid->context_id != 3) {
        printf("failure 2_3\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(4, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x86076109 ||
         *((uint16_t *)uuid->uuid + 2) != 0xb1ef ||
         *((uint16_t *)uuid->uuid + 3) != 0xb805 ||
         *((uint16_t *)uuid->uuid + 4) != 0xd3d5 ||
         uuid->uuid[10] != 0xfa || uuid->uuid[11] != 0x2d ||
         uuid->uuid[12] != 0x04 || uuid->uuid[13] != 0x6c ||
         uuid->uuid[14] != 0x90 || uuid->uuid[15] != 0x5e) ||
        uuid->accepted != 0 ||
        uuid->iv != 0 ||
        uuid->context_id != 4) {
        printf("failure 2_4\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(5, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xb401ed8f ||
         *((uint16_t *)uuid->uuid + 2) != 0x4bdc ||
         *((uint16_t *)uuid->uuid + 3) != 0x8655 ||
         *((uint16_t *)uuid->uuid + 4) != 0x99a7 ||
         uuid->uuid[10] != 0x6a || uuid->uuid[11] != 0x64 ||
         uuid->uuid[12] != 0x7f || uuid->uuid[13] != 0x32 ||
         uuid->uuid[14] != 0xe9 || uuid->uuid[15] != 0x2f) ||
        uuid->accepted != 0 ||
        uuid->iv != 3 ||
        uuid->context_id != 5) {
        printf("failure 2_5\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(6, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x53e7c5ec ||
         *((uint16_t *)uuid->uuid + 2) != 0x20ae ||
         *((uint16_t *)uuid->uuid + 3) != 0x34c3 ||
         *((uint16_t *)uuid->uuid + 4) != 0x9714 ||
         uuid->uuid[10] != 0x77 || uuid->uuid[11] != 0xf0 ||
         uuid->uuid[12] != 0xfe || uuid->uuid[13] != 0x68 ||
         uuid->uuid[14] != 0x05 || uuid->uuid[15] != 0xa8) ||
        uuid->accepted != 0 ||
        uuid->iv != 3 ||
        uuid->context_id != 6) {
        printf("failure 2_6\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(7, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xb50292d7 ||
         *((uint16_t *)uuid->uuid + 2) != 0xbdcd ||
         *((uint16_t *)uuid->uuid + 3) != 0x3535 ||
         *((uint16_t *)uuid->uuid + 4) != 0x1e94 ||
         uuid->uuid[10] != 0x88 || uuid->uuid[11] != 0x3d ||
         uuid->uuid[12] != 0x79 || uuid->uuid[13] != 0x63 ||
         uuid->uuid[14] != 0x2c || uuid->uuid[15] != 0x10) ||
        uuid->accepted != 0 ||
        uuid->iv != 0 ||
        uuid->context_id != 7) {
        printf("failure 2_7\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(8, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x7e6533b9 ||
         *((uint16_t *)uuid->uuid + 2) != 0xcdd9 ||
         *((uint16_t *)uuid->uuid + 3) != 0x1a03 ||
         *((uint16_t *)uuid->uuid + 4) != 0xa9b8 ||
         uuid->uuid[10] != 0xfc || uuid->uuid[11] != 0x12 ||
         uuid->uuid[12] != 0x9b || uuid->uuid[13] != 0x0d ||
         uuid->uuid[14] != 0xb9 || uuid->uuid[15] != 0x8b) ||
        uuid->accepted != 0 ||
        uuid->iv != 2 ||
        uuid->context_id != 8) {
        printf("failure 2_8\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(9, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x3d0ef1e7 ||
         *((uint16_t *)uuid->uuid + 2) != 0xb11a ||
         *((uint16_t *)uuid->uuid + 3) != 0xb04d ||
         *((uint16_t *)uuid->uuid + 4) != 0xaa43 ||
         uuid->uuid[10] != 0x65 || uuid->uuid[11] != 0x58 ||
         uuid->uuid[12] != 0x48 || uuid->uuid[13] != 0xad ||
         uuid->uuid[14] != 0xf2 || uuid->uuid[15] != 0xf4) ||
        uuid->accepted != 0 ||
        uuid->iv != 1 ||
        uuid->context_id != 9) {
        printf("failure 2_9\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(10, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xf73e2909 ||
         *((uint16_t *)uuid->uuid + 2) != 0x3245 ||
         *((uint16_t *)uuid->uuid + 3) != 0x10f5 ||
         *((uint16_t *)uuid->uuid + 4) != 0x2868 ||
         uuid->uuid[10] != 0xc7 || uuid->uuid[11] != 0x39 ||
         uuid->uuid[12] != 0xef || uuid->uuid[13] != 0x17 ||
         uuid->uuid[14] != 0x8a || uuid->uuid[15] != 0xfc) ||
        uuid->accepted != 0 ||
        uuid->iv != 3 ||
        uuid->context_id != 10) {
        printf("failure 2_10\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(11, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x19ccea46 ||
         *((uint16_t *)uuid->uuid + 2) != 0x0476 ||
         *((uint16_t *)uuid->uuid + 3) != 0x0cf4 ||
         *((uint16_t *)uuid->uuid + 4) != 0x9c2f ||
         uuid->uuid[10] != 0x17 || uuid->uuid[11] != 0xb2 ||
         uuid->uuid[12] != 0x72 || uuid->uuid[13] != 0xf4 ||
         uuid->uuid[14] != 0x84 || uuid->uuid[15] != 0x4f) ||
        uuid->accepted != 0 ||
        uuid->iv != 2 ||
        uuid->context_id != 11) {
        printf("failure 2_11\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(12, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x3919286a ||
         *((uint16_t *)uuid->uuid + 2) != 0xb10c ||
         *((uint16_t *)uuid->uuid + 3) != 0x11d0 ||
         *((uint16_t *)uuid->uuid + 4) != 0x9ba8 ||
         uuid->uuid[10] != 0x00 || uuid->uuid[11] != 0xc0 ||
         uuid->uuid[12] != 0x4f || uuid->uuid[13] != 0xd9 ||
         uuid->uuid[14] != 0x2e || uuid->uuid[15] != 0xf5) ||
        uuid->accepted != 1 ||
        uuid->iv != 0 ||
        uuid->context_id != 12) {
        printf("failure 2_12\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(13, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xbd65428d ||
         *((uint16_t *)uuid->uuid + 2) != 0x3257 ||
         *((uint16_t *)uuid->uuid + 3) != 0x064d ||
         *((uint16_t *)uuid->uuid + 4) != 0x101c ||
         uuid->uuid[10] != 0x01 || uuid->uuid[11] != 0x75 ||
         uuid->uuid[12] != 0x78 || uuid->uuid[13] != 0x9c ||
         uuid->uuid[14] != 0x8d || uuid->uuid[15] != 0xf5) ||
        uuid->accepted != 0 ||
        uuid->iv != 1 ||
        uuid->context_id != 13) {
        printf("failure 2_13\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(14, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x14a0d872 ||
         *((uint16_t *)uuid->uuid + 2) != 0xb2a6 ||
         *((uint16_t *)uuid->uuid + 3) != 0xaff7 ||
         *((uint16_t *)uuid->uuid + 4) != 0x5909 ||
         uuid->uuid[10] != 0x3b || uuid->uuid[11] != 0x93 ||
         uuid->uuid[12] != 0xcd || uuid->uuid[13] != 0x86 ||
         uuid->uuid[14] != 0xa5 || uuid->uuid[15] != 0xf4) ||
        uuid->accepted != 0 ||
        uuid->iv != 0 ||
        uuid->context_id != 14) {
        printf("failure 2_14\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(15, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x9dbd5165 ||
         *((uint16_t *)uuid->uuid + 2) != 0x1e21 ||
         *((uint16_t *)uuid->uuid + 3) != 0x7d2e ||
         *((uint16_t *)uuid->uuid + 4) != 0x5e2a ||
         uuid->uuid[10] != 0x71 || uuid->uuid[11] != 0x4b ||
         uuid->uuid[12] != 0x66 || uuid->uuid[13] != 0xe9 ||
         uuid->uuid[14] != 0xf0 || uuid->uuid[15] != 0xde) ||
        uuid->accepted != 0 ||
        uuid->iv != 3 ||
        uuid->context_id != 15) {
        printf("failure 2_15\n");
        goto end;
    }

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER, request1, request1_len);
    if (r != 0) {
        printf("failure parsing request1\n");
        goto end;
    }
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 0 ||
        state->connp[0].pfc_flags != 0x01 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 151 ||
        state->connp[0].call_id != 0 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[0].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 16 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure3\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xd68e6f7e ||
         *((uint16_t *)uuid->uuid + 2) != 0x97b0 ||
         *((uint16_t *)uuid->uuid + 3) != 0x71de ||
         *((uint16_t *)uuid->uuid + 4) != 0x8c44 ||
         uuid->uuid[10] != 0x78 || uuid->uuid[11] != 0x3c ||
         uuid->uuid[12] != 0x54 || uuid->uuid[13] != 0x60 ||
         uuid->uuid[14] != 0x97 || uuid->uuid[15] != 0xf1) ||
        uuid->accepted != 0 ||
        uuid->iv != 5 ||
        uuid->context_id != 0) {
        printf("failure 3_0\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(1, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xf17ec418 ||
         *((uint16_t *)uuid->uuid + 2) != 0x10d2 ||
         *((uint16_t *)uuid->uuid + 3) != 0x6b02 ||
         *((uint16_t *)uuid->uuid + 4) != 0x0e0c ||
         uuid->uuid[10] != 0xf6 || uuid->uuid[11] != 0x0b ||
         uuid->uuid[12] != 0x02 || uuid->uuid[13] != 0x95 ||
         uuid->uuid[14] != 0xae || uuid->uuid[15] != 0xa1) ||
        uuid->accepted != 0 ||
        uuid->iv != 3 ||
        uuid->context_id != 1) {
        printf("failure 3_1\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(2, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x313de470 ||
         *((uint16_t *)uuid->uuid + 2) != 0xf926 ||
         *((uint16_t *)uuid->uuid + 3) != 0xfe94 ||
         *((uint16_t *)uuid->uuid + 4) != 0x3c90 ||
         uuid->uuid[10] != 0x8b || uuid->uuid[11] != 0x6a ||
         uuid->uuid[12] != 0x51 || uuid->uuid[13] != 0xa9 ||
         uuid->uuid[14] != 0xbb || uuid->uuid[15] != 0x95) ||
        uuid->accepted != 0 ||
        uuid->iv != 1 ||
        uuid->context_id != 2) {
        printf("failure 3_2\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(3, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xd5f1ede8 ||
         *((uint16_t *)uuid->uuid + 2) != 0x82a6 ||
         *((uint16_t *)uuid->uuid + 3) != 0x76c5 ||
         *((uint16_t *)uuid->uuid + 4) != 0xce2d ||
         uuid->uuid[10] != 0xd8 || uuid->uuid[11] != 0x7c ||
         uuid->uuid[12] != 0x6c || uuid->uuid[13] != 0x11 ||
         uuid->uuid[14] != 0x6f || uuid->uuid[15] != 0xa0) ||
        uuid->accepted != 0 ||
        uuid->iv != 1 ||
        uuid->context_id != 3) {
        printf("failure 3_3\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(4, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x86076109 ||
         *((uint16_t *)uuid->uuid + 2) != 0xb1ef ||
         *((uint16_t *)uuid->uuid + 3) != 0xb805 ||
         *((uint16_t *)uuid->uuid + 4) != 0xd3d5 ||
         uuid->uuid[10] != 0xfa || uuid->uuid[11] != 0x2d ||
         uuid->uuid[12] != 0x04 || uuid->uuid[13] != 0x6c ||
         uuid->uuid[14] != 0x90 || uuid->uuid[15] != 0x5e) ||
        uuid->accepted != 0 ||
        uuid->iv != 0 ||
        uuid->context_id != 4) {
        printf("failure 3_4\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(5, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xb401ed8f ||
         *((uint16_t *)uuid->uuid + 2) != 0x4bdc ||
         *((uint16_t *)uuid->uuid + 3) != 0x8655 ||
         *((uint16_t *)uuid->uuid + 4) != 0x99a7 ||
         uuid->uuid[10] != 0x6a || uuid->uuid[11] != 0x64 ||
         uuid->uuid[12] != 0x7f || uuid->uuid[13] != 0x32 ||
         uuid->uuid[14] != 0xe9 || uuid->uuid[15] != 0x2f) ||
        uuid->accepted != 0 ||
        uuid->iv != 3 ||
        uuid->context_id != 5) {
        printf("failure 3_5\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(6, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x53e7c5ec ||
         *((uint16_t *)uuid->uuid + 2) != 0x20ae ||
         *((uint16_t *)uuid->uuid + 3) != 0x34c3 ||
         *((uint16_t *)uuid->uuid + 4) != 0x9714 ||
         uuid->uuid[10] != 0x77 || uuid->uuid[11] != 0xf0 ||
         uuid->uuid[12] != 0xfe || uuid->uuid[13] != 0x68 ||
         uuid->uuid[14] != 0x05 || uuid->uuid[15] != 0xa8) ||
        uuid->accepted != 0 ||
        uuid->iv != 3 ||
        uuid->context_id != 6) {
        printf("failure 3_6\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(7, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xb50292d7 ||
         *((uint16_t *)uuid->uuid + 2) != 0xbdcd ||
         *((uint16_t *)uuid->uuid + 3) != 0x3535 ||
         *((uint16_t *)uuid->uuid + 4) != 0x1e94 ||
         uuid->uuid[10] != 0x88 || uuid->uuid[11] != 0x3d ||
         uuid->uuid[12] != 0x79 || uuid->uuid[13] != 0x63 ||
         uuid->uuid[14] != 0x2c || uuid->uuid[15] != 0x10) ||
        uuid->accepted != 0 ||
        uuid->iv != 0 ||
        uuid->context_id != 7) {
        printf("failure 3_7\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(8, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x7e6533b9 ||
         *((uint16_t *)uuid->uuid + 2) != 0xcdd9 ||
         *((uint16_t *)uuid->uuid + 3) != 0x1a03 ||
         *((uint16_t *)uuid->uuid + 4) != 0xa9b8 ||
         uuid->uuid[10] != 0xfc || uuid->uuid[11] != 0x12 ||
         uuid->uuid[12] != 0x9b || uuid->uuid[13] != 0x0d ||
         uuid->uuid[14] != 0xb9 || uuid->uuid[15] != 0x8b) ||
        uuid->accepted != 0 ||
        uuid->iv != 2 ||
        uuid->context_id != 8) {
        printf("failure 3_8\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(9, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x3d0ef1e7 ||
         *((uint16_t *)uuid->uuid + 2) != 0xb11a ||
         *((uint16_t *)uuid->uuid + 3) != 0xb04d ||
         *((uint16_t *)uuid->uuid + 4) != 0xaa43 ||
         uuid->uuid[10] != 0x65 || uuid->uuid[11] != 0x58 ||
         uuid->uuid[12] != 0x48 || uuid->uuid[13] != 0xad ||
         uuid->uuid[14] != 0xf2 || uuid->uuid[15] != 0xf4) ||
        uuid->accepted != 0 ||
        uuid->iv != 1 ||
        uuid->context_id != 9) {
        printf("failure 3_9\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(10, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xf73e2909 ||
         *((uint16_t *)uuid->uuid + 2) != 0x3245 ||
         *((uint16_t *)uuid->uuid + 3) != 0x10f5 ||
         *((uint16_t *)uuid->uuid + 4) != 0x2868 ||
         uuid->uuid[10] != 0xc7 || uuid->uuid[11] != 0x39 ||
         uuid->uuid[12] != 0xef || uuid->uuid[13] != 0x17 ||
         uuid->uuid[14] != 0x8a || uuid->uuid[15] != 0xfc) ||
        uuid->accepted != 0 ||
        uuid->iv != 3 ||
        uuid->context_id != 10) {
        printf("failure 3_10\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(11, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x19ccea46 ||
         *((uint16_t *)uuid->uuid + 2) != 0x0476 ||
         *((uint16_t *)uuid->uuid + 3) != 0x0cf4 ||
         *((uint16_t *)uuid->uuid + 4) != 0x9c2f ||
         uuid->uuid[10] != 0x17 || uuid->uuid[11] != 0xb2 ||
         uuid->uuid[12] != 0x72 || uuid->uuid[13] != 0xf4 ||
         uuid->uuid[14] != 0x84 || uuid->uuid[15] != 0x4f) ||
        uuid->accepted != 0 ||
        uuid->iv != 2 ||
        uuid->context_id != 11) {
        printf("failure 3_11\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(12, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x3919286a ||
         *((uint16_t *)uuid->uuid + 2) != 0xb10c ||
         *((uint16_t *)uuid->uuid + 3) != 0x11d0 ||
         *((uint16_t *)uuid->uuid + 4) != 0x9ba8 ||
         uuid->uuid[10] != 0x00 || uuid->uuid[11] != 0xc0 ||
         uuid->uuid[12] != 0x4f || uuid->uuid[13] != 0xd9 ||
         uuid->uuid[14] != 0x2e || uuid->uuid[15] != 0xf5) ||
        uuid->accepted != 1 ||
        uuid->iv != 0 ||
        uuid->context_id != 12) {
        printf("failure 3_12\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(13, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xbd65428d ||
         *((uint16_t *)uuid->uuid + 2) != 0x3257 ||
         *((uint16_t *)uuid->uuid + 3) != 0x064d ||
         *((uint16_t *)uuid->uuid + 4) != 0x101c ||
         uuid->uuid[10] != 0x01 || uuid->uuid[11] != 0x75 ||
         uuid->uuid[12] != 0x78 || uuid->uuid[13] != 0x9c ||
         uuid->uuid[14] != 0x8d || uuid->uuid[15] != 0xf5) ||
        uuid->accepted != 0 ||
        uuid->iv != 1 ||
        uuid->context_id != 13) {
        printf("failure 3_13\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(14, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x14a0d872 ||
         *((uint16_t *)uuid->uuid + 2) != 0xb2a6 ||
         *((uint16_t *)uuid->uuid + 3) != 0xaff7 ||
         *((uint16_t *)uuid->uuid + 4) != 0x5909 ||
         uuid->uuid[10] != 0x3b || uuid->uuid[11] != 0x93 ||
         uuid->uuid[12] != 0xcd || uuid->uuid[13] != 0x86 ||
         uuid->uuid[14] != 0xa5 || uuid->uuid[15] != 0xf4) ||
        uuid->accepted != 0 ||
        uuid->iv != 0 ||
        uuid->context_id != 14) {
        printf("failure 3_14\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(15, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x9dbd5165 ||
         *((uint16_t *)uuid->uuid + 2) != 0x1e21 ||
         *((uint16_t *)uuid->uuid + 3) != 0x7d2e ||
         *((uint16_t *)uuid->uuid + 4) != 0x5e2a ||
         uuid->uuid[10] != 0x71 || uuid->uuid[11] != 0x4b ||
         uuid->uuid[12] != 0x66 || uuid->uuid[13] != 0xe9 ||
         uuid->uuid[14] != 0xf0 || uuid->uuid[15] != 0xde) ||
        uuid->accepted != 0 ||
        uuid->iv != 3 ||
        uuid->context_id != 15) {
        printf("failure 3_15\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 0 ||
        tx->opnum != 9 ||
        tx->stub_len[0] != 127 ||
        tx->stub_len[1] != 0) {
        printf("failure 3_16\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x3919286a ||
         *((uint16_t *)tx->iface.uuid + 2) != 0xb10c ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x11d0 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0x9ba8 ||
         tx->iface.uuid[10] != 0x00 || tx->iface.uuid[11] != 0xc0 ||
         tx->iface.uuid[12] != 0x4f || tx->iface.uuid[13] != 0xd9 ||
         tx->iface.uuid[14] != 0x2e || tx->iface.uuid[15] != 0xf5)) {
        printf("failure 3_17\n");
        goto end;
    }

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER, request2, request2_len);
    if (r != 0) {
        printf("failure parsing request2\n");
        goto end;
    }
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 0 ||
        state->connp[0].pfc_flags != 0x00 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 151 ||
        state->connp[0].call_id != 0 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[0].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 16 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure4\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xd68e6f7e ||
         *((uint16_t *)uuid->uuid + 2) != 0x97b0 ||
         *((uint16_t *)uuid->uuid + 3) != 0x71de ||
         *((uint16_t *)uuid->uuid + 4) != 0x8c44 ||
         uuid->uuid[10] != 0x78 || uuid->uuid[11] != 0x3c ||
         uuid->uuid[12] != 0x54 || uuid->uuid[13] != 0x60 ||
         uuid->uuid[14] != 0x97 || uuid->uuid[15] != 0xf1) ||
        uuid->accepted != 0 ||
        uuid->iv != 5 ||
        uuid->context_id != 0) {
        printf("failure 4_0\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(1, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xf17ec418 ||
         *((uint16_t *)uuid->uuid + 2) != 0x10d2 ||
         *((uint16_t *)uuid->uuid + 3) != 0x6b02 ||
         *((uint16_t *)uuid->uuid + 4) != 0x0e0c ||
         uuid->uuid[10] != 0xf6 || uuid->uuid[11] != 0x0b ||
         uuid->uuid[12] != 0x02 || uuid->uuid[13] != 0x95 ||
         uuid->uuid[14] != 0xae || uuid->uuid[15] != 0xa1) ||
        uuid->accepted != 0 ||
        uuid->iv != 3 ||
        uuid->context_id != 1) {
        printf("failure 4_1\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(2, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x313de470 ||
         *((uint16_t *)uuid->uuid + 2) != 0xf926 ||
         *((uint16_t *)uuid->uuid + 3) != 0xfe94 ||
         *((uint16_t *)uuid->uuid + 4) != 0x3c90 ||
         uuid->uuid[10] != 0x8b || uuid->uuid[11] != 0x6a ||
         uuid->uuid[12] != 0x51 || uuid->uuid[13] != 0xa9 ||
         uuid->uuid[14] != 0xbb || uuid->uuid[15] != 0x95) ||
        uuid->accepted != 0 ||
        uuid->iv != 1 ||
        uuid->context_id != 2) {
        printf("failure 4_2\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(3, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xd5f1ede8 ||
         *((uint16_t *)uuid->uuid + 2) != 0x82a6 ||
         *((uint16_t *)uuid->uuid + 3) != 0x76c5 ||
         *((uint16_t *)uuid->uuid + 4) != 0xce2d ||
         uuid->uuid[10] != 0xd8 || uuid->uuid[11] != 0x7c ||
         uuid->uuid[12] != 0x6c || uuid->uuid[13] != 0x11 ||
         uuid->uuid[14] != 0x6f || uuid->uuid[15] != 0xa0) ||
        uuid->accepted != 0 ||
        uuid->iv != 1 ||
        uuid->context_id != 3) {
        printf("failure 4_3\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(4, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x86076109 ||
         *((uint16_t *)uuid->uuid + 2) != 0xb1ef ||
         *((uint16_t *)uuid->uuid + 3) != 0xb805 ||
         *((uint16_t *)uuid->uuid + 4) != 0xd3d5 ||
         uuid->uuid[10] != 0xfa || uuid->uuid[11] != 0x2d ||
         uuid->uuid[12] != 0x04 || uuid->uuid[13] != 0x6c ||
         uuid->uuid[14] != 0x90 || uuid->uuid[15] != 0x5e) ||
        uuid->accepted != 0 ||
        uuid->iv != 0 ||
        uuid->context_id != 4) {
        printf("failure 4_4\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(5, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xb401ed8f ||
         *((uint16_t *)uuid->uuid + 2) != 0x4bdc ||
         *((uint16_t *)uuid->uuid + 3) != 0x8655 ||
         *((uint16_t *)uuid->uuid + 4) != 0x99a7 ||
         uuid->uuid[10] != 0x6a || uuid->uuid[11] != 0x64 ||
         uuid->uuid[12] != 0x7f || uuid->uuid[13] != 0x32 ||
         uuid->uuid[14] != 0xe9 || uuid->uuid[15] != 0x2f) ||
        uuid->accepted != 0 ||
        uuid->iv != 3 ||
        uuid->context_id != 5) {
        printf("failure 4_5\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(6, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x53e7c5ec ||
         *((uint16_t *)uuid->uuid + 2) != 0x20ae ||
         *((uint16_t *)uuid->uuid + 3) != 0x34c3 ||
         *((uint16_t *)uuid->uuid + 4) != 0x9714 ||
         uuid->uuid[10] != 0x77 || uuid->uuid[11] != 0xf0 ||
         uuid->uuid[12] != 0xfe || uuid->uuid[13] != 0x68 ||
         uuid->uuid[14] != 0x05 || uuid->uuid[15] != 0xa8) ||
        uuid->accepted != 0 ||
        uuid->iv != 3 ||
        uuid->context_id != 6) {
        printf("failure 4_6\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(7, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xb50292d7 ||
         *((uint16_t *)uuid->uuid + 2) != 0xbdcd ||
         *((uint16_t *)uuid->uuid + 3) != 0x3535 ||
         *((uint16_t *)uuid->uuid + 4) != 0x1e94 ||
         uuid->uuid[10] != 0x88 || uuid->uuid[11] != 0x3d ||
         uuid->uuid[12] != 0x79 || uuid->uuid[13] != 0x63 ||
         uuid->uuid[14] != 0x2c || uuid->uuid[15] != 0x10) ||
        uuid->accepted != 0 ||
        uuid->iv != 0 ||
        uuid->context_id != 7) {
        printf("failure 4_7\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(8, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x7e6533b9 ||
         *((uint16_t *)uuid->uuid + 2) != 0xcdd9 ||
         *((uint16_t *)uuid->uuid + 3) != 0x1a03 ||
         *((uint16_t *)uuid->uuid + 4) != 0xa9b8 ||
         uuid->uuid[10] != 0xfc || uuid->uuid[11] != 0x12 ||
         uuid->uuid[12] != 0x9b || uuid->uuid[13] != 0x0d ||
         uuid->uuid[14] != 0xb9 || uuid->uuid[15] != 0x8b) ||
        uuid->accepted != 0 ||
        uuid->iv != 2 ||
        uuid->context_id != 8) {
        printf("failure 4_8\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(9, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x3d0ef1e7 ||
         *((uint16_t *)uuid->uuid + 2) != 0xb11a ||
         *((uint16_t *)uuid->uuid + 3) != 0xb04d ||
         *((uint16_t *)uuid->uuid + 4) != 0xaa43 ||
         uuid->uuid[10] != 0x65 || uuid->uuid[11] != 0x58 ||
         uuid->uuid[12] != 0x48 || uuid->uuid[13] != 0xad ||
         uuid->uuid[14] != 0xf2 || uuid->uuid[15] != 0xf4) ||
        uuid->accepted != 0 ||
        uuid->iv != 1 ||
        uuid->context_id != 9) {
        printf("failure 4_9\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(10, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xf73e2909 ||
         *((uint16_t *)uuid->uuid + 2) != 0x3245 ||
         *((uint16_t *)uuid->uuid + 3) != 0x10f5 ||
         *((uint16_t *)uuid->uuid + 4) != 0x2868 ||
         uuid->uuid[10] != 0xc7 || uuid->uuid[11] != 0x39 ||
         uuid->uuid[12] != 0xef || uuid->uuid[13] != 0x17 ||
         uuid->uuid[14] != 0x8a || uuid->uuid[15] != 0xfc) ||
        uuid->accepted != 0 ||
        uuid->iv != 3 ||
        uuid->context_id != 10) {
        printf("failure 4_10\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(11, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x19ccea46 ||
         *((uint16_t *)uuid->uuid + 2) != 0x0476 ||
         *((uint16_t *)uuid->uuid + 3) != 0x0cf4 ||
         *((uint16_t *)uuid->uuid + 4) != 0x9c2f ||
         uuid->uuid[10] != 0x17 || uuid->uuid[11] != 0xb2 ||
         uuid->uuid[12] != 0x72 || uuid->uuid[13] != 0xf4 ||
         uuid->uuid[14] != 0x84 || uuid->uuid[15] != 0x4f) ||
        uuid->accepted != 0 ||
        uuid->iv != 2 ||
        uuid->context_id != 11) {
        printf("failure 4_11\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(12, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x3919286a ||
         *((uint16_t *)uuid->uuid + 2) != 0xb10c ||
         *((uint16_t *)uuid->uuid + 3) != 0x11d0 ||
         *((uint16_t *)uuid->uuid + 4) != 0x9ba8 ||
         uuid->uuid[10] != 0x00 || uuid->uuid[11] != 0xc0 ||
         uuid->uuid[12] != 0x4f || uuid->uuid[13] != 0xd9 ||
         uuid->uuid[14] != 0x2e || uuid->uuid[15] != 0xf5) ||
        uuid->accepted != 1 ||
        uuid->iv != 0 ||
        uuid->context_id != 12) {
        printf("failure 4_12\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(13, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xbd65428d ||
         *((uint16_t *)uuid->uuid + 2) != 0x3257 ||
         *((uint16_t *)uuid->uuid + 3) != 0x064d ||
         *((uint16_t *)uuid->uuid + 4) != 0x101c ||
         uuid->uuid[10] != 0x01 || uuid->uuid[11] != 0x75 ||
         uuid->uuid[12] != 0x78 || uuid->uuid[13] != 0x9c ||
         uuid->uuid[14] != 0x8d || uuid->uuid[15] != 0xf5) ||
        uuid->accepted != 0 ||
        uuid->iv != 1 ||
        uuid->context_id != 13) {
        printf("failure 4_13\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(14, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x14a0d872 ||
         *((uint16_t *)uuid->uuid + 2) != 0xb2a6 ||
         *((uint16_t *)uuid->uuid + 3) != 0xaff7 ||
         *((uint16_t *)uuid->uuid + 4) != 0x5909 ||
         uuid->uuid[10] != 0x3b || uuid->uuid[11] != 0x93 ||
         uuid->uuid[12] != 0xcd || uuid->uuid[13] != 0x86 ||
         uuid->uuid[14] != 0xa5 || uuid->uuid[15] != 0xf4) ||
        uuid->accepted != 0 ||
        uuid->iv != 0 ||
        uuid->context_id != 14) {
        printf("failure 4_14\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(15, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x9dbd5165 ||
         *((uint16_t *)uuid->uuid + 2) != 0x1e21 ||
         *((uint16_t *)uuid->uuid + 3) != 0x7d2e ||
         *((uint16_t *)uuid->uuid + 4) != 0x5e2a ||
         uuid->uuid[10] != 0x71 || uuid->uuid[11] != 0x4b ||
         uuid->uuid[12] != 0x66 || uuid->uuid[13] != 0xe9 ||
         uuid->uuid[14] != 0xf0 || uuid->uuid[15] != 0xde) ||
        uuid->accepted != 0 ||
        uuid->iv != 3 ||
        uuid->context_id != 15) {
        printf("failure 4_15\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 0 ||
        tx->opnum != 9 ||
        tx->stub_len[0] != 254 ||
        tx->stub_len[1] != 0) {
        printf("failure 4_16\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x3919286a ||
         *((uint16_t *)tx->iface.uuid + 2) != 0xb10c ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x11d0 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0x9ba8 ||
         tx->iface.uuid[10] != 0x00 || tx->iface.uuid[11] != 0xc0 ||
         tx->iface.uuid[12] != 0x4f || tx->iface.uuid[13] != 0xd9 ||
         tx->iface.uuid[14] != 0x2e || tx->iface.uuid[15] != 0xf5)) {
        printf("failure 4_17\n");
        goto end;
    }

    result = 1;

end:
    StreamTcpFreeConfig(TRUE);
    FLOW_DESTROY(&f);
    return result;
}

/**
 * \test bind, bind_ack, many small requests having a stub of 1 byte.
 *       211d4500. private_3329-0.pcap. pdus 5, 6, 7, 8.
 *
 *       private_lsass_direct_smb_fragsize1_bind_evasion_1_31.pcap.
 *       Pdus 17, 18, 20, 23, 25, ...
 */
int DCERPCParserTest09(void)
{
    int result = 0;

    uint8_t bind[] = {
        0x05, 0x00, 0x0b, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x94, 0x04, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0xd0, 0x16, 0xd0, 0x16, 0x00, 0x00, 0x00, 0x00,
        0x1a, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00,
        0x7d, 0x2a, 0x4b, 0xd6, 0xdc, 0x2e, 0x35, 0x59,
        0x22, 0x45, 0xea, 0x5a, 0x7a, 0xd4, 0xf9, 0xe3,
        0x04, 0x00, 0x00, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x01, 0x00, 0xdc, 0x60, 0x84, 0x6c,
        0x45, 0x7f, 0xb2, 0xd2, 0x1d, 0x2a, 0x4a, 0x3e,
        0x1a, 0x44, 0xa4, 0x0b, 0x04, 0x00, 0x00, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x21, 0x39, 0xd4, 0x82, 0x3d, 0xb4, 0xda, 0x58,
        0x0e, 0x57, 0x89, 0xc9, 0x61, 0x24, 0x22, 0x04,
        0x02, 0x00, 0x00, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
        0x03, 0x00, 0x01, 0x00, 0xa9, 0x7a, 0x85, 0x47,
        0x0c, 0xef, 0xa1, 0xac, 0xaf, 0x09, 0x2f, 0x47,
        0x62, 0x02, 0xb4, 0xd2, 0x01, 0x00, 0x03, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00, 0x04, 0x00, 0x01, 0x00,
        0x9f, 0x4a, 0x48, 0x69, 0x3c, 0xa2, 0x3a, 0x8a,
        0xe6, 0x65, 0xb4, 0x83, 0xf7, 0xad, 0x91, 0xd4,
        0x04, 0x00, 0x00, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
        0x05, 0x00, 0x01, 0x00, 0x75, 0xcb, 0x02, 0xda,
        0x7a, 0xb0, 0x47, 0x22, 0xc5, 0xfd, 0x96, 0x7e,
        0xfb, 0x18, 0xee, 0xe5, 0x02, 0x00, 0x03, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00, 0x06, 0x00, 0x01, 0x00,
        0x1e, 0x12, 0x21, 0xae, 0xa0, 0x05, 0x2e, 0x47,
        0x2c, 0x23, 0xaa, 0x64, 0x91, 0x16, 0x04, 0xcf,
        0x03, 0x00, 0x00, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
        0x07, 0x00, 0x01, 0x00, 0xb7, 0x2e, 0xb4, 0x74,
        0xb5, 0x74, 0xab, 0x00, 0xe7, 0xd5, 0x55, 0x74,
        0xc5, 0x23, 0x36, 0xf0, 0x03, 0x00, 0x02, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00, 0x08, 0x00, 0x01, 0x00,
        0x4f, 0xe4, 0x65, 0x59, 0x74, 0xfa, 0x67, 0x04,
        0x89, 0x77, 0xca, 0x6b, 0x90, 0x8f, 0x9a, 0x73,
        0x06, 0x00, 0x00, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
        0x09, 0x00, 0x01, 0x00, 0xfc, 0x36, 0xe0, 0x68,
        0x31, 0x3c, 0xb2, 0x8b, 0x2e, 0x51, 0xc1, 0xff,
        0xc7, 0x93, 0xbf, 0x3b, 0x03, 0x00, 0x01, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00, 0x0a, 0x00, 0x01, 0x00,
        0x10, 0xd4, 0x24, 0xfe, 0x7c, 0xbc, 0xdc, 0x28,
        0x08, 0xac, 0xd9, 0x01, 0xdd, 0x65, 0x49, 0xfb,
        0x02, 0x00, 0x02, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
        0x0b, 0x00, 0x01, 0x00, 0xb1, 0x1f, 0x2d, 0xb7,
        0x23, 0xad, 0x03, 0x1d, 0xdb, 0x63, 0x0a, 0x9b,
        0xb2, 0x98, 0x90, 0x8c, 0x04, 0x00, 0x00, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00, 0x0c, 0x00, 0x01, 0x00,
        0xf2, 0x2b, 0x43, 0xe1, 0xdb, 0x89, 0x97, 0xc9,
        0x81, 0x66, 0xa7, 0x1c, 0x0d, 0x95, 0x66, 0x62,
        0x05, 0x00, 0x03, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
        0x0d, 0x00, 0x01, 0x00, 0x87, 0x23, 0x12, 0x5a,
        0xc3, 0x1a, 0xe8, 0xc8, 0x06, 0xc5, 0x01, 0x7b,
        0xd2, 0xdc, 0xa3, 0xde, 0x05, 0x00, 0x03, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00, 0x0e, 0x00, 0x01, 0x00,
        0x6a, 0x28, 0x19, 0x39, 0x0c, 0xb1, 0xd0, 0x11,
        0x9b, 0xa8, 0x00, 0xc0, 0x4f, 0xd9, 0x2e, 0xf5,
        0x00, 0x00, 0x00, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
        0x0f, 0x00, 0x01, 0x00, 0xe6, 0x0f, 0x30, 0xe0,
        0x02, 0xe7, 0xe5, 0xed, 0x78, 0x6d, 0x2d, 0xbe,
        0x04, 0x18, 0x4b, 0xde, 0x04, 0x00, 0x00, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00, 0x10, 0x00, 0x01, 0x00,
        0xa8, 0x6b, 0x8a, 0xd7, 0x87, 0x8f, 0x4a, 0x60,
        0xfb, 0x79, 0xbb, 0xcd, 0xdd, 0xdd, 0xdf, 0xfe,
        0x03, 0x00, 0x01, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
        0x11, 0x00, 0x01, 0x00, 0xbc, 0x4f, 0x78, 0x2d,
        0xad, 0xc3, 0xfd, 0x7b, 0x37, 0xde, 0xd7, 0xaa,
        0xec, 0xec, 0x5e, 0xcb, 0x03, 0x00, 0x00, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00, 0x12, 0x00, 0x01, 0x00,
        0x79, 0xcc, 0x10, 0x72, 0x28, 0xe7, 0x59, 0x3e,
        0xcf, 0x14, 0xf4, 0xc9, 0x80, 0xa0, 0xda, 0x70,
        0x02, 0x00, 0x00, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
        0x13, 0x00, 0x01, 0x00, 0x7b, 0xed, 0x22, 0x89,
        0x47, 0x6a, 0x8a, 0x8d, 0x89, 0xd3, 0x12, 0x8e,
        0xf2, 0x06, 0x36, 0xda, 0x05, 0x00, 0x00, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00, 0x14, 0x00, 0x01, 0x00,
        0xf1, 0xaa, 0xab, 0x3b, 0xae, 0x04, 0xa8, 0xb4,
        0x96, 0x71, 0xba, 0xf8, 0xc6, 0x86, 0x09, 0xed,
        0x06, 0x00, 0x02, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
        0x15, 0x00, 0x01, 0x00, 0x0c, 0x6e, 0xc6, 0x1f,
        0x6f, 0xdf, 0xa0, 0x92, 0x7d, 0x29, 0xd3, 0x45,
        0x12, 0x96, 0x97, 0xc6, 0x02, 0x00, 0x01, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00, 0x16, 0x00, 0x01, 0x00,
        0x7b, 0x48, 0x71, 0xba, 0x08, 0xda, 0x91, 0xf5,
        0x70, 0xd3, 0x6e, 0xc6, 0xb4, 0x71, 0xd5, 0x43,
        0x01, 0x00, 0x00, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
        0x17, 0x00, 0x01, 0x00, 0xf1, 0x32, 0xff, 0xfe,
        0xbe, 0xdc, 0xf9, 0x54, 0xf8, 0xe3, 0x6e, 0x61,
        0xcc, 0xee, 0x74, 0x4e, 0x04, 0x00, 0x02, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00, 0x18, 0x00, 0x01, 0x00,
        0x1a, 0xdc, 0xdf, 0xea, 0x1a, 0xa4, 0xa4, 0xbe,
        0x85, 0x9f, 0xdc, 0x2b, 0xb2, 0xc7, 0xc3, 0xc8,
        0x02, 0x00, 0x02, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
        0x19, 0x00, 0x01, 0x00, 0x97, 0xfd, 0x6a, 0xeb,
        0xaf, 0xf5, 0x10, 0x8d, 0xa4, 0xa7, 0x3e, 0xf2,
        0x52, 0x62, 0x90, 0x83, 0x01, 0x00, 0x03, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00,
    };
    uint32_t bind_len = sizeof(bind);

    uint8_t bindack[] = {
        0x05, 0x00, 0x0c, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x9c, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0xb8, 0x10, 0xb8, 0x10, 0xd3, 0x47, 0x00, 0x00,
        0x0c, 0x00, 0x5c, 0x50, 0x49, 0x50, 0x45, 0x5c,
        0x6c, 0x73, 0x61, 0x73, 0x73, 0x00, 0x35, 0x59,
        0x1a, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00,
    };
    uint32_t bindack_len = sizeof(bindack);

    uint8_t request1[] = {
        0x05, 0x00, 0x00, 0x01, 0x10, 0x00, 0x00, 0x00,
        0x19, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x0e, 0x00, 0x09, 0x00,
        0xad,
    };
    uint32_t request1_len = sizeof(request1);

    uint8_t request2[] = {
        0x05, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00,
        0x19, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x0e, 0x00, 0x09, 0x00,
        0x0d,
    };
    uint32_t request2_len = sizeof(request2);

    uint8_t request3[] = {
        0x05, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00,
        0x19, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x0e, 0x00, 0x09, 0x00,
        0x00,
    };
    uint32_t request3_len = sizeof(request3);

    uint8_t request4[] = {
        0x05, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00,
        0x19, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x0e, 0x00, 0x09, 0x00,
        0x00,
    };
    uint32_t request4_len = sizeof(request4);

    uint8_t request5[] = {
        0x05, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00,
        0x19, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x0e, 0x00, 0x09, 0x00,
        0x00,
    };
    uint32_t request5_len = sizeof(request5);

    uint8_t request6[] = {
        0x05, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00,
        0x19, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x0e, 0x00, 0x09, 0x00,
        0x00,
    };
    uint32_t request6_len = sizeof(request6);

    uint8_t request7[] = {
        0x05, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00,
        0x19, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x0e, 0x00, 0x09, 0x00,
        0x00,
    };
    uint32_t request7_len = sizeof(request7);

    uint8_t request8[] = {
        0x05, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00,
        0x19, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x0e, 0x00, 0x09, 0x00,
        0x00,
    };
    uint32_t request8_len = sizeof(request8);

    uint8_t request9[] = {
        0x05, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00,
        0x19, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x0e, 0x00, 0x09, 0x00,
        0xad,
    };
    uint32_t request9_len = sizeof(request9);

    uint8_t request10[] = {
        0x05, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00,
        0x19, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x0e, 0x00, 0x09, 0x00,
        0x0d,
    };
    uint32_t request10_len = sizeof(request10);

    DCERPCState *state;
    Flow f;
    TcpSession ssn;
    int r;
    DCERPCTx *tx = NULL;

    memset(&f, 0, sizeof(f));
    memset(&ssn, 0, sizeof(ssn));
    FLOW_INITIALIZE(&f);
    f.protoctx = (void *)&ssn;

    StreamTcpInitConfig(TRUE);

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER | STREAM_START, bind, bind_len);
    if (r != 0) {
        printf("failure parsing bind\n");
        goto end;
    }
    state = f.alstate;
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 11 ||
        state->connp[0].pfc_flags != 0x03 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 1172 ||
        state->connp[0].call_id != 0 ||
        state->connp[0].assoc_group_id != 0 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[0].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 26 ||
        DCERPCListSize(&state->transactions) != 0) {
        printf("failure1\n");
        goto end;
    }

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, bindack, bindack_len);
    if (r != 0) {
        printf("failure parsing bindack\n");
        goto end;
    }
    if (state->connp[1].rpc_vers_minor != 0 ||
        state->connp[1].ptype != 12 ||
        state->connp[1].pfc_flags != 0x03 ||
        state->connp[1].auth_length != 0 ||
        state->connp[1].frag_length != 668 ||
        state->connp[1].call_id != 0 ||
        state->connp[1].assoc_group_id != 0x000047d3 ||
        state->connp[1].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 26 ||
        DCERPCListSize(&state->transactions) != 0) {
        printf("failure2\n");
        goto end;
    }

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER, request1, request1_len);
    if (r != 0) {
        printf("failure parsing request1\n");
        goto end;
    }
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 0 ||
        state->connp[0].pfc_flags != 0x01 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 25 ||
        state->connp[0].call_id != 0 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 26 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure3\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 0 ||
        tx->opnum != 9 ||
        tx->stub_len[0] != 1 ||
        tx->stub_len[1] != 0) {
        printf("failure 3_1\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x3919286a ||
         *((uint16_t *)tx->iface.uuid + 2) != 0xb10c ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x11d0 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0x9ba8 ||
         tx->iface.uuid[10] != 0x00 || tx->iface.uuid[11] != 0xc0 ||
         tx->iface.uuid[12] != 0x4f || tx->iface.uuid[13] != 0xd9 ||
         tx->iface.uuid[14] != 0x2e || tx->iface.uuid[15] != 0xf5)) {
        printf("failure 3_2\n");
        goto end;
    }

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER, request2, request2_len);
    if (r != 0) {
        printf("failure parsing request2\n");
        goto end;
    }
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 0 ||
        state->connp[0].pfc_flags != 0x00 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 25 ||
        state->connp[0].call_id != 0 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 26 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure4\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 0 ||
        tx->opnum != 9 ||
        tx->stub_len[0] != 2 ||
        tx->stub_len[1] != 0) {
        printf("failure 4_1\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x3919286a ||
         *((uint16_t *)tx->iface.uuid + 2) != 0xb10c ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x11d0 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0x9ba8 ||
         tx->iface.uuid[10] != 0x00 || tx->iface.uuid[11] != 0xc0 ||
         tx->iface.uuid[12] != 0x4f || tx->iface.uuid[13] != 0xd9 ||
         tx->iface.uuid[14] != 0x2e || tx->iface.uuid[15] != 0xf5)) {
        printf("failure 4_2\n");
        goto end;
    }

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER, request3, request3_len);
    if (r != 0) {
        printf("failure parsing request3\n");
        goto end;
    }
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 0 ||
        state->connp[0].pfc_flags != 0x00 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 25 ||
        state->connp[0].call_id != 0 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 26 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure5\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 0 ||
        tx->opnum != 9 ||
        tx->stub_len[0] != 3 ||
        tx->stub_len[1] != 0) {
        printf("failure 5_1\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x3919286a ||
         *((uint16_t *)tx->iface.uuid + 2) != 0xb10c ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x11d0 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0x9ba8 ||
         tx->iface.uuid[10] != 0x00 || tx->iface.uuid[11] != 0xc0 ||
         tx->iface.uuid[12] != 0x4f || tx->iface.uuid[13] != 0xd9 ||
         tx->iface.uuid[14] != 0x2e || tx->iface.uuid[15] != 0xf5)) {
        printf("failure 5_2\n");
        goto end;
    }

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER, request4, request4_len);
    if (r != 0) {
        printf("failure parsing request4\n");
        goto end;
    }
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 0 ||
        state->connp[0].pfc_flags != 0x00 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 25 ||
        state->connp[0].call_id != 0 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 26 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure6\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 0 ||
        tx->opnum != 9 ||
        tx->stub_len[0] != 4 ||
        tx->stub_len[1] != 0) {
        printf("failure 6_1\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x3919286a ||
         *((uint16_t *)tx->iface.uuid + 2) != 0xb10c ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x11d0 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0x9ba8 ||
         tx->iface.uuid[10] != 0x00 || tx->iface.uuid[11] != 0xc0 ||
         tx->iface.uuid[12] != 0x4f || tx->iface.uuid[13] != 0xd9 ||
         tx->iface.uuid[14] != 0x2e || tx->iface.uuid[15] != 0xf5)) {
        printf("failure 6_2\n");
        goto end;
    }

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER, request5, request5_len);
    if (r != 0) {
        printf("failure parsing request5\n");
        goto end;
    }
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 0 ||
        state->connp[0].pfc_flags != 0x00 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 25 ||
        state->connp[0].call_id != 0 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 26 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure7\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 0 ||
        tx->opnum != 9 ||
        tx->stub_len[0] != 5 ||
        tx->stub_len[1] != 0) {
        printf("failure 7_1\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x3919286a ||
         *((uint16_t *)tx->iface.uuid + 2) != 0xb10c ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x11d0 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0x9ba8 ||
         tx->iface.uuid[10] != 0x00 || tx->iface.uuid[11] != 0xc0 ||
         tx->iface.uuid[12] != 0x4f || tx->iface.uuid[13] != 0xd9 ||
         tx->iface.uuid[14] != 0x2e || tx->iface.uuid[15] != 0xf5)) {
        printf("failure 7_2\n");
        goto end;
    }

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER, request6, request6_len);
    if (r != 0) {
        printf("failure parsing request6\n");
        goto end;
    }
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 0 ||
        state->connp[0].pfc_flags != 0x00 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 25 ||
        state->connp[0].call_id != 0 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 26 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure8\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 0 ||
        tx->opnum != 9 ||
        tx->stub_len[0] != 6 ||
        tx->stub_len[1] != 0) {
        printf("failure 8_1\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x3919286a ||
         *((uint16_t *)tx->iface.uuid + 2) != 0xb10c ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x11d0 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0x9ba8 ||
         tx->iface.uuid[10] != 0x00 || tx->iface.uuid[11] != 0xc0 ||
         tx->iface.uuid[12] != 0x4f || tx->iface.uuid[13] != 0xd9 ||
         tx->iface.uuid[14] != 0x2e || tx->iface.uuid[15] != 0xf5)) {
        printf("failure 8_2\n");
        goto end;
    }

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER, request7, request7_len);
    if (r != 0) {
        printf("failure parsing request7\n");
        goto end;
    }
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 0 ||
        state->connp[0].pfc_flags != 0x00 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 25 ||
        state->connp[0].call_id != 0 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 26 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure9\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 0 ||
        tx->opnum != 9 ||
        tx->stub_len[0] != 7 ||
        tx->stub_len[1] != 0) {
        printf("failure 9_1\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x3919286a ||
         *((uint16_t *)tx->iface.uuid + 2) != 0xb10c ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x11d0 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0x9ba8 ||
         tx->iface.uuid[10] != 0x00 || tx->iface.uuid[11] != 0xc0 ||
         tx->iface.uuid[12] != 0x4f || tx->iface.uuid[13] != 0xd9 ||
         tx->iface.uuid[14] != 0x2e || tx->iface.uuid[15] != 0xf5)) {
        printf("failure 9_2\n");
        goto end;
    }

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER, request8, request8_len);
    if (r != 0) {
        printf("failure parsing request8\n");
        goto end;
    }
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 0 ||
        state->connp[0].pfc_flags != 0x00 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 25 ||
        state->connp[0].call_id != 0 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 26 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure10\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 0 ||
        tx->opnum != 9 ||
        tx->stub_len[0] != 8 ||
        tx->stub_len[1] != 0) {
        printf("failure 10_1\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x3919286a ||
         *((uint16_t *)tx->iface.uuid + 2) != 0xb10c ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x11d0 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0x9ba8 ||
         tx->iface.uuid[10] != 0x00 || tx->iface.uuid[11] != 0xc0 ||
         tx->iface.uuid[12] != 0x4f || tx->iface.uuid[13] != 0xd9 ||
         tx->iface.uuid[14] != 0x2e || tx->iface.uuid[15] != 0xf5)) {
        printf("failure 10_2\n");
        goto end;
    }

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER, request9, request9_len);
    if (r != 0) {
        printf("failure parsing request9\n");
        goto end;
    }
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 0 ||
        state->connp[0].pfc_flags != 0x00 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 25 ||
        state->connp[0].call_id != 0 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 26 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure11\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 0 ||
        tx->opnum != 9 ||
        tx->stub_len[0] != 9 ||
        tx->stub_len[1] != 0) {
        printf("failure 11_1\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x3919286a ||
         *((uint16_t *)tx->iface.uuid + 2) != 0xb10c ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x11d0 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0x9ba8 ||
         tx->iface.uuid[10] != 0x00 || tx->iface.uuid[11] != 0xc0 ||
         tx->iface.uuid[12] != 0x4f || tx->iface.uuid[13] != 0xd9 ||
         tx->iface.uuid[14] != 0x2e || tx->iface.uuid[15] != 0xf5)) {
        printf("failure 11_2\n");
        goto end;
    }

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER, request10, request10_len);
    if (r != 0) {
        printf("failure parsing request10\n");
        goto end;
    }
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 0 ||
        state->connp[0].pfc_flags != 0x00 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 25 ||
        state->connp[0].call_id != 0 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 26 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure12\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 0 ||
        tx->opnum != 9 ||
        tx->stub_len[0] != 10 ||
        tx->stub_len[1] != 0) {
        printf("failure 12_1\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x3919286a ||
         *((uint16_t *)tx->iface.uuid + 2) != 0xb10c ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x11d0 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0x9ba8 ||
         tx->iface.uuid[10] != 0x00 || tx->iface.uuid[11] != 0xc0 ||
         tx->iface.uuid[12] != 0x4f || tx->iface.uuid[13] != 0xd9 ||
         tx->iface.uuid[14] != 0x2e || tx->iface.uuid[15] != 0xf5)) {
        printf("failure 12_2\n");
        goto end;
    }

    result = 1;

end:
    StreamTcpFreeConfig(TRUE);
    FLOW_DESTROY(&f);
    return result;
}

/**
 * \test Fragmented bind, bind_ack, request and response(tcp frags and
 *       not dce frags).  Duplicate of Test01.
 *       211d4500. private_3329-0.pcap. pdus 5.
 */
int DCERPCParserTest10(void)
{
    int result = 0;

    uint8_t bind1[] = {
        0x05, 0x00, 0x0b, 0x03, 0x10, 0x00, 0x00, 0x00,
    };
    uint32_t bind1_len = sizeof(bind1);

    uint8_t bind2[] = {
        0x48, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
    };
    uint32_t bind2_len = sizeof(bind2);

    uint8_t bind3[] = {
        0xd0, 0x16, 0xd0, 0x16, 0x00, 0x00, 0x00, 0x00,
    };
    uint32_t bind3_len = sizeof(bind3);

    uint8_t bind4[] = {
        0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00,
    };
    uint32_t bind4_len = sizeof(bind4);

    uint8_t bind5[] = {
        0xc4, 0xfe, 0xfc, 0x99, 0x60, 0x52, 0x1b, 0x10,
    };
    uint32_t bind5_len = sizeof(bind5);

    uint8_t bind6[] = {
        0xbb, 0xcb, 0x00, 0xaa, 0x00, 0x21, 0x34, 0x7a,
    };
    uint32_t bind6_len = sizeof(bind6);

    uint8_t bind7[] = {
        0x00, 0x00, 0x00, 0x00, 0x04, 0x5d, 0x88, 0x8a,
    };
    uint32_t bind7_len = sizeof(bind7);

    uint8_t bind8[] = {
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
    };
    uint32_t bind8_len = sizeof(bind8);

    uint8_t bind9[] = {
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00
    };
    uint32_t bind9_len = sizeof(bind9);

    uint8_t bindack1[] = {
        0x05, 0x00, 0x0c, 0x03, 0x10, 0x00, 0x00, 0x00,
    };
    uint32_t bindack1_len = sizeof(bindack1);

    uint8_t bindack2[] = {
        0x3c, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
    };
    uint32_t bindack2_len = sizeof(bindack2);

    uint8_t bindack3[] = {
        0xd0, 0x16, 0xd0, 0x16, 0xe4, 0x94, 0xde, 0x10,
    };
    uint32_t bindack3_len = sizeof(bindack3);

    uint8_t bindack4[] = {
        0x04, 0x00, 0x31, 0x33, 0x35, 0x00, 0x00, 0x00,
    };
    uint32_t bindack4_len = sizeof(bindack4);

    uint8_t bindack5[] = {
        0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    };
    uint32_t bindack5_len = sizeof(bindack5);

    uint8_t bindack6[] = {
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
    };
    uint32_t bindack6_len = sizeof(bindack6);

    uint8_t bindack7[] = {
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
    };
    uint32_t bindack7_len = sizeof(bindack7);

    uint8_t bindack8[] = {
        0x02, 0x00, 0x00, 0x00
    };
    uint32_t bindack8_len = sizeof(bindack8);

    /* request has no stub data */
    uint8_t request1[] = {
        0x05, 0x00, 0x00, 0x03, 0x10, 0x00, 0x00, 0x00,
    };
    uint32_t request1_len = sizeof(request1);

    uint8_t request2[] = {
        0x18, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
    };
    uint32_t request2_len = sizeof(request2);

    uint8_t request3[] = {
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x05, 0x00
    };
    uint32_t request3_len = sizeof(request3);


    uint8_t response1[] = {
        0x05, 0x00, 0x02, 0x03, 0x10, 0x00, 0x00, 0x00,
    };
    uint32_t response1_len = sizeof(response1);

    uint8_t response2[] = {
        0x88, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
    };
    uint32_t response2_len = sizeof(response2);

    uint8_t response3[] = {
        0x70, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    };
    uint32_t response3_len = sizeof(response3);

    uint8_t response4[] = {
        0x05, 0x00, 0x06, 0x00, 0x50, 0xdd, 0x08, 0x00,
    };
    uint32_t response4_len = sizeof(response4);

    uint8_t response5[] = {
        0x2c, 0x00, 0x00, 0x00, 0x2c, 0x00, 0x19, 0x00,
    };
    uint32_t response5_len = sizeof(response5);

    uint8_t response6[] = {
        0x07, 0x00, 0x78, 0x00, 0x65, 0x00, 0x73, 0x00,
    };
    uint32_t response6_len = sizeof(response6);

    uint8_t response7[] = {
        0x70, 0x00, 0x72, 0x00, 0x69, 0x00, 0x31, 0x00,
    };
    uint32_t response7_len = sizeof(response7);

    uint8_t response8[] = {
        0x37, 0x00, 0x31, 0x00, 0x00, 0x00, 0x07, 0x00,
    };
    uint32_t response8_len = sizeof(response8);

    uint8_t response9[] = {
        0x34, 0x00, 0x34, 0x00, 0x2e, 0x00, 0x31, 0x00,
    };
    uint32_t response9_len = sizeof(response9);

    uint8_t response10[] = {
        0x30, 0x00, 0x2e, 0x00, 0x31, 0x00, 0x2e, 0x00,
    };
    uint32_t response10_len = sizeof(response10);

    uint8_t response11[] = {
        0x31, 0x00, 0x38, 0x00, 0x36, 0x00, 0x00, 0x00,
    };
    uint32_t response11_len = sizeof(response11);

    uint8_t response12[] = {
        0x00, 0x00, 0x09, 0x00, 0xff, 0xff, 0x00, 0x00,
    };
    uint32_t response12_len = sizeof(response12);

    uint8_t response13[] = {
        0x10, 0x00, 0xff, 0xff, 0x00, 0x00, 0x0a, 0x00,
    };
    uint32_t response13_len = sizeof(response13);

    uint8_t response14[] = {
        0xff, 0xff, 0x00, 0x00, 0x0e, 0x00, 0xff, 0xff,
    };
    uint32_t response14_len = sizeof(response14);

    uint8_t response15[] = {
        0x00, 0x00, 0x11, 0x00, 0xff, 0xff, 0x00, 0x00,
    };
    uint32_t response15_len = sizeof(response15);

    uint8_t response16[] = {
        0x12, 0x00, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00,
    };
    uint32_t response16_len = sizeof(response16);

    uint8_t response17[] = {
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
    };
    uint32_t response17_len = sizeof(response17);

    DCERPCState *state;
    Flow f;
    TcpSession ssn;
    int r;
    UUID *uuid = NULL;
    DCERPCTx *tx = NULL;

    memset(&f, 0, sizeof(f));
    memset(&ssn, 0, sizeof(ssn));
    FLOW_INITIALIZE(&f);
    f.protoctx = (void *)&ssn;

    StreamTcpInitConfig(TRUE);

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER | STREAM_START, bind1, bind1_len);
    if (r != 0) {
        printf("failure parsing bind1\n");
        goto end;
    }
    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER | STREAM_START, bind2, bind2_len);
    if (r != 0) {
        printf("failure parsing bind2\n");
        goto end;
    }
    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER | STREAM_START, bind3, bind3_len);
    if (r != 0) {
        printf("failure parsing bind3\n");
        goto end;
    }
    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER | STREAM_START, bind4, bind4_len);
    if (r != 0) {
        printf("failure parsing bind4\n");
        goto end;
    }
    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER | STREAM_START, bind5, bind5_len);
    if (r != 0) {
        printf("failure parsing bind5\n");
        goto end;
    }
    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER | STREAM_START, bind6, bind6_len);
    if (r != 0) {
        printf("failure parsing bind6\n");
        goto end;
    }
    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER | STREAM_START, bind7, bind7_len);
    if (r != 0) {
        printf("failure parsing bind7\n");
        goto end;
    }
    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER | STREAM_START, bind8, bind8_len);
    if (r != 0) {
        printf("failure parsing bind8\n");
        goto end;
    }
    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER | STREAM_START, bind9, bind9_len);
    if (r != 0) {
        printf("failure parsing bind9\n");
        goto end;
    }
    state = f.alstate;
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 11 ||
        state->connp[0].pfc_flags != 0x03 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 72 ||
        state->connp[0].call_id != 1 ||
        state->connp[0].assoc_group_id != 0 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[0].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 0) {
        printf("failure1\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x99fcfec4 ||
         *((uint16_t *)uuid->uuid + 2) != 0x5260 ||
         *((uint16_t *)uuid->uuid + 3) != 0x101b ||
         *((uint16_t *)uuid->uuid + 4) != 0xbbcb ||
         uuid->uuid[10] != 0x00 || uuid->uuid[11] != 0xaa ||
         uuid->uuid[12] != 0x00 || uuid->uuid[13] != 0x21 ||
         uuid->uuid[14] != 0x34 || uuid->uuid[15] != 0x7a) ||
        uuid->accepted != 0 ||
        uuid->iv != 0 ||
        uuid->context_id != 0) {
        printf("failure 1_1\n");
        goto end;
    }


    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, bindack1, bindack1_len);
    if (r != 0) {
        printf("failure parsing bindack1\n");
        goto end;
    }
    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, bindack2, bindack2_len);
    if (r != 0) {
        printf("failure parsing bindack2\n");
        goto end;
    }
    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, bindack3, bindack3_len);
    if (r != 0) {
        printf("failure parsing bindack3\n");
        goto end;
    }
    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, bindack4, bindack4_len);
    if (r != 0) {
        printf("failure parsing bindack4\n");
        goto end;
    }
    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, bindack5, bindack5_len);
    if (r != 0) {
        printf("failure parsing bindack5\n");
        goto end;
    }
    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, bindack6, bindack6_len);
    if (r != 0) {
        printf("failure parsing bindack6\n");
        goto end;
    }
    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, bindack7, bindack7_len);
    if (r != 0) {
        printf("failure parsing bindack7\n");
        goto end;
    }
    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, bindack8, bindack8_len);
    if (r != 0) {
        printf("failure parsing bindack8\n");
        goto end;
    }
    if (state->connp[1].rpc_vers_minor != 0 ||
        state->connp[1].ptype != 12 ||
        state->connp[1].pfc_flags != 0x03 ||
        state->connp[1].auth_length != 0 ||
        state->connp[1].frag_length != 60 ||
        state->connp[1].call_id != 1 ||
        state->connp[1].assoc_group_id != 0x10de94e4 ||
        state->connp[1].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 0) {
        printf("failure2\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x99fcfec4 ||
         *((uint16_t *)uuid->uuid + 2) != 0x5260 ||
         *((uint16_t *)uuid->uuid + 3) != 0x101b ||
         *((uint16_t *)uuid->uuid + 4) != 0xbbcb ||
         uuid->uuid[10] != 0x00 || uuid->uuid[11] != 0xaa ||
         uuid->uuid[12] != 0x00 || uuid->uuid[13] != 0x21 ||
         uuid->uuid[14] != 0x34 || uuid->uuid[15] != 0x7a) ||
        uuid->accepted != 1 ||
        uuid->iv != 0 ||
        uuid->context_id != 0) {
        printf("failure 2_1\n");
        goto end;
    }

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER, request1, request1_len);
    if (r != 0) {
        printf("failure parsing request1\n");
        goto end;
    }
    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER, request2, request2_len);
    if (r != 0) {
        printf("failure parsing request2\n");
        goto end;
    }
    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER, request3, request3_len);
    if (r != 0) {
        printf("failure parsing request3\n");
        goto end;
    }
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 0 ||
        state->connp[0].pfc_flags != 0x03 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 24 ||
        state->connp[0].call_id != 1 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure3\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x99fcfec4 ||
         *((uint16_t *)uuid->uuid + 2) != 0x5260 ||
         *((uint16_t *)uuid->uuid + 3) != 0x101b ||
         *((uint16_t *)uuid->uuid + 4) != 0xbbcb ||
         uuid->uuid[10] != 0x00 || uuid->uuid[11] != 0xaa ||
         uuid->uuid[12] != 0x00 || uuid->uuid[13] != 0x21 ||
         uuid->uuid[14] != 0x34 || uuid->uuid[15] != 0x7a) ||
        uuid->accepted != 1 ||
        uuid->iv != 0 ||
        uuid->context_id != 0) {
        printf("failure 3_1\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 1 ||
        tx->opnum != 5 ||
        tx->stub_len[0] != 0 ||
        tx->stub_len[1] != 0) {
        printf("failure 3_2\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x99fcfec4 ||
         *((uint16_t *)tx->iface.uuid + 2) != 0x5260 ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x101b ||
         *((uint16_t *)tx->iface.uuid + 4) != 0xbbcb ||
         tx->iface.uuid[10] != 0x00 || tx->iface.uuid[11] != 0xaa ||
         tx->iface.uuid[12] != 0x00 || tx->iface.uuid[13] != 0x21 ||
         tx->iface.uuid[14] != 0x34 || tx->iface.uuid[15] != 0x7a)) {
        printf("failure 3_3\n");
        goto end;
    }

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, response1, response1_len);
    if (r != 0) {
        printf("failure parsing response1\n");
        goto end;
    }
    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, response2, response2_len);
    if (r != 0) {
        printf("failure parsing response2\n");
        goto end;
    }
    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, response3, response3_len);
    if (r != 0) {
        printf("failure parsing response3\n");
        goto end;
    }
    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, response4, response4_len);
    if (r != 0) {
        printf("failure parsing response4\n");
        goto end;
    }
    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, response5, response5_len);
    if (r != 0) {
        printf("failure parsing response5\n");
        goto end;
    }
    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, response6, response6_len);
    if (r != 0) {
        printf("failure parsing response6\n");
        goto end;
    }
    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, response7, response7_len);
    if (r != 0) {
        printf("failure parsing response7\n");
        goto end;
    }
    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, response8, response8_len);
    if (r != 0) {
        printf("failure parsing response8\n");
        goto end;
    }
    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, response9, response9_len);
    if (r != 0) {
        printf("failure parsing response9\n");
        goto end;
    }
    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, response10, response10_len);
    if (r != 0) {
        printf("failure parsing response10\n");
        goto end;
    }
    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, response11, response11_len);
    if (r != 0) {
        printf("failure parsing response11\n");
        goto end;
    }
    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, response12, response12_len);
    if (r != 0) {
        printf("failure parsing response12\n");
        goto end;
    }
    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, response13, response13_len);
    if (r != 0) {
        printf("failure parsing response13\n");
        goto end;
    }
    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, response14, response14_len);
    if (r != 0) {
        printf("failure parsing response14\n");
        goto end;
    }
    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, response15, response15_len);
    if (r != 0) {
        printf("failure parsing response15\n");
        goto end;
    }
    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, response16, response16_len);
    if (r != 0) {
        printf("failure parsing response16\n");
        goto end;
    }
    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, response17, response17_len);
    if (r != 0) {
        printf("failure parsing response17\n");
        goto end;
    }
    if (state->connp[1].rpc_vers_minor != 0 ||
        state->connp[1].ptype != 2 ||
        state->connp[1].pfc_flags != 0x03 ||
        state->connp[1].auth_length != 0 ||
        state->connp[1].frag_length != 136 ||
        state->connp[1].call_id != 1 ||
        state->connp[1].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure4\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x99fcfec4 ||
         *((uint16_t *)uuid->uuid + 2) != 0x5260 ||
         *((uint16_t *)uuid->uuid + 3) != 0x101b ||
         *((uint16_t *)uuid->uuid + 4) != 0xbbcb ||
         uuid->uuid[10] != 0x00 || uuid->uuid[11] != 0xaa ||
         uuid->uuid[12] != 0x00 || uuid->uuid[13] != 0x21 ||
         uuid->uuid[14] != 0x34 || uuid->uuid[15] != 0x7a) ||
        uuid->accepted != 1 ||
        uuid->iv != 0 ||
        uuid->context_id != 0) {
        printf("failure 4_1\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 1 ||
        tx->opnum != 5 ||
        tx->stub_len[0] != 0 ||
        tx->stub_len[1] != 112) {
        printf("failure 4_2\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x99fcfec4 ||
         *((uint16_t *)tx->iface.uuid + 2) != 0x5260 ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x101b ||
         *((uint16_t *)tx->iface.uuid + 4) != 0xbbcb ||
         tx->iface.uuid[10] != 0x00 || tx->iface.uuid[11] != 0xaa ||
         tx->iface.uuid[12] != 0x00 || tx->iface.uuid[13] != 0x21 ||
         tx->iface.uuid[14] != 0x34 || tx->iface.uuid[15] != 0x7a)) {
        printf("failure 4_3\n");
        goto end;
    }

    result = 1;

end:
    StreamTcpFreeConfig(TRUE);
    FLOW_DESTROY(&f);
    return result;
}

/**
 * \test Same as Test01, but we send all app data as 1 byte frags(tcp frags).
 */
int DCERPCParserTest11(void)
{
    int result = 0;

    uint8_t bind[] = {
        0x05, 0x00, 0x0b, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x48, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0xd0, 0x16, 0xd0, 0x16, 0x00, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00,
        0xc4, 0xfe, 0xfc, 0x99, 0x60, 0x52, 0x1b, 0x10,
        0xbb, 0xcb, 0x00, 0xaa, 0x00, 0x21, 0x34, 0x7a,
        0x00, 0x00, 0x00, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00
    };
    uint32_t bind_len = sizeof(bind);

    uint8_t bindack[] = {
        0x05, 0x00, 0x0c, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x3c, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0xd0, 0x16, 0xd0, 0x16, 0xe4, 0x94, 0xde, 0x10,
        0x04, 0x00, 0x31, 0x33, 0x35, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00
    };
    uint32_t bindack_len = sizeof(bindack);

    /* request has no stub data */
    uint8_t request[] = {
        0x05, 0x00, 0x00, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x18, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x05, 0x00
    };
    uint32_t request_len = sizeof(request);

    uint8_t response[] = {
        0x05, 0x00, 0x02, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x88, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x70, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x05, 0x00, 0x06, 0x00, 0x50, 0xdd, 0x08, 0x00,
        0x2c, 0x00, 0x00, 0x00, 0x2c, 0x00, 0x19, 0x00,
        0x07, 0x00, 0x78, 0x00, 0x65, 0x00, 0x73, 0x00,
        0x70, 0x00, 0x72, 0x00, 0x69, 0x00, 0x31, 0x00,
        0x37, 0x00, 0x31, 0x00, 0x00, 0x00, 0x07, 0x00,
        0x34, 0x00, 0x34, 0x00, 0x2e, 0x00, 0x31, 0x00,
        0x30, 0x00, 0x2e, 0x00, 0x31, 0x00, 0x2e, 0x00,
        0x31, 0x00, 0x38, 0x00, 0x36, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x09, 0x00, 0xff, 0xff, 0x00, 0x00,
        0x10, 0x00, 0xff, 0xff, 0x00, 0x00, 0x0a, 0x00,
        0xff, 0xff, 0x00, 0x00, 0x0e, 0x00, 0xff, 0xff,
        0x00, 0x00, 0x11, 0x00, 0xff, 0xff, 0x00, 0x00,
        0x12, 0x00, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
    };
    uint32_t response_len = sizeof(response);

    DCERPCState *state;
    Flow f;
    TcpSession ssn;
    int r;
    UUID *uuid = NULL;
    DCERPCTx *tx = NULL;
    size_t i = 0;

    memset(&f, 0, sizeof(f));
    memset(&ssn, 0, sizeof(ssn));
    FLOW_INITIALIZE(&f);
    f.protoctx = (void *)&ssn;

    StreamTcpInitConfig(TRUE);

    for (i = 0; i < bind_len; i++) {
        r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER | STREAM_START, bind + i, 1);
        if (r != 0) {
            printf("failure parsing bind - %lu\n", i);
            goto end;
        }
    }
    state = f.alstate;
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 11 ||
        state->connp[0].pfc_flags != 0x03 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 72 ||
        state->connp[0].call_id != 1 ||
        state->connp[0].assoc_group_id != 0 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[0].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 0) {
        printf("failure1\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x99fcfec4 ||
         *((uint16_t *)uuid->uuid + 2) != 0x5260 ||
         *((uint16_t *)uuid->uuid + 3) != 0x101b ||
         *((uint16_t *)uuid->uuid + 4) != 0xbbcb ||
         uuid->uuid[10] != 0x00 || uuid->uuid[11] != 0xaa ||
         uuid->uuid[12] != 0x00 || uuid->uuid[13] != 0x21 ||
         uuid->uuid[14] != 0x34 || uuid->uuid[15] != 0x7a) ||
        uuid->accepted != 0 ||
        uuid->iv != 0 ||
        uuid->context_id != 0) {
        printf("failure 1_1\n");
        goto end;
    }

    for (i = 0; i < bindack_len; i++) {
        r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, bindack + i, 1);
        if (r != 0) {
            printf("failure parsing bindack - %lu\n", i);
            goto end;
        }
    }
    if (state->connp[1].rpc_vers_minor != 0 ||
        state->connp[1].ptype != 12 ||
        state->connp[1].pfc_flags != 0x03 ||
        state->connp[1].auth_length != 0 ||
        state->connp[1].frag_length != 60 ||
        state->connp[1].call_id != 1 ||
        state->connp[1].assoc_group_id != 0x10de94e4 ||
        state->connp[1].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 0) {
        printf("failure2\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x99fcfec4 ||
         *((uint16_t *)uuid->uuid + 2) != 0x5260 ||
         *((uint16_t *)uuid->uuid + 3) != 0x101b ||
         *((uint16_t *)uuid->uuid + 4) != 0xbbcb ||
         uuid->uuid[10] != 0x00 || uuid->uuid[11] != 0xaa ||
         uuid->uuid[12] != 0x00 || uuid->uuid[13] != 0x21 ||
         uuid->uuid[14] != 0x34 || uuid->uuid[15] != 0x7a) ||
        uuid->accepted != 1 ||
        uuid->iv != 0 ||
        uuid->context_id != 0) {
        printf("failure 2_1\n");
        goto end;
    }

    for (i = 0; i < request_len; i++) {
        r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER, request + i, 1);
        if (r != 0) {
            printf("failure parsing request - %lu\n", i);
            goto end;
        }
    }
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 0 ||
        state->connp[0].pfc_flags != 0x03 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 24 ||
        state->connp[0].call_id != 1 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure3\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x99fcfec4 ||
         *((uint16_t *)uuid->uuid + 2) != 0x5260 ||
         *((uint16_t *)uuid->uuid + 3) != 0x101b ||
         *((uint16_t *)uuid->uuid + 4) != 0xbbcb ||
         uuid->uuid[10] != 0x00 || uuid->uuid[11] != 0xaa ||
         uuid->uuid[12] != 0x00 || uuid->uuid[13] != 0x21 ||
         uuid->uuid[14] != 0x34 || uuid->uuid[15] != 0x7a) ||
        uuid->accepted != 1 ||
        uuid->iv != 0 ||
        uuid->context_id != 0) {
        printf("failure 3_1\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 1 ||
        tx->opnum != 5 ||
        tx->stub_len[0] != 0 ||
        tx->stub_len[1] != 0) {
        printf("failure 3_2\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x99fcfec4 ||
         *((uint16_t *)tx->iface.uuid + 2) != 0x5260 ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x101b ||
         *((uint16_t *)tx->iface.uuid + 4) != 0xbbcb ||
         tx->iface.uuid[10] != 0x00 || tx->iface.uuid[11] != 0xaa ||
         tx->iface.uuid[12] != 0x00 || tx->iface.uuid[13] != 0x21 ||
         tx->iface.uuid[14] != 0x34 || tx->iface.uuid[15] != 0x7a)) {
        printf("failure 3_3\n");
        goto end;
    }

    for (i = 0; i < response_len; i++) {
        r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, response + i, 1);
        if (r != 0) {
            printf("failure parsing response - %lu\n", i);
            goto end;
        }
    }
    if (state->connp[1].rpc_vers_minor != 0 ||
        state->connp[1].ptype != 2 ||
        state->connp[1].pfc_flags != 0x03 ||
        state->connp[1].auth_length != 0 ||
        state->connp[1].frag_length != 136 ||
        state->connp[1].call_id != 1 ||
        state->connp[1].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure4\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x99fcfec4 ||
         *((uint16_t *)uuid->uuid + 2) != 0x5260 ||
         *((uint16_t *)uuid->uuid + 3) != 0x101b ||
         *((uint16_t *)uuid->uuid + 4) != 0xbbcb ||
         uuid->uuid[10] != 0x00 || uuid->uuid[11] != 0xaa ||
         uuid->uuid[12] != 0x00 || uuid->uuid[13] != 0x21 ||
         uuid->uuid[14] != 0x34 || uuid->uuid[15] != 0x7a) ||
        uuid->accepted != 1 ||
        uuid->iv != 0 ||
        uuid->context_id != 0) {
        printf("failure 4_1\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 1 ||
        tx->opnum != 5 ||
        tx->stub_len[0] != 0 ||
        tx->stub_len[1] != 112) {
        printf("failure 4_2\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x99fcfec4 ||
         *((uint16_t *)tx->iface.uuid + 2) != 0x5260 ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x101b ||
         *((uint16_t *)tx->iface.uuid + 4) != 0xbbcb ||
         tx->iface.uuid[10] != 0x00 || tx->iface.uuid[11] != 0xaa ||
         tx->iface.uuid[12] != 0x00 || tx->iface.uuid[13] != 0x21 ||
         tx->iface.uuid[14] != 0x34 || tx->iface.uuid[15] != 0x7a)) {
        printf("failure 4_3\n");
        goto end;
    }

    result = 1;

end:
    StreamTcpFreeConfig(TRUE);
    FLOW_DESTROY(&f);
    return result;
}

/**
 * \test Same as Test02, but we send all app data as 1 byte frags(tcp frags).
 */
int DCERPCParserTest12(void)
{
    int result = 0;

    uint8_t bind[] = {
        0x05, 0x00, 0x0b, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x48, 0x00, 0x00, 0x00, 0x7f, 0x00, 0x00, 0x00,
        0xd0, 0x16, 0xd0, 0x16, 0x00, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x01, 0x00, 0x01, 0x00,
        0xa0, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0xc0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x46,
        0x00, 0x00, 0x00, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
    };
    uint32_t bind_len = sizeof(bind);

    uint8_t bindack[] = {
        0x05, 0x00, 0x0c, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x3c, 0x00, 0x00, 0x00, 0x7f, 0x00, 0x00, 0x00,
        0xd0, 0x16, 0xd0, 0x16, 0x64, 0x1c, 0x01, 0x00,
        0x04, 0x00, 0x31, 0x33, 0x35, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00,
    };
    uint32_t bindack_len = sizeof(bindack);

    uint8_t request[] = {
        0x05, 0x00, 0x00, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x38, 0x06, 0x00, 0x00, 0xe5, 0x00, 0x00, 0x00,
        0x20, 0x06, 0x00, 0x00, 0x01, 0x00, 0x04, 0x00,
        0x05, 0x00, 0x06, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x32, 0x24, 0x58, 0xfd,
        0xcc, 0x45, 0x64, 0x49, 0xb0, 0x70, 0xdd, 0xae,
        0x74, 0x2c, 0x96, 0xd2, 0x60, 0x5e, 0x0d, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x70, 0x5e, 0x0d, 0x00, 0x02, 0x00, 0x00, 0x00,
        0x7c, 0x5e, 0x0d, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x10, 0x00, 0x00, 0x00, 0x80, 0x96, 0xf1, 0xf1,
        0x2a, 0x4d, 0xce, 0x11, 0xa6, 0x6a, 0x00, 0x20,
        0xaf, 0x6e, 0x72, 0xf4, 0x0c, 0x00, 0x00, 0x00,
        0x4d, 0x41, 0x52, 0x42, 0x01, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x0d, 0xf0, 0xad, 0xba,
        0x00, 0x00, 0x00, 0x00, 0xa8, 0xf4, 0x0b, 0x00,
        0xb0, 0x05, 0x00, 0x00, 0xb0, 0x05, 0x00, 0x00,
        0x4d, 0x45, 0x4f, 0x57, 0x04, 0x00, 0x00, 0x00,
        0xa2, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0xc0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x46,
        0x38, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0xc0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x46,
        0x00, 0x00, 0x00, 0x00, 0x80, 0x05, 0x00, 0x00,
        0x78, 0x05, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x01, 0x10, 0x08, 0x00, 0xcc, 0xcc, 0xcc, 0xcc,
        0xc8, 0x00, 0x00, 0x00, 0x4d, 0x45, 0x4f, 0x57,
        0x78, 0x05, 0x00, 0x00, 0xd8, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x00, 0x00,
        0x07, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0xc4, 0x28, 0xcd, 0x00,
        0x64, 0x29, 0xcd, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x07, 0x00, 0x00, 0x00, 0xb9, 0x01, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0xc0, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x46, 0xab, 0x01, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0xc0, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x46, 0xa5, 0x01, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0xc0, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x46, 0xa6, 0x01, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0xc0, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x46, 0xa4, 0x01, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0xc0, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x46, 0xad, 0x01, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0xc0, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x46, 0xaa, 0x01, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0xc0, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x46, 0x07, 0x00, 0x00, 0x00,
        0x60, 0x00, 0x00, 0x00, 0x58, 0x00, 0x00, 0x00,
        0x90, 0x00, 0x00, 0x00, 0x40, 0x00, 0x00, 0x00,
        0x20, 0x00, 0x00, 0x00, 0xc8, 0x02, 0x00, 0x00,
        0x30, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x01, 0x10, 0x08, 0x00, 0xcc, 0xcc, 0xcc, 0xcc,
        0x50, 0x00, 0x00, 0x00, 0x4f, 0xb6, 0x88, 0x20,
        0xff, 0xff, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x01, 0x10, 0x08, 0x00, 0xcc, 0xcc, 0xcc, 0xcc,
        0x48, 0x00, 0x00, 0x00, 0x07, 0x00, 0x66, 0x00,
        0x06, 0x09, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00,
        0xc0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x46,
        0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x78, 0x19, 0x0c, 0x00,
        0x58, 0x00, 0x00, 0x00, 0x05, 0x00, 0x06, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x70, 0xd8, 0x98, 0x93,
        0x98, 0x4f, 0xd2, 0x11, 0xa9, 0x3d, 0xbe, 0x57,
        0xb2, 0x00, 0x00, 0x00, 0x32, 0x00, 0x31, 0x00,
        0x01, 0x10, 0x08, 0x00, 0xcc, 0xcc, 0xcc, 0xcc,
        0x80, 0x00, 0x00, 0x00, 0x0d, 0xf0, 0xad, 0xba,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x18, 0x43, 0x14, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x60, 0x00, 0x00, 0x00, 0x60, 0x00, 0x00, 0x00,
        0x4d, 0x45, 0x4f, 0x57, 0x04, 0x00, 0x00, 0x00,
        0xc0, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0xc0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x46,
        0x3b, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0xc0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x46,
        0x00, 0x00, 0x00, 0x00, 0x30, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x01, 0x00, 0x81, 0xc5, 0x17, 0x03,
        0x80, 0x0e, 0xe9, 0x4a, 0x99, 0x99, 0xf1, 0x8a,
        0x50, 0x6f, 0x7a, 0x85, 0x02, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x01, 0x10, 0x08, 0x00, 0xcc, 0xcc, 0xcc, 0xcc,
        0x30, 0x00, 0x00, 0x00, 0x78, 0x00, 0x6e, 0x00,
        0x00, 0x00, 0x00, 0x00, 0xd8, 0xda, 0x0d, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x20, 0x2f, 0x0c, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x03, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x03, 0x00, 0x00, 0x00,
        0x46, 0x00, 0x58, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x01, 0x10, 0x08, 0x00, 0xcc, 0xcc, 0xcc, 0xcc,
        0x10, 0x00, 0x00, 0x00, 0x30, 0x00, 0x2e, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x01, 0x10, 0x08, 0x00, 0xcc, 0xcc, 0xcc, 0xcc,
        0x68, 0x00, 0x00, 0x00, 0x0e, 0x00, 0xff, 0xff,
        0x68, 0x8b, 0x0b, 0x00, 0x02, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x4e, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x4e, 0x01, 0x00, 0x00, 0x5c, 0x00, 0x5c, 0x00,
        0x31, 0x00, 0x32, 0x00, 0x37, 0x00, 0x2e, 0x00,
        0x30, 0x00, 0x2e, 0x00, 0x30, 0x00, 0x2e, 0x00,
        0x31, 0x00, 0x5c, 0x00, 0x49, 0x00, 0x50, 0x00,
        0x43, 0x00, 0x24, 0x00, 0x5c, 0x00, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0xeb, 0x10, 0x5a, 0x4a,
        0x33, 0xc9, 0x66, 0xb9, 0x3e, 0x01, 0x80, 0x34,
        0x0a, 0x99, 0xe2, 0xfa, 0xeb, 0x05, 0xe8, 0xeb,
        0xff, 0xff, 0xff, 0x70, 0x31, 0x99, 0x99, 0x99,
        0xc3, 0x21, 0x95, 0x69, 0x64, 0xe6, 0x12, 0x99,
        0x12, 0xe9, 0x85, 0x34, 0x12, 0xd9, 0x91, 0x12,
        0x41, 0x12, 0xea, 0xa5, 0x9a, 0x6a, 0x12, 0xef,
        0xe1, 0x9a, 0x6a, 0x12, 0xe7, 0xb9, 0x9a, 0x62,
        0x12, 0xd7, 0x8d, 0xaa, 0x74, 0xcf, 0xce, 0xc8,
        0x12, 0xa6, 0x9a, 0x62, 0x12, 0x6b, 0xf3, 0x97,
        0xc0, 0x6a, 0x3f, 0xed, 0x91, 0xc0, 0xc6, 0x1a,
        0x5e, 0x9d, 0xdc, 0x7b, 0x70, 0xc0, 0xc6, 0xc7,
        0x12, 0x54, 0x12, 0xdf, 0xbd, 0x9a, 0x5a, 0x48,
        0x78, 0x9a, 0x58, 0xaa, 0x50, 0xff, 0x12, 0x91,
        0x12, 0xdf, 0x85, 0x9a, 0x5a, 0x58, 0x78, 0x9b,
        0x9a, 0x58, 0x12, 0x99, 0x9a, 0x5a, 0x12, 0x63,
        0x12, 0x6e, 0x1a, 0x5f, 0x97, 0x12, 0x49, 0xf3,
        0x9a, 0xc0, 0x71, 0xbd, 0x99, 0x99, 0x99, 0xf1,
        0x66, 0x66, 0x66, 0x99, 0xf1, 0x99, 0x89, 0x99,
        0x99, 0xf3, 0x9d, 0x66, 0xce, 0x6d, 0x22, 0x81,
        0x69, 0x64, 0xe6, 0x10, 0x9a, 0x1a, 0x5f, 0x95,
        0xaa, 0x59, 0xc9, 0xcf, 0x66, 0xce, 0x61, 0xc9,
        0x66, 0xce, 0x65, 0xaa, 0x59, 0x35, 0x1c, 0x59,
        0xec, 0x60, 0xc8, 0xcb, 0xcf, 0xca, 0x66, 0x4b,
        0xc3, 0xc0, 0x32, 0x7b, 0x77, 0xaa, 0x59, 0x5a,
        0x71, 0xca, 0x66, 0x66, 0x66, 0xde, 0xfc, 0xed,
        0xc9, 0xeb, 0xf6, 0xfa, 0xd8, 0xfd, 0xfd, 0xeb,
        0xfc, 0xea, 0xea, 0x99, 0xd1, 0xfc, 0xf8, 0xe9,
        0xda, 0xeb, 0xfc, 0xf8, 0xed, 0xfc, 0x99, 0xce,
        0xf0, 0xf7, 0xdc, 0xe1, 0xfc, 0xfa, 0x99, 0xdc,
        0xe1, 0xf0, 0xed, 0xc9, 0xeb, 0xf6, 0xfa, 0xfc,
        0xea, 0xea, 0x99, 0xfa, 0xf4, 0xfd, 0xb9, 0xb6,
        0xfa, 0xb9, 0xf7, 0xfc, 0xed, 0xb9, 0xec, 0xea,
        0xfc, 0xeb, 0xb9, 0xfc, 0xb9, 0xf8, 0xea, 0xfd,
        0xba, 0xaa, 0xab, 0xa8, 0xb9, 0xb6, 0xf8, 0xfd,
        0xfd, 0xb9, 0xbf, 0xbf, 0xb9, 0xf7, 0xfc, 0xed,
        0xb9, 0xf5, 0xf6, 0xfa, 0xf8, 0xf5, 0xfe, 0xeb,
        0xf6, 0xec, 0xe9, 0xb9, 0xf8, 0xfd, 0xf4, 0xf0,
        0xf7, 0xf0, 0xea, 0xed, 0xeb, 0xf8, 0xed, 0xf6,
        0xeb, 0xea, 0xb9, 0xfc, 0xb9, 0xb6, 0xf8, 0xfd,
        0xfd, 0x99, 0x00, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0xe9, 0xf3, 0xfd, 0xff,
        0xff, 0x45, 0x45, 0x45, 0x96, 0xb4, 0xa1, 0x77,
        0x4c, 0x14, 0x54, 0x7c, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
        0x45, 0x45, 0x45, 0x00, 0x5c, 0x00, 0x43, 0x00,
        0x24, 0x00, 0x5c, 0x00, 0x31, 0x00, 0x32, 0x00,
        0x33, 0x00, 0x34, 0x00, 0x35, 0x00, 0x36, 0x00,
        0x31, 0x00, 0x31, 0x00, 0x31, 0x00, 0x31, 0x00,
        0x31, 0x00, 0x31, 0x00, 0x31, 0x00, 0x31, 0x00,
        0x31, 0x00, 0x31, 0x00, 0x31, 0x00, 0x31, 0x00,
        0x31, 0x00, 0x31, 0x00, 0x31, 0x00, 0x2e, 0x00,
        0x64, 0x00, 0x6f, 0x00, 0x63, 0x00, 0x00, 0x00,
        0x01, 0x10, 0x08, 0x00, 0xcc, 0xcc, 0xcc, 0xcc,
        0x20, 0x00, 0x00, 0x00, 0x30, 0x00, 0x2d, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x88, 0x2a, 0x0c, 0x00,
        0x02, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x28, 0x8c, 0x0c, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x07, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    };
    uint32_t request_len = sizeof(request);

    uint8_t fault[] = {
        0x05, 0x00, 0x03, 0x23, 0x10, 0x00, 0x00, 0x00,
        0x20, 0x00, 0x00, 0x00, 0xe5, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x03, 0x00, 0x01, 0x1c, 0x00, 0x00, 0x00, 0x00,
    };
    uint32_t fault_len = sizeof(fault);

    DCERPCState *state;
    Flow f;
    TcpSession ssn;
    int r;
    UUID *uuid = NULL;
    DCERPCTx *tx = NULL;
    size_t i = 0;

    memset(&f, 0, sizeof(f));
    memset(&ssn, 0, sizeof(ssn));
    FLOW_INITIALIZE(&f);
    f.protoctx = (void *)&ssn;

    StreamTcpInitConfig(TRUE);

    for (i = 0; i < bind_len; i++) {
        r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER | STREAM_START, bind + i, 1);
        if (r != 0) {
            printf("failure parsing bind - %lu\n", i);
            goto end;
        }
    }
    state = f.alstate;
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 11 ||
        state->connp[0].pfc_flags != 0x03 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 72 ||
        state->connp[0].call_id != 127 ||
        state->connp[0].assoc_group_id != 0 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[0].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 0) {
        printf("failure1\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x000001a0 ||
         *((uint16_t *)uuid->uuid + 2) != 0x0000 ||
         *((uint16_t *)uuid->uuid + 3) != 0x0000 ||
         *((uint16_t *)uuid->uuid + 4) != 0xc000 ||
         uuid->uuid[10] != 0x00 || uuid->uuid[11] != 0x00 ||
         uuid->uuid[12] != 0x00 || uuid->uuid[13] != 0x00 ||
         uuid->uuid[14] != 0x00 || uuid->uuid[15] != 0x46) ||
        uuid->accepted != 0 ||
        uuid->iv != 0 ||
        uuid->context_id != 1) {
        printf("failure 1_1\n");
        goto end;
    }

    for (i = 0; i < bindack_len; i++) {
        r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, bindack + i, 1);
        if (r != 0) {
            printf("failure parsing bindack - %lu\n", i);
            goto end;
        }
    }
    if (state->connp[1].rpc_vers_minor != 0 ||
        state->connp[1].ptype != 12 ||
        state->connp[1].pfc_flags != 0x03 ||
        state->connp[1].auth_length != 0 ||
        state->connp[1].frag_length != 60 ||
        state->connp[1].call_id != 127 ||
        state->connp[1].assoc_group_id != 0x00011c64 ||
        state->connp[1].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 0) {
        printf("failure2\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x000001a0 ||
         *((uint16_t *)uuid->uuid + 2) != 0x0000 ||
         *((uint16_t *)uuid->uuid + 3) != 0x0000 ||
         *((uint16_t *)uuid->uuid + 4) != 0xc000 ||
         uuid->uuid[10] != 0x00 || uuid->uuid[11] != 0x00 ||
         uuid->uuid[12] != 0x00 || uuid->uuid[13] != 0x00 ||
         uuid->uuid[14] != 0x00 || uuid->uuid[15] != 0x46) ||
        uuid->accepted != 0 ||
        uuid->iv != 0 ||
        uuid->context_id != 1) {
        printf("failure 2_1\n");
        goto end;
    }

    for (i = 0; i < request_len; i++) {
        r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER, request + i, 1);
        if (r != 0) {
            printf("failure parsing request - %lu\n", i);
            goto end;
        }
    }
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 0 ||
        state->connp[0].pfc_flags != 0x03 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 1592 ||
        state->connp[0].call_id != 229 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[0].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure3\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x000001a0 ||
         *((uint16_t *)uuid->uuid + 2) != 0x0000 ||
         *((uint16_t *)uuid->uuid + 3) != 0x0000 ||
         *((uint16_t *)uuid->uuid + 4) != 0xc000 ||
         uuid->uuid[10] != 0x00 || uuid->uuid[11] != 0x00 ||
         uuid->uuid[12] != 0x00 || uuid->uuid[13] != 0x00 ||
         uuid->uuid[14] != 0x00 || uuid->uuid[15] != 0x46) ||
        uuid->accepted != 0 ||
        uuid->iv != 0 ||
        uuid->context_id != 1) {
        printf("failure 3_1\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 229 ||
        tx->opnum != 4 ||
        tx->stub_len[0] != 1568 ||
        tx->stub_len[1] != 0) {
        printf("failure 3_2\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x000001a0 ||
         *((uint16_t *)tx->iface.uuid + 2) != 0x0000 ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x0000 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0xc000 ||
         tx->iface.uuid[10] != 0x00 || tx->iface.uuid[11] != 0x00 ||
         tx->iface.uuid[12] != 0x00 || tx->iface.uuid[13] != 0x00 ||
         tx->iface.uuid[14] != 0x00 || tx->iface.uuid[15] != 0x46)) {
        printf("failure 3_3\n");
        goto end;
    }

    for (i = 0; i < fault_len; i++) {
        r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, fault + i, 1);
        if (r != 0) {
            printf("failure parsing fault - %lu\n", i);
            goto end;
        }
    }
    if (state->connp[1].rpc_vers_minor != 0 ||
        state->connp[1].ptype != 3 ||
        state->connp[1].pfc_flags != 0x23 ||
        state->connp[1].auth_length != 0 ||
        state->connp[1].frag_length != 32 ||
        state->connp[1].call_id != 229 ||
        state->connp[1].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure4\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x000001a0 ||
         *((uint16_t *)uuid->uuid + 2) != 0x0000 ||
         *((uint16_t *)uuid->uuid + 3) != 0x0000 ||
         *((uint16_t *)uuid->uuid + 4) != 0xc000 ||
         uuid->uuid[10] != 0x00 || uuid->uuid[11] != 0x00 ||
         uuid->uuid[12] != 0x00 || uuid->uuid[13] != 0x00 ||
         uuid->uuid[14] != 0x00 || uuid->uuid[15] != 0x46) ||
        uuid->accepted != 0 ||
        uuid->iv != 0 ||
        uuid->context_id != 1) {
        printf("failure 4_1\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 229 ||
        tx->opnum != 4 ||
        tx->stub_len[0] != 1568 ||
        tx->stub_len[1] != 0) {
        printf("failure 4_2\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x000001a0 ||
         *((uint16_t *)tx->iface.uuid + 2) != 0x0000 ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x0000 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0xc000 ||
         tx->iface.uuid[10] != 0x00 || tx->iface.uuid[11] != 0x00 ||
         tx->iface.uuid[12] != 0x00 || tx->iface.uuid[13] != 0x00 ||
         tx->iface.uuid[14] != 0x00 || tx->iface.uuid[15] != 0x46)) {
        printf("failure 4_3\n");
        goto end;
    }

    result = 1;

end:
    StreamTcpFreeConfig(TRUE);
    FLOW_DESTROY(&f);
    return result;
}

/**
 * \test Same as Test03, but we send all app data as 1 byte frags(tcp frags).
 */
int DCERPCParserTest13(void)
{
    int result = 0;

    uint8_t bind[] = {
        0x05, 0x00, 0x0b, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x70, 0x00, 0x20, 0x00, 0x01, 0x00, 0x00, 0x00,
        0xb8, 0x10, 0xb8, 0x10, 0x00, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00,
        0x98, 0xd0, 0xff, 0x6b, 0x12, 0xa1, 0x10, 0x36,
        0x98, 0x33, 0x46, 0xc3, 0xf8, 0x7e, 0x34, 0x5a,
        0x01, 0x00, 0x00, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
        0x0a, 0x06, 0x00, 0x00, 0x7f, 0x35, 0x01, 0x00,
        0x4e, 0x54, 0x4c, 0x4d, 0x53, 0x53, 0x50, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x31, 0x02, 0x00, 0x60,
        0x00, 0x00, 0x00, 0x00, 0x20, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x20, 0x00, 0x00, 0x00
    };
    uint32_t bind_len = sizeof(bind);

    uint8_t bindack[] = {
        0x05, 0x00, 0x0c, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x74, 0x00, 0x30, 0x00, 0x01, 0x00, 0x00, 0x00,
        0xb8, 0x10, 0xb8, 0x10, 0x7f, 0xa8, 0x00, 0x00,
        0x05, 0x00, 0x31, 0x30, 0x32, 0x35, 0x00, 0x01,
        0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00, 0x0a, 0x06, 0x00, 0x00,
        0x7f, 0x35, 0x01, 0x00, 0x4e, 0x54, 0x4c, 0x4d,
        0x53, 0x53, 0x50, 0x00, 0x02, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x30, 0x00, 0x00, 0x00,
        0x31, 0x02, 0x00, 0x60, 0x27, 0x0b, 0xdb, 0x2f,
        0x5c, 0x27, 0x4c, 0xff, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x30, 0x00, 0x00, 0x00
    };
    uint32_t bindack_len = sizeof(bindack);

    uint8_t auth3[] = {
        0x05, 0x00, 0x10, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x70, 0x00, 0x58, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x0a, 0x06, 0x00, 0x00, 0x7f, 0x35, 0x01, 0x00,
        0x4e, 0x54, 0x4c, 0x4d, 0x53, 0x53, 0x50, 0x00,
        0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x48, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x48, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x40, 0x00, 0x00, 0x00, 0x08, 0x00, 0x08, 0x00,
        0x40, 0x00, 0x00, 0x00, 0x10, 0x00, 0x10, 0x00,
        0x48, 0x00, 0x00, 0x00, 0x31, 0x02, 0x00, 0x60,
        0x4e, 0x00, 0x55, 0x00, 0x4c, 0x00, 0x4c, 0x00,
        0x9f, 0x59, 0xc8, 0x00, 0xe2, 0x76, 0x1c, 0x7b,
        0xcb, 0x47, 0x5f, 0x26, 0x16, 0x2f, 0xd3, 0x2c
    };
    uint32_t auth3_len = sizeof(auth3);

    DCERPCState *state;
    Flow f;
    TcpSession ssn;
    int r;
    UUID *uuid = NULL;
    size_t i = 0;

    memset(&f, 0, sizeof(f));
    memset(&ssn, 0, sizeof(ssn));
    FLOW_INITIALIZE(&f);
    f.protoctx = (void *)&ssn;

    StreamTcpInitConfig(TRUE);

    for (i = 0; i < bind_len; i++) {
        r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER | STREAM_START, bind + i, 1);
        if (r != 0) {
            printf("failure parsing bind - %lu\n", i);
            goto end;
        }
    }
    state = f.alstate;
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 11 ||
        state->connp[0].pfc_flags != 0x03 ||
        state->connp[0].auth_length != 32 ||
        state->connp[0].frag_length != 112 ||
        state->connp[0].call_id != 1 ||
        state->connp[0].assoc_group_id != 0 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[0].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 0) {
        printf("failure1\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x6bffd098 ||
         *((uint16_t *)uuid->uuid + 2) != 0xa112 ||
         *((uint16_t *)uuid->uuid + 3) != 0x3610 ||
         *((uint16_t *)uuid->uuid + 4) != 0x9833 ||
         uuid->uuid[10] != 0x46 || uuid->uuid[11] != 0xc3 ||
         uuid->uuid[12] != 0xf8 || uuid->uuid[13] != 0x7e ||
         uuid->uuid[14] != 0x34 || uuid->uuid[15] != 0x5a) ||
        uuid->accepted != 0 ||
        uuid->iv != 1 ||
        uuid->context_id != 0) {
        printf("failure 1_1\n");
        goto end;
    }

    for (i = 0; i < bindack_len; i++) {
        r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, bindack + i, 1);
        if (r != 0) {
            printf("failure parsing bindack - %lu\n", i);
            goto end;
        }
    }
    if (state->connp[1].rpc_vers_minor != 0 ||
        state->connp[1].ptype != 12 ||
        state->connp[1].pfc_flags != 0x03 ||
        state->connp[1].auth_length != 48 ||
        state->connp[1].frag_length != 116 ||
        state->connp[1].call_id != 1 ||
        state->connp[1].assoc_group_id != 0x0000a87f ||
        state->connp[1].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0) {
        printf("failure2\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x6bffd098 ||
         *((uint16_t *)uuid->uuid + 2) != 0xa112 ||
         *((uint16_t *)uuid->uuid + 3) != 0x3610 ||
         *((uint16_t *)uuid->uuid + 4) != 0x9833 ||
         uuid->uuid[10] != 0x46 || uuid->uuid[11] != 0xc3 ||
         uuid->uuid[12] != 0xf8 || uuid->uuid[13] != 0x7e ||
         uuid->uuid[14] != 0x34 || uuid->uuid[15] != 0x5a) ||
        uuid->accepted != 1 ||
        uuid->iv != 1 ||
        uuid->context_id != 0) {
        printf("failure 2_1\n");
        goto end;
    }

    for (i = 0; i < auth3_len; i++) {
        r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER, auth3 + i, 1);
        if (r != 0) {
            printf("failure parsing auth3 - %lu\n", i);
            goto end;
        }
    }
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 16 ||
        state->connp[0].pfc_flags != 0x03 ||
        state->connp[0].auth_length != 88 ||
        state->connp[0].frag_length != 112 ||
        state->connp[0].call_id != 1 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[0].pdu_bytes_processed != 0) {
        printf("failure3\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x6bffd098 ||
         *((uint16_t *)uuid->uuid + 2) != 0xa112 ||
         *((uint16_t *)uuid->uuid + 3) != 0x3610 ||
         *((uint16_t *)uuid->uuid + 4) != 0x9833 ||
         uuid->uuid[10] != 0x46 || uuid->uuid[11] != 0xc3 ||
         uuid->uuid[12] != 0xf8 || uuid->uuid[13] != 0x7e ||
         uuid->uuid[14] != 0x34 || uuid->uuid[15] != 0x5a) ||
        uuid->accepted != 1 ||
        uuid->iv != 1 ||
        uuid->context_id != 0) {
        printf("failure 3_1\n");
        goto end;
    }

    result = 1;

end:
    StreamTcpFreeConfig(TRUE);
    FLOW_DESTROY(&f);
    return result;
}

/**
 * \test Same as Test04, but we send all app data as 1 byte frags(tcp frags).
 */
int DCERPCParserTest14(void)
{
    int result = 0;

    uint8_t bind[] = {
        0x05, 0x00, 0x0b, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x48, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0xd0, 0x16, 0xd0, 0x16, 0x00, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00,
        0x40, 0xfd, 0x2c, 0x34, 0x6c, 0x3c, 0xce, 0x11,
        0xa8, 0x93, 0x08, 0x00, 0x2b, 0x2e, 0x9c, 0x6d,
        0x00, 0x00, 0x00, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
    };
    uint32_t bind_len = sizeof(bind);

    uint8_t bindack[] = {
        0x05, 0x00, 0x0c, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x44, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0xb8, 0x10, 0xb8, 0x10, 0x7d, 0xd8, 0x00, 0x00,
        0x0d, 0x00, 0x5c, 0x70, 0x69, 0x70, 0x65, 0x5c,
        0x6c, 0x6c, 0x73, 0x72, 0x70, 0x63, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00,
    };
    uint32_t bindack_len = sizeof(bindack);

    uint8_t request[] = {
        0x05, 0x00, 0x00, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x38, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x20, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x09, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x09, 0x00, 0x00, 0x00, 0x47, 0x00, 0x41, 0x00,
        0x52, 0x00, 0x4c, 0x00, 0x4f, 0x00, 0x41, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
    };
    uint32_t request_len = sizeof(request);

    uint8_t response[] = {
        0x05, 0x00, 0x02, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x30, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x18, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x07, 0x9f, 0x13, 0xd9,
        0x2d, 0x97, 0xf4, 0x4a, 0xac, 0xc2, 0xbc, 0x70,
        0xec, 0xaa, 0x9a, 0xd3, 0x00, 0x00, 0x00, 0x00,
    };
    uint32_t response_len = sizeof(response);

    uint8_t alter_context[] = {
        0x05, 0x00, 0x0e, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x48, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0xd0, 0x16, 0xd0, 0x16, 0x00, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x01, 0x00, 0x01, 0x00,
        0xd0, 0x4c, 0x67, 0x57, 0x00, 0x52, 0xce, 0x11,
        0xa8, 0x97, 0x08, 0x00, 0x2b, 0x2e, 0x9c, 0x6d,
        0x01, 0x00, 0x00, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
    };
    uint32_t alter_context_len = sizeof(alter_context);

    uint8_t alter_context_resp[] = {
        0x05, 0x00, 0x0f, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x38, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0xb8, 0x10, 0xb8, 0x10, 0x7d, 0xd8, 0x00, 0x00,
        0x00, 0x00, 0x08, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
    };
    uint32_t alter_context_resp_len = sizeof(alter_context_resp);

    DCERPCState *state;
    Flow f;
    TcpSession ssn;
    int r;
    UUID *uuid = NULL;
    DCERPCTx *tx = NULL;
    size_t i = 0;

    memset(&f, 0, sizeof(f));
    memset(&ssn, 0, sizeof(ssn));
    FLOW_INITIALIZE(&f);
    f.protoctx = (void *)&ssn;

    StreamTcpInitConfig(TRUE);

    for (i = 0; i < bind_len; i++) {
        r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER | STREAM_START, bind + i, 1);
        if (r != 0) {
            printf("failure parsing bind - %lu\n", i);
            goto end;
        }
    }
    state = f.alstate;
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 11 ||
        state->connp[0].pfc_flags != 0x03 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 72 ||
        state->connp[0].call_id != 1 ||
        state->connp[0].assoc_group_id != 0 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[0].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 0) {
        printf("failure1\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x342cfd40 ||
         *((uint16_t *)uuid->uuid + 2) != 0x3c6c ||
         *((uint16_t *)uuid->uuid + 3) != 0x11ce ||
         *((uint16_t *)uuid->uuid + 4) != 0xa893 ||
         uuid->uuid[10] != 0x08 || uuid->uuid[11] != 0x00 ||
         uuid->uuid[12] != 0x2b || uuid->uuid[13] != 0x2e ||
         uuid->uuid[14] != 0x9c || uuid->uuid[15] != 0x6d) ||
        uuid->accepted != 0 ||
        uuid->iv != 0 ||
        uuid->context_id != 0) {
        printf("failure 1_1\n");
        goto end;
    }

    for (i = 0; i < bindack_len; i++) {
        r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, bindack + i, 1);
        if (r != 0) {
            printf("failure parsing bindack - %lu\n", i);
            goto end;
        }
    }
    if (state->connp[1].rpc_vers_minor != 0 ||
        state->connp[1].ptype != 12 ||
        state->connp[1].pfc_flags != 0x03 ||
        state->connp[1].auth_length != 0 ||
        state->connp[1].frag_length != 68 ||
        state->connp[1].call_id != 1 ||
        state->connp[1].assoc_group_id != 0x0000d87d ||
        state->connp[1].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 0) {
        printf("failure2\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x342cfd40 ||
         *((uint16_t *)uuid->uuid + 2) != 0x3c6c ||
         *((uint16_t *)uuid->uuid + 3) != 0x11ce ||
         *((uint16_t *)uuid->uuid + 4) != 0xa893 ||
         uuid->uuid[10] != 0x08 || uuid->uuid[11] != 0x00 ||
         uuid->uuid[12] != 0x2b || uuid->uuid[13] != 0x2e ||
         uuid->uuid[14] != 0x9c || uuid->uuid[15] != 0x6d) ||
        uuid->accepted != 1 ||
        uuid->iv != 0 ||
        uuid->context_id != 0) {
        printf("failure 2_1\n");
        goto end;
    }

    for (i = 0; i < request_len; i++) {
        r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER, request + i, 1);
        if (r != 0) {
            printf("failure parsing request - %lu\n", i);
            goto end;
        }
    }
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 0 ||
        state->connp[0].pfc_flags != 0x03 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 56 ||
        state->connp[0].call_id != 1 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[0].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure3\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x342cfd40 ||
         *((uint16_t *)uuid->uuid + 2) != 0x3c6c ||
         *((uint16_t *)uuid->uuid + 3) != 0x11ce ||
         *((uint16_t *)uuid->uuid + 4) != 0xa893 ||
         uuid->uuid[10] != 0x08 || uuid->uuid[11] != 0x00 ||
         uuid->uuid[12] != 0x2b || uuid->uuid[13] != 0x2e ||
         uuid->uuid[14] != 0x9c || uuid->uuid[15] != 0x6d) ||
        uuid->accepted != 1 ||
        uuid->iv != 0 ||
        uuid->context_id != 0) {
        printf("failure 3_1\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 1 ||
        tx->opnum != 0 ||
        tx->stub_len[0] != 32 ||
        tx->stub_len[1] != 0) {
        printf("failure 3_2\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x342cfd40 ||
         *((uint16_t *)tx->iface.uuid + 2) != 0x3c6c ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x11ce ||
         *((uint16_t *)tx->iface.uuid + 4) != 0xa893 ||
         tx->iface.uuid[10] != 0x08 || tx->iface.uuid[11] != 0x00 ||
         tx->iface.uuid[12] != 0x2b || tx->iface.uuid[13] != 0x2e ||
         tx->iface.uuid[14] != 0x9c || tx->iface.uuid[15] != 0x6d)) {
        printf("failure 3_3\n");
        goto end;
    }

    for (i = 0; i < response_len; i++) {
        r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, response + i, 1);
        if (r != 0) {
            printf("failure parsing response\n");
            goto end;
        }
    }
    if (state->connp[1].rpc_vers_minor != 0 ||
        state->connp[1].ptype != 2 ||
        state->connp[1].pfc_flags != 0x03 ||
        state->connp[1].auth_length != 0 ||
        state->connp[1].frag_length != 48 ||
        state->connp[1].call_id != 1 ||
        state->connp[1].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure4\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x342cfd40 ||
         *((uint16_t *)uuid->uuid + 2) != 0x3c6c ||
         *((uint16_t *)uuid->uuid + 3) != 0x11ce ||
         *((uint16_t *)uuid->uuid + 4) != 0xa893 ||
         uuid->uuid[10] != 0x08 || uuid->uuid[11] != 0x00 ||
         uuid->uuid[12] != 0x2b || uuid->uuid[13] != 0x2e ||
         uuid->uuid[14] != 0x9c || uuid->uuid[15] != 0x6d) ||
        uuid->accepted != 1 ||
        uuid->iv != 0 ||
        uuid->context_id != 0) {
        printf("failure 4_1\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 1 ||
        tx->opnum != 0 ||
        tx->stub_len[0] != 32 ||
        tx->stub_len[1] != 24) {
        printf("failure 4_2\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x342cfd40 ||
         *((uint16_t *)tx->iface.uuid + 2) != 0x3c6c ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x11ce ||
         *((uint16_t *)tx->iface.uuid + 4) != 0xa893 ||
         tx->iface.uuid[10] != 0x08 || tx->iface.uuid[11] != 0x00 ||
         tx->iface.uuid[12] != 0x2b || tx->iface.uuid[13] != 0x2e ||
         tx->iface.uuid[14] != 0x9c || tx->iface.uuid[15] != 0x6d)) {
        printf("failure 4_3\n");
        goto end;
    }

    for (i = 0; i < alter_context_len; i++) {
        r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER, alter_context + i, 1);
        if (r != 0) {
            printf("failure parsing alter_context - %lu\n", i);
            goto end;
        }
    }
    state = f.alstate;
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 14 ||
        state->connp[0].pfc_flags != 0x03 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 72 ||
        state->connp[0].call_id != 1 ||
        state->connp[0].assoc_group_id != 0 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[0].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure5\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x57674cd0 ||
         *((uint16_t *)uuid->uuid + 2) != 0x5200 ||
         *((uint16_t *)uuid->uuid + 3) != 0x11ce ||
         *((uint16_t *)uuid->uuid + 4) != 0xa897 ||
         uuid->uuid[10] != 0x08 || uuid->uuid[11] != 0x00 ||
         uuid->uuid[12] != 0x2b || uuid->uuid[13] != 0x2e ||
         uuid->uuid[14] != 0x9c || uuid->uuid[15] != 0x6d) ||
        uuid->accepted != 0 ||
        uuid->iv != 1 ||
        uuid->context_id != 1) {
        printf("failure 5_1\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 1 ||
        tx->opnum != 0 ||
        tx->stub_len[0] != 32 ||
        tx->stub_len[1] != 24) {
        printf("failure 5_2\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x342cfd40 ||
         *((uint16_t *)tx->iface.uuid + 2) != 0x3c6c ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x11ce ||
         *((uint16_t *)tx->iface.uuid + 4) != 0xa893 ||
         tx->iface.uuid[10] != 0x08 || tx->iface.uuid[11] != 0x00 ||
         tx->iface.uuid[12] != 0x2b || tx->iface.uuid[13] != 0x2e ||
         tx->iface.uuid[14] != 0x9c || tx->iface.uuid[15] != 0x6d)) {
        printf("failure 5_3\n");
        goto end;
    }

    for (i = 0; i < alter_context_resp_len; i++) {
        r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, alter_context_resp + i, 1);
        if (r != 0) {
            printf("failure parsing alter_context_resp - %lu\n", i);
            goto end;
        }
    }
    if (state->connp[1].rpc_vers_minor != 0 ||
        state->connp[1].ptype != 15 ||
        state->connp[1].pfc_flags != 0x03 ||
        state->connp[1].auth_length != 0 ||
        state->connp[1].frag_length != 56 ||
        state->connp[1].call_id != 1 ||
        state->connp[1].assoc_group_id != 0x0000d87d ||
        state->connp[1].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure6\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x57674cd0 ||
         *((uint16_t *)uuid->uuid + 2) != 0x5200 ||
         *((uint16_t *)uuid->uuid + 3) != 0x11ce ||
         *((uint16_t *)uuid->uuid + 4) != 0xa897 ||
         uuid->uuid[10] != 0x08 || uuid->uuid[11] != 0x00 ||
         uuid->uuid[12] != 0x2b || uuid->uuid[13] != 0x2e ||
         uuid->uuid[14] != 0x9c || uuid->uuid[15] != 0x6d) ||
        uuid->accepted != 1 ||
        uuid->iv != 1 ||
        uuid->context_id != 1) {
        printf("failure 6_1\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 1 ||
        tx->opnum != 0 ||
        tx->stub_len[0] != 32 ||
        tx->stub_len[1] != 24) {
        printf("failure 6_2\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x342cfd40 ||
         *((uint16_t *)tx->iface.uuid + 2) != 0x3c6c ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x11ce ||
         *((uint16_t *)tx->iface.uuid + 4) != 0xa893 ||
         tx->iface.uuid[10] != 0x08 || tx->iface.uuid[11] != 0x00 ||
         tx->iface.uuid[12] != 0x2b || tx->iface.uuid[13] != 0x2e ||
         tx->iface.uuid[14] != 0x9c || tx->iface.uuid[15] != 0x6d)) {
        printf("failure 6_3\n");
        goto end;
    }

    result = 1;

end:
    StreamTcpFreeConfig(TRUE);
    FLOW_DESTROY(&f);
    return result;
}

/**
 * \test Same as Test05, but we send all app data as 1 byte frags(tcp frags).
 */
int DCERPCParserTest15(void)
{
    int result = 0;

    uint8_t bind1[] = {
        0x05, 0x00, 0x0b, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x48, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0xb8, 0x10, 0xb8, 0x10, 0x00, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00,
        0x98, 0xd0, 0xff, 0x6b, 0x12, 0xa1, 0x10, 0x36,
        0x98, 0x33, 0x46, 0xc3, 0xf8, 0x7e, 0x34, 0x5a,
        0x01, 0x00, 0x00, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
    };
    uint32_t bind1_len = sizeof(bind1);

    uint8_t bindack1[] = {
        0x05, 0x00, 0x0c, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x44, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0xb8, 0x10, 0xb8, 0x10, 0x56, 0x47, 0x00, 0x00,
        0x0d, 0x00, 0x5c, 0x50, 0x49, 0x50, 0x45, 0x5c,
        0x77, 0x6b, 0x73, 0x73, 0x76, 0x63, 0x00, 0xff,
        0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00
    };
    uint32_t bindack1_len = sizeof(bindack1);

    uint8_t request1[] = {
        0x05, 0x00, 0x00, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x4c, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x34, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0xb0, 0xe2, 0xe3, 0x00, 0x10, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00,
        0x5c, 0x00, 0x5c, 0x00, 0x36, 0x00, 0x34, 0x00,
        0x2e, 0x00, 0x31, 0x00, 0x30, 0x00, 0x31, 0x00,
        0x2e, 0x00, 0x31, 0x00, 0x38, 0x00, 0x32, 0x00,
        0x2e, 0x00, 0x39, 0x00, 0x30, 0x00, 0x00, 0x00,
        0x64, 0x00, 0x00, 0x00,
    };
    uint32_t request1_len = sizeof(request1);

    uint8_t response1[] = {
        0x05, 0x00, 0x02, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x78, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x60, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x64, 0x00, 0x00, 0x00, 0xb8, 0x0f, 0x16, 0x00,
        0xf4, 0x01, 0x00, 0x00, 0xe6, 0x0f, 0x16, 0x00,
        0xd2, 0x0f, 0x16, 0x00, 0x05, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x0a, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x0a, 0x00, 0x00, 0x00,
        0x53, 0x00, 0x45, 0x00, 0x52, 0x00, 0x56, 0x00,
        0x49, 0x00, 0x43, 0x00, 0x45, 0x00, 0x50, 0x00,
        0x43, 0x00, 0x00, 0x00, 0x0a, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x0a, 0x00, 0x00, 0x00,
        0x57, 0x00, 0x4f, 0x00, 0x52, 0x00, 0x4b, 0x00,
        0x47, 0x00, 0x52, 0x00, 0x4f, 0x00, 0x55, 0x00,
        0x50, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    };
    uint32_t response1_len = sizeof(response1);


    uint8_t bind2[] = {
        0x05, 0x00, 0x0b, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x48, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0xb8, 0x10, 0xb8, 0x10, 0x00, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00,
        0xc8, 0x4f, 0x32, 0x4b, 0x70, 0x16, 0xd3, 0x01,
        0x12, 0x78, 0x5a, 0x47, 0xbf, 0x6e, 0xe1, 0x88,
        0x03, 0x00, 0x00, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00
    };
    uint32_t bind2_len = sizeof(bind2);

    uint8_t bindack2[] = {
        0x05, 0x00, 0x0c, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x44, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0xb8, 0x10, 0xb8, 0x10, 0x57, 0x47, 0x00, 0x00,
        0x0d, 0x00, 0x5c, 0x50, 0x49, 0x50, 0x45, 0x5c,
        0x73, 0x72, 0x76, 0x73, 0x76, 0x63, 0x00, 0xff,
        0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00,
    };
    uint32_t bindack2_len = sizeof(bindack2);

    uint8_t request2[] = {
        0x05, 0x00, 0x00, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x4c, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x34, 0x00, 0x00, 0x00, 0x00, 0x00, 0x15, 0x00,
        0xb0, 0xe2, 0xe3, 0x00, 0x10, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00,
        0x5c, 0x00, 0x5c, 0x00, 0x36, 0x00, 0x34, 0x00,
        0x2e, 0x00, 0x31, 0x00, 0x30, 0x00, 0x31, 0x00,
        0x2e, 0x00, 0x31, 0x00, 0x38, 0x00, 0x32, 0x00,
        0x2e, 0x00, 0x39, 0x00, 0x30, 0x00, 0x00, 0x00,
        0x65, 0x00, 0x00, 0x00,
    };
    uint32_t request2_len = sizeof(request2);

    uint8_t response2[] = {
        0x05, 0x00, 0x02, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x74, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x5c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x65, 0x00, 0x00, 0x00, 0x68, 0x3d, 0x14, 0x00,
        0xf4, 0x01, 0x00, 0x00, 0x80, 0x3d, 0x14, 0x00,
        0x05, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x03, 0x10, 0x05, 0x00, 0x9c, 0x3d, 0x14, 0x00,
        0x0e, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x0e, 0x00, 0x00, 0x00, 0x31, 0x00, 0x39, 0x00,
        0x32, 0x00, 0x2e, 0x00, 0x31, 0x00, 0x36, 0x00,
        0x38, 0x00, 0x2e, 0x00, 0x32, 0x00, 0x2e, 0x00,
        0x31, 0x00, 0x30, 0x00, 0x33, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x55, 0x00,
        0x00, 0x00, 0x00, 0x00,
    };
    uint32_t response2_len = sizeof(response2);


    DCERPCState *state;
    Flow f;
    TcpSession ssn;
    int r;
    UUID *uuid = NULL;
    DCERPCTx *tx = NULL;
    size_t i = 0;

    memset(&f, 0, sizeof(f));
    memset(&ssn, 0, sizeof(ssn));
    FLOW_INITIALIZE(&f);
    f.protoctx = (void *)&ssn;

    StreamTcpInitConfig(TRUE);

    for (i = 0; i < bind1_len; i++) {
        r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER | STREAM_START, bind1 + i, 1);
        if (r != 0) {
            printf("failure parsing bind1 - %lu\n", i);
            goto end;
        }
    }
    state = f.alstate;
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 11 ||
        state->connp[0].pfc_flags != 0x03 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 72 ||
        state->connp[0].call_id != 1 ||
        state->connp[0].assoc_group_id != 0 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[0].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 0) {
        printf("failure1\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x6bffd098 ||
         *((uint16_t *)uuid->uuid + 2) != 0xa112 ||
         *((uint16_t *)uuid->uuid + 3) != 0x3610 ||
         *((uint16_t *)uuid->uuid + 4) != 0x9833 ||
         uuid->uuid[10] != 0x46 || uuid->uuid[11] != 0xc3 ||
         uuid->uuid[12] != 0xf8 || uuid->uuid[13] != 0x7e ||
         uuid->uuid[14] != 0x34 || uuid->uuid[15] != 0x5a) ||
        uuid->accepted != 0 ||
        uuid->iv != 1 ||
        uuid->context_id != 0) {
        printf("failure 1_1\n");
        goto end;
    }

    for (i = 0; i < bindack1_len; i++) {
        r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, bindack1 + i, 1);
        if (r != 0) {
            printf("failure parsing bindack1 - %lu\n", i);
            goto end;
        }
    }
    if (state->connp[1].rpc_vers_minor != 0 ||
        state->connp[1].ptype != 12 ||
        state->connp[1].pfc_flags != 0x03 ||
        state->connp[1].auth_length != 0 ||
        state->connp[1].frag_length != 68 ||
        state->connp[1].call_id != 1 ||
        state->connp[1].assoc_group_id != 0x00004756 ||
        state->connp[1].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 0) {
        printf("failure2\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x6bffd098 ||
         *((uint16_t *)uuid->uuid + 2) != 0xa112 ||
         *((uint16_t *)uuid->uuid + 3) != 0x3610 ||
         *((uint16_t *)uuid->uuid + 4) != 0x9833 ||
         uuid->uuid[10] != 0x46 || uuid->uuid[11] != 0xc3 ||
         uuid->uuid[12] != 0xf8 || uuid->uuid[13] != 0x7e ||
         uuid->uuid[14] != 0x34 || uuid->uuid[15] != 0x5a) ||
        uuid->accepted != 1 ||
        uuid->iv != 1 ||
        uuid->context_id != 0) {
        printf("failure 2_1\n");
        goto end;
    }

    for (i = 0; i < request1_len; i++) {
        r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER, request1 + i, 1);
        if (r != 0) {
            printf("failure parsing request1 - %lu\n", i);
            goto end;
        }
    }
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 0 ||
        state->connp[0].pfc_flags != 0x03 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 76 ||
        state->connp[0].call_id != 1 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[0].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure3\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x6bffd098 ||
         *((uint16_t *)uuid->uuid + 2) != 0xa112 ||
         *((uint16_t *)uuid->uuid + 3) != 0x3610 ||
         *((uint16_t *)uuid->uuid + 4) != 0x9833 ||
         uuid->uuid[10] != 0x46 || uuid->uuid[11] != 0xc3 ||
         uuid->uuid[12] != 0xf8 || uuid->uuid[13] != 0x7e ||
         uuid->uuid[14] != 0x34 || uuid->uuid[15] != 0x5a) ||
        uuid->accepted != 1 ||
        uuid->iv != 1 ||
        uuid->context_id != 0) {
        printf("failure 3_1\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 1 ||
        tx->opnum != 0 ||
        tx->stub_len[0] != 52 ||
        tx->stub_len[1] != 0) {
        printf("failure 3_2\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x6bffd098 ||
         *((uint16_t *)tx->iface.uuid + 2) != 0xa112 ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x3610 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0x9833 ||
         tx->iface.uuid[10] != 0x46 || tx->iface.uuid[11] != 0xc3 ||
         tx->iface.uuid[12] != 0xf8 || tx->iface.uuid[13] != 0x7e ||
         tx->iface.uuid[14] != 0x34 || tx->iface.uuid[15] != 0x5a)) {
        printf("failure 3_3\n");
        goto end;
    }

    for (i = 0; i < response1_len; i++) {
        r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, response1 + i, 1);
        if (r != 0) {
            printf("failure parsing response1 - %lu\n", i);
            goto end;
        }
    }
    if (state->connp[1].rpc_vers_minor != 0 ||
        state->connp[1].ptype != 2 ||
        state->connp[1].pfc_flags != 0x03 ||
        state->connp[1].auth_length != 0 ||
        state->connp[1].frag_length != 120 ||
        state->connp[1].call_id != 1 ||
        state->connp[1].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure4\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x6bffd098 ||
         *((uint16_t *)uuid->uuid + 2) != 0xa112 ||
         *((uint16_t *)uuid->uuid + 3) != 0x3610 ||
         *((uint16_t *)uuid->uuid + 4) != 0x9833 ||
         uuid->uuid[10] != 0x46 || uuid->uuid[11] != 0xc3 ||
         uuid->uuid[12] != 0xf8 || uuid->uuid[13] != 0x7e ||
         uuid->uuid[14] != 0x34 || uuid->uuid[15] != 0x5a) ||
        uuid->accepted != 1 ||
        uuid->iv != 1 ||
        uuid->context_id != 0) {
        printf("failure 4_1\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 1 ||
        tx->opnum != 0 ||
        tx->stub_len[0] != 52 ||
        tx->stub_len[1] != 96) {
        printf("failure 4_2\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x6bffd098 ||
         *((uint16_t *)tx->iface.uuid + 2) != 0xa112 ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x3610 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0x9833 ||
         tx->iface.uuid[10] != 0x46 || tx->iface.uuid[11] != 0xc3 ||
         tx->iface.uuid[12] != 0xf8 || tx->iface.uuid[13] != 0x7e ||
         tx->iface.uuid[14] != 0x34 || tx->iface.uuid[15] != 0x5a)) {
        printf("failure 4_3\n");
        goto end;
    }

    for (i = 0; i < bind2_len; i++) {
        r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER, bind2 + i, 1);
        if (r != 0) {
            printf("failure parsing bind2 - %lu\n", i);
            goto end;
        }
    }
    state = f.alstate;
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 11 ||
        state->connp[0].pfc_flags != 0x03 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 72 ||
        state->connp[0].call_id != 1 ||
        state->connp[0].assoc_group_id != 0 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[0].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure5\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x4b324fc8 ||
         *((uint16_t *)uuid->uuid + 2) != 0x1670 ||
         *((uint16_t *)uuid->uuid + 3) != 0x01d3 ||
         *((uint16_t *)uuid->uuid + 4) != 0x1278 ||
         uuid->uuid[10] != 0x5a || uuid->uuid[11] != 0x47 ||
         uuid->uuid[12] != 0xbf || uuid->uuid[13] != 0x6e ||
         uuid->uuid[14] != 0xe1 || uuid->uuid[15] != 0x88) ||
        uuid->accepted != 0 ||
        uuid->iv != 3 ||
        uuid->context_id != 0) {
        printf("failure 5_1\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 1 ||
        tx->opnum != 0 ||
        tx->stub_len[0] != 52 ||
        tx->stub_len[1] != 96) {
        printf("failure 5_2\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x6bffd098 ||
         *((uint16_t *)tx->iface.uuid + 2) != 0xa112 ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x3610 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0x9833 ||
         tx->iface.uuid[10] != 0x46 || tx->iface.uuid[11] != 0xc3 ||
         tx->iface.uuid[12] != 0xf8 || tx->iface.uuid[13] != 0x7e ||
         tx->iface.uuid[14] != 0x34 || tx->iface.uuid[15] != 0x5a)) {
        printf("failure 5_3\n");
        goto end;
    }

    for (i = 0; i < bindack2_len; i++) {
        r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, bindack2 + i, 1);
        if (r != 0) {
            printf("failure parsing bindack2 - %lu\n", i);
            goto end;
        }
    }
    if (state->connp[1].rpc_vers_minor != 0 ||
        state->connp[1].ptype != 12 ||
        state->connp[1].pfc_flags != 0x03 ||
        state->connp[1].auth_length != 0 ||
        state->connp[1].frag_length != 68 ||
        state->connp[1].call_id != 1 ||
        state->connp[1].assoc_group_id != 0x00004757 ||
        state->connp[1].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure6\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x4b324fc8 ||
         *((uint16_t *)uuid->uuid + 2) != 0x1670 ||
         *((uint16_t *)uuid->uuid + 3) != 0x01d3 ||
         *((uint16_t *)uuid->uuid + 4) != 0x1278 ||
         uuid->uuid[10] != 0x5a || uuid->uuid[11] != 0x47 ||
         uuid->uuid[12] != 0xbf || uuid->uuid[13] != 0x6e ||
         uuid->uuid[14] != 0xe1 || uuid->uuid[15] != 0x88) ||
        uuid->accepted != 1 ||
        uuid->iv != 3 ||
        uuid->context_id != 0) {
        printf("failure 6_1\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 1 ||
        tx->opnum != 0 ||
        tx->stub_len[0] != 52 ||
        tx->stub_len[1] != 96) {
        printf("failure 6_2\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x6bffd098 ||
         *((uint16_t *)tx->iface.uuid + 2) != 0xa112 ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x3610 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0x9833 ||
         tx->iface.uuid[10] != 0x46 || tx->iface.uuid[11] != 0xc3 ||
         tx->iface.uuid[12] != 0xf8 || tx->iface.uuid[13] != 0x7e ||
         tx->iface.uuid[14] != 0x34 || tx->iface.uuid[15] != 0x5a)) {
        printf("failure 6_3\n");
        goto end;
    }

    for (i = 0; i < request2_len; i++) {
        r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER, request2 + i, 1);
        if (r != 0) {
            printf("failure parsing request2 - %lu\n", i);
            goto end;
        }
    }
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 0 ||
        state->connp[0].pfc_flags != 0x03 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 76 ||
        state->connp[0].call_id != 1 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[0].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 2) {
        printf("failure7\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x4b324fc8 ||
         *((uint16_t *)uuid->uuid + 2) != 0x1670 ||
         *((uint16_t *)uuid->uuid + 3) != 0x01d3 ||
         *((uint16_t *)uuid->uuid + 4) != 0x1278 ||
         uuid->uuid[10] != 0x5a || uuid->uuid[11] != 0x47 ||
         uuid->uuid[12] != 0xbf || uuid->uuid[13] != 0x6e ||
         uuid->uuid[14] != 0xe1 || uuid->uuid[15] != 0x88) ||
        uuid->accepted != 1 ||
        uuid->iv != 3 ||
        uuid->context_id != 0) {
        printf("failure 7_1\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 1 ||
        tx->opnum != 0 ||
        tx->stub_len[0] != 52 ||
        tx->stub_len[1] != 96) {
        printf("failure 7_2\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x6bffd098 ||
         *((uint16_t *)tx->iface.uuid + 2) != 0xa112 ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x3610 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0x9833 ||
         tx->iface.uuid[10] != 0x46 || tx->iface.uuid[11] != 0xc3 ||
         tx->iface.uuid[12] != 0xf8 || tx->iface.uuid[13] != 0x7e ||
         tx->iface.uuid[14] != 0x34 || tx->iface.uuid[15] != 0x5a)) {
        printf("failure 7_3\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(1, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 1 ||
        tx->opnum != 21 ||
        tx->stub_len[0] != 52 ||
        tx->stub_len[1] != 0) {
        printf("failure 7_2\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x4b324fc8 ||
         *((uint16_t *)tx->iface.uuid + 2) != 0x1670 ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x01d3 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0x1278 ||
         tx->iface.uuid[10] != 0x5a || tx->iface.uuid[11] != 0x47 ||
         tx->iface.uuid[12] != 0xbf || tx->iface.uuid[13] != 0x6e ||
         tx->iface.uuid[14] != 0xe1 || tx->iface.uuid[15] != 0x88)) {
        printf("failure 7_3\n");
        goto end;
    }

    for (i = 0; i < response2_len; i++) {
        r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, response2 + i, 1);
        if (r != 0) {
            printf("failure parsing response2 - %lu\n", i);
            goto end;
        }
    }
    if (state->connp[1].rpc_vers_minor != 0 ||
        state->connp[1].ptype != 2 ||
        state->connp[1].pfc_flags != 0x03 ||
        state->connp[1].auth_length != 0 ||
        state->connp[1].frag_length != 116 ||
        state->connp[1].call_id != 1 ||
        state->connp[1].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 2) {
        printf("failure8\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x4b324fc8 ||
         *((uint16_t *)uuid->uuid + 2) != 0x1670 ||
         *((uint16_t *)uuid->uuid + 3) != 0x01d3 ||
         *((uint16_t *)uuid->uuid + 4) != 0x1278 ||
         uuid->uuid[10] != 0x5a || uuid->uuid[11] != 0x47 ||
         uuid->uuid[12] != 0xbf || uuid->uuid[13] != 0x6e ||
         uuid->uuid[14] != 0xe1 || uuid->uuid[15] != 0x88) ||
        uuid->accepted != 1 ||
        uuid->iv != 3 ||
        uuid->context_id != 0) {
        printf("failure 8_1\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 1 ||
        tx->opnum != 0 ||
        tx->stub_len[0] != 52 ||
        tx->stub_len[1] != 96) {
        printf("failure 8_2\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x6bffd098 ||
         *((uint16_t *)tx->iface.uuid + 2) != 0xa112 ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x3610 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0x9833 ||
         tx->iface.uuid[10] != 0x46 || tx->iface.uuid[11] != 0xc3 ||
         tx->iface.uuid[12] != 0xf8 || tx->iface.uuid[13] != 0x7e ||
         tx->iface.uuid[14] != 0x34 || tx->iface.uuid[15] != 0x5a)) {
        printf("failure 8_3\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(1, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 1 ||
        tx->opnum != 21 ||
        tx->stub_len[0] != 52 ||
        tx->stub_len[1] != 92) {
        printf("failure 8_2\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x4b324fc8 ||
         *((uint16_t *)tx->iface.uuid + 2) != 0x1670 ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x01d3 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0x1278 ||
         tx->iface.uuid[10] != 0x5a || tx->iface.uuid[11] != 0x47 ||
         tx->iface.uuid[12] != 0xbf || tx->iface.uuid[13] != 0x6e ||
         tx->iface.uuid[14] != 0xe1 || tx->iface.uuid[15] != 0x88)) {
        printf("failure 8_3\n");
        goto end;
    }

    result = 1;

end:
    StreamTcpFreeConfig(TRUE);
    FLOW_DESTROY(&f);
    return result;
}

/**
 * \test Same as Test06, but we send all app data as 1 byte frags(tcp frags).
 */
int DCERPCParserTest16(void)
{
    int result = 0;

    uint8_t bind[] = {
        0x05, 0x00, 0x0b, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x48, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0xb8, 0x10, 0xb8, 0x10, 0x00, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00,
        0x78, 0x56, 0x34, 0x12, 0x34, 0x12, 0xcd, 0xab,
        0xef, 0x00, 0x01, 0x23, 0x45, 0x67, 0x89, 0xab,
        0x01, 0x00, 0x00, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
    };
    uint32_t bind_len = sizeof(bind);

    uint8_t bindack[] = {
        0x05, 0x00, 0x0c, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x44, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0xb8, 0x10, 0xb8, 0x10, 0xf3, 0x43, 0x00, 0x00,
        0x0e, 0x00, 0x5c, 0x70, 0x69, 0x70, 0x65, 0x5c,
        0x73, 0x70, 0x6f, 0x6f, 0x6c, 0x73, 0x73, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00,
    };
    uint32_t bindack_len = sizeof(bindack);

    uint8_t request[] = {
        0x05, 0x00, 0x00, 0x81, 0x10, 0x00, 0x00, 0x00,
        0xb8, 0x10, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x20, 0x17, 0x00, 0x00, 0x00, 0x00, 0x05, 0x00,
        0x78, 0x56, 0x34, 0x12, 0x34, 0x12, 0xcd, 0xab,
        0xef, 0x00, 0x01, 0x23, 0x45, 0x67, 0x89, 0xab,
        0xc0, 0xf4, 0x19, 0x00, 0xf8, 0x0a, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0xf8, 0x0a, 0x00, 0x00,
        0x5c, 0x00, 0x5c, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
        0x23, 0x00, 0x23, 0x00, 0x23, 0x00, 0x23, 0x00,
    };
    uint32_t request_len = sizeof(request);

    DCERPCState *state;
    Flow f;
    TcpSession ssn;
    int r;
    UUID *uuid = NULL;
    DCERPCTx *tx = NULL;
    size_t i = 0;

    memset(&f, 0, sizeof(f));
    memset(&ssn, 0, sizeof(ssn));
    FLOW_INITIALIZE(&f);
    f.protoctx = (void *)&ssn;

    StreamTcpInitConfig(TRUE);

    for (i = 0; i < bind_len; i++) {
        r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER | STREAM_START, bind + i, 1);
        if (r != 0) {
            printf("failure parsing bind - %lu\n", i);
            goto end;
        }
    }
    state = f.alstate;
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 11 ||
        state->connp[0].pfc_flags != 0x03 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 72 ||
        state->connp[0].call_id != 1 ||
        state->connp[0].assoc_group_id != 0 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[0].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 0) {
        printf("failure1\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x12345678 ||
         *((uint16_t *)uuid->uuid + 2) != 0x1234 ||
         *((uint16_t *)uuid->uuid + 3) != 0xabcd ||
         *((uint16_t *)uuid->uuid + 4) != 0xef00 ||
         uuid->uuid[10] != 0x01 || uuid->uuid[11] != 0x23 ||
         uuid->uuid[12] != 0x45 || uuid->uuid[13] != 0x67 ||
         uuid->uuid[14] != 0x89 || uuid->uuid[15] != 0xab) ||
        uuid->accepted != 0 ||
        uuid->iv != 1 ||
        uuid->context_id != 0) {
        printf("failure 1_1\n");
        goto end;
    }

    for (i = 0; i < bindack_len; i++) {
        r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, bindack + i, 1);
        if (r != 0) {
            printf("failure parsing bindack - %lu\n", i);
            goto end;
        }
    }
    if (state->connp[1].rpc_vers_minor != 0 ||
        state->connp[1].ptype != 12 ||
        state->connp[1].pfc_flags != 0x03 ||
        state->connp[1].auth_length != 0 ||
        state->connp[1].frag_length != 68 ||
        state->connp[1].call_id != 1 ||
        state->connp[1].assoc_group_id != 0x000043f3 ||
        state->connp[1].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 0) {
        printf("failure2\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x12345678 ||
         *((uint16_t *)uuid->uuid + 2) != 0x1234 ||
         *((uint16_t *)uuid->uuid + 3) != 0xabcd ||
         *((uint16_t *)uuid->uuid + 4) != 0xef00 ||
         uuid->uuid[10] != 0x01 || uuid->uuid[11] != 0x23 ||
         uuid->uuid[12] != 0x45 || uuid->uuid[13] != 0x67 ||
         uuid->uuid[14] != 0x89 || uuid->uuid[15] != 0xab) ||
        uuid->accepted != 1 ||
        uuid->iv != 1 ||
        uuid->context_id != 0) {
        printf("failure 2_1\n");
        goto end;
    }

    for (i = 0; i < request_len; i++) {
        r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER, request + i, 1);
        if (r != 0) {
            printf("failure parsing request - %lu\n", i);
            goto end;
        }
    }
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 0 ||
        state->connp[0].pfc_flags != 0x81 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 4280 ||
        state->connp[0].call_id != 1 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[0].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure3\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x12345678 ||
         *((uint16_t *)uuid->uuid + 2) != 0x1234 ||
         *((uint16_t *)uuid->uuid + 3) != 0xabcd ||
         *((uint16_t *)uuid->uuid + 4) != 0xef00 ||
         uuid->uuid[10] != 0x01 || uuid->uuid[11] != 0x23 ||
         uuid->uuid[12] != 0x45 || uuid->uuid[13] != 0x67 ||
         uuid->uuid[14] != 0x89 || uuid->uuid[15] != 0xab) ||
        uuid->accepted != 1 ||
        uuid->iv != 1 ||
        uuid->context_id != 0) {
        printf("failure 3_1\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 1 ||
        tx->opnum != 5 ||
        tx->stub_len[0] != 4240 ||
        tx->stub_len[1] != 0) {
        printf("failure 3_2\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x12345678 ||
         *((uint16_t *)tx->iface.uuid + 2) != 0x1234 ||
         *((uint16_t *)tx->iface.uuid + 3) != 0xabcd ||
         *((uint16_t *)tx->iface.uuid + 4) != 0xef00 ||
         tx->iface.uuid[10] != 0x01 || tx->iface.uuid[11] != 0x23 ||
         tx->iface.uuid[12] != 0x45 || tx->iface.uuid[13] != 0x67 ||
         tx->iface.uuid[14] != 0x89 || tx->iface.uuid[15] != 0xab)) {
        printf("failure 3_3\n");
        goto end;
    }

    result = 1;

end:
    StreamTcpFreeConfig(TRUE);
    FLOW_DESTROY(&f);
    return result;
}

/**
 * \test Same as Test07, but we send all app data as 1 byte frags(tcp frags).
 */
int DCERPCParserTest17(void)
{
    int result = 0;

    uint8_t bind[] = {
        0x05, 0x00, 0x0b, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x48, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0xb8, 0x10, 0xb8, 0x10, 0x00, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00,
        0x81, 0xbb, 0x7a, 0x36, 0x44, 0x98, 0xf1, 0x35,
        0xad, 0x32, 0x98, 0xf0, 0x38, 0x00, 0x10, 0x03,
        0x02, 0x00, 0x00, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
    };
    uint32_t bind_len = sizeof(bind);

    uint8_t bindack[] = {
        0x05, 0x00, 0x0c, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x44, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0xb8, 0x10, 0xb8, 0x10, 0x74, 0x73, 0x00, 0x00,
        0x0d, 0x00, 0x5c, 0x50, 0x49, 0x50, 0x45, 0x5c,
        0x6e, 0x74, 0x73, 0x76, 0x63, 0x73, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00,
    };
    uint32_t bindack_len = sizeof(bindack);

    uint8_t request1[] = {
        0x05, 0x00, 0x00, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x40, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x28, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1b, 0x00,
        0x64, 0x7e, 0x32, 0x00, 0x0f, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x0f, 0x00, 0x00, 0x00,
        0x5c, 0x5c, 0x31, 0x37, 0x31, 0x2e, 0x37, 0x31,
        0x2e, 0x38, 0x34, 0x2e, 0x36, 0x37, 0x00, 0x8a,
        0x00, 0x00, 0x00, 0x00, 0x3f, 0x00, 0x0f, 0x00,
    };
    uint32_t request1_len = sizeof(request1);

    uint8_t response1[] = {
        0x05, 0x00, 0x02, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x30, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x18, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0xd2, 0xc4, 0x88, 0x14,
        0xef, 0x31, 0xbb, 0x4d, 0xa8, 0x13, 0xb7, 0x1b,
        0x47, 0x49, 0xb5, 0xd7, 0x00, 0x00, 0x00, 0x00,
    };
    uint32_t response1_len = sizeof(response1);

    uint8_t request2[] = {
        0x05, 0x00, 0x00, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x40, 0x00, 0x00, 0x00, 0x02, 0x00, 0x00, 0x00,
        0x28, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1a, 0x00,
        0x00, 0x00, 0x00, 0x00, 0xd2, 0xc4, 0x88, 0x14,
        0xef, 0x31, 0xbb, 0x4d, 0xa8, 0x13, 0xb7, 0x1b,
        0x47, 0x49, 0xb5, 0xd7, 0x30, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x24, 0x00, 0x00, 0x00,
        0x04, 0xfa, 0x7f, 0x01, 0x00, 0x00, 0x00, 0x00,
    };
    uint32_t request2_len = sizeof(request2);

    uint8_t response2[] = {
        0x05, 0x00, 0x02, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x54, 0x00, 0x00, 0x00, 0x02, 0x00, 0x00, 0x00,
        0x3c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x24, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x7e, 0x17, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x8c, 0x9c, 0x0c, 0x00, 0x00, 0x00, 0x00, 0x00,
        0xea, 0x00, 0x00, 0x00,
    };
    uint32_t response2_len = sizeof(response2);

    uint8_t request3[] = {
        0x05, 0x00, 0x00, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x40, 0x00, 0x00, 0x00, 0x03, 0x00, 0x00, 0x00,
        0x28, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1a, 0x00,
        0x00, 0x00, 0x00, 0x00, 0xd2, 0xc4, 0x88, 0x14,
        0xef, 0x31, 0xbb, 0x4d, 0xa8, 0x13, 0xb7, 0x1b,
        0x47, 0x49, 0xb5, 0xd7, 0x30, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x7e, 0x17, 0x00, 0x00,
        0x04, 0xfa, 0x7f, 0x01, 0x00, 0x00, 0x00, 0x00,
    };
    uint32_t request3_len = sizeof(request3);

    DCERPCState *state;
    Flow f;
    TcpSession ssn;
    int r;
    UUID *uuid = NULL;
    DCERPCTx *tx = NULL;
    size_t i = 0;

    memset(&f, 0, sizeof(f));
    memset(&ssn, 0, sizeof(ssn));
    FLOW_INITIALIZE(&f);
    f.protoctx = (void *)&ssn;

    StreamTcpInitConfig(TRUE);

    for (i = 0; i < bind_len; i++) {
        r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER | STREAM_START, bind + i, 1);
        if (r != 0) {
            printf("failure parsing bind - %lu\n", i);
            goto end;
        }
    }
    state = f.alstate;
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 11 ||
        state->connp[0].pfc_flags != 0x03 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 72 ||
        state->connp[0].call_id != 1 ||
        state->connp[0].assoc_group_id != 0 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[0].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 0) {
        printf("failure1\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x367abb81 ||
         *((uint16_t *)uuid->uuid + 2) != 0x9844 ||
         *((uint16_t *)uuid->uuid + 3) != 0x35f1 ||
         *((uint16_t *)uuid->uuid + 4) != 0xad32 ||
         uuid->uuid[10] != 0x98 || uuid->uuid[11] != 0xf0 ||
         uuid->uuid[12] != 0x38 || uuid->uuid[13] != 0x00 ||
         uuid->uuid[14] != 0x10 || uuid->uuid[15] != 0x03) ||
        uuid->accepted != 0 ||
        uuid->iv != 2 ||
        uuid->context_id != 0) {
        printf("failure 1_1\n");
        goto end;
    }

    for (i = 0; i < bindack_len; i++) {
        r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, bindack + i, 1);
        if (r != 0) {
            printf("failure parsing bindack - %lu\n", i);
            goto end;
        }
    }
    if (state->connp[1].rpc_vers_minor != 0 ||
        state->connp[1].ptype != 12 ||
        state->connp[1].pfc_flags != 0x03 ||
        state->connp[1].auth_length != 0 ||
        state->connp[1].frag_length != 68 ||
        state->connp[1].call_id != 1 ||
        state->connp[1].assoc_group_id != 0x00007374 ||
        state->connp[1].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 0) {
        printf("failure2\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x367abb81 ||
         *((uint16_t *)uuid->uuid + 2) != 0x9844 ||
         *((uint16_t *)uuid->uuid + 3) != 0x35f1 ||
         *((uint16_t *)uuid->uuid + 4) != 0xad32 ||
         uuid->uuid[10] != 0x98 || uuid->uuid[11] != 0xf0 ||
         uuid->uuid[12] != 0x38 || uuid->uuid[13] != 0x00 ||
         uuid->uuid[14] != 0x10 || uuid->uuid[15] != 0x03) ||
        uuid->accepted != 1 ||
        uuid->iv != 2 ||
        uuid->context_id != 0) {
        printf("failure 2_1\n");
        goto end;
    }

    for (i = 0; i < request1_len; i++) {
        r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER, request1 + i, 1);
        if (r != 0) {
            printf("failure parsing request1 - %lu\n", i);
            goto end;
        }
    }
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 0 ||
        state->connp[0].pfc_flags != 0x03 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 64 ||
        state->connp[0].call_id != 1 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[0].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure3\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x367abb81 ||
         *((uint16_t *)uuid->uuid + 2) != 0x9844 ||
         *((uint16_t *)uuid->uuid + 3) != 0x35f1 ||
         *((uint16_t *)uuid->uuid + 4) != 0xad32 ||
         uuid->uuid[10] != 0x98 || uuid->uuid[11] != 0xf0 ||
         uuid->uuid[12] != 0x38 || uuid->uuid[13] != 0x00 ||
         uuid->uuid[14] != 0x10 || uuid->uuid[15] != 0x03) ||
        uuid->accepted != 1 ||
        uuid->iv != 2 ||
        uuid->context_id != 0) {
        printf("failure 3_1\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 1 ||
        tx->opnum != 27 ||
        tx->stub_len[0] != 40 ||
        tx->stub_len[1] != 0) {
        printf("failure 3_2\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x367abb81 ||
         *((uint16_t *)tx->iface.uuid + 2) != 0x9844 ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x35f1 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0xad32 ||
         tx->iface.uuid[10] != 0x98 || tx->iface.uuid[11] != 0xf0 ||
         tx->iface.uuid[12] != 0x38 || tx->iface.uuid[13] != 0x00 ||
         tx->iface.uuid[14] != 0x10 || tx->iface.uuid[15] != 0x03)) {
        printf("failure 3_3\n");
        goto end;
    }

    for (i = 0; i < response1_len; i++) {
        r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, response1 + i, 1);
        if (r != 0) {
            printf("failure parsing response1 - %lu\n", i);
            goto end;
        }
    }
    if (state->connp[1].rpc_vers_minor != 0 ||
        state->connp[1].ptype != 2 ||
        state->connp[1].pfc_flags != 0x03 ||
        state->connp[1].auth_length != 0 ||
        state->connp[1].frag_length != 48 ||
        state->connp[1].call_id != 1 ||
        state->connp[1].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure4\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x367abb81 ||
         *((uint16_t *)uuid->uuid + 2) != 0x9844 ||
         *((uint16_t *)uuid->uuid + 3) != 0x35f1 ||
         *((uint16_t *)uuid->uuid + 4) != 0xad32 ||
         uuid->uuid[10] != 0x98 || uuid->uuid[11] != 0xf0 ||
         uuid->uuid[12] != 0x38 || uuid->uuid[13] != 0x00 ||
         uuid->uuid[14] != 0x10 || uuid->uuid[15] != 0x03) ||
        uuid->accepted != 1 ||
        uuid->iv != 2 ||
        uuid->context_id != 0) {
        printf("failure 4_1\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 1 ||
        tx->opnum != 27 ||
        tx->stub_len[0] != 40 ||
        tx->stub_len[1] != 24) {
        printf("failure 4_2\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x367abb81 ||
         *((uint16_t *)tx->iface.uuid + 2) != 0x9844 ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x35f1 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0xad32 ||
         tx->iface.uuid[10] != 0x98 || tx->iface.uuid[11] != 0xf0 ||
         tx->iface.uuid[12] != 0x38 || tx->iface.uuid[13] != 0x00 ||
         tx->iface.uuid[14] != 0x10 || tx->iface.uuid[15] != 0x03)) {
        printf("failure 4_3\n");
        goto end;
    }

    for (i = 0; i < request2_len; i++) {
        r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER, request2 + i, 1);
        if (r != 0) {
            printf("failure parsing request2 - %lu\n", i);
            goto end;
        }
    }
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 0 ||
        state->connp[0].pfc_flags != 0x03 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 64 ||
        state->connp[0].call_id != 2 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[0].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 2) {
        printf("failure5\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x367abb81 ||
         *((uint16_t *)uuid->uuid + 2) != 0x9844 ||
         *((uint16_t *)uuid->uuid + 3) != 0x35f1 ||
         *((uint16_t *)uuid->uuid + 4) != 0xad32 ||
         uuid->uuid[10] != 0x98 || uuid->uuid[11] != 0xf0 ||
         uuid->uuid[12] != 0x38 || uuid->uuid[13] != 0x00 ||
         uuid->uuid[14] != 0x10 || uuid->uuid[15] != 0x03) ||
        uuid->accepted != 1 ||
        uuid->iv != 2 ||
        uuid->context_id != 0) {
        printf("failure 5_1\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 1 ||
        tx->opnum != 27 ||
        tx->stub_len[0] != 40 ||
        tx->stub_len[1] != 24) {
        printf("failure 5_2\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x367abb81 ||
         *((uint16_t *)tx->iface.uuid + 2) != 0x9844 ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x35f1 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0xad32 ||
         tx->iface.uuid[10] != 0x98 || tx->iface.uuid[11] != 0xf0 ||
         tx->iface.uuid[12] != 0x38 || tx->iface.uuid[13] != 0x00 ||
         tx->iface.uuid[14] != 0x10 || tx->iface.uuid[15] != 0x03)) {
        printf("failure 5_3\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(1, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 2 ||
        tx->opnum != 26 ||
        tx->stub_len[0] != 40 ||
        tx->stub_len[1] != 0) {
        printf("failure 5_4\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x367abb81 ||
         *((uint16_t *)tx->iface.uuid + 2) != 0x9844 ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x35f1 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0xad32 ||
         tx->iface.uuid[10] != 0x98 || tx->iface.uuid[11] != 0xf0 ||
         tx->iface.uuid[12] != 0x38 || tx->iface.uuid[13] != 0x00 ||
         tx->iface.uuid[14] != 0x10 || tx->iface.uuid[15] != 0x03)) {
        printf("failure 5_5\n");
        goto end;
    }

    for (i = 0; i < response2_len; i++) {
        r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, response2 + i, 1);
        if (r != 0) {
            printf("failure parsing response2 - %lu\n", i);
            goto end;
        }
    }
    if (state->connp[1].rpc_vers_minor != 0 ||
        state->connp[1].ptype != 2 ||
        state->connp[1].pfc_flags != 0x03 ||
        state->connp[1].auth_length != 0 ||
        state->connp[1].frag_length != 84 ||
        state->connp[1].call_id != 2 ||
        state->connp[1].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 2) {
        printf("failure6\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x367abb81 ||
         *((uint16_t *)uuid->uuid + 2) != 0x9844 ||
         *((uint16_t *)uuid->uuid + 3) != 0x35f1 ||
         *((uint16_t *)uuid->uuid + 4) != 0xad32 ||
         uuid->uuid[10] != 0x98 || uuid->uuid[11] != 0xf0 ||
         uuid->uuid[12] != 0x38 || uuid->uuid[13] != 0x00 ||
         uuid->uuid[14] != 0x10 || uuid->uuid[15] != 0x03) ||
        uuid->accepted != 1 ||
        uuid->iv != 2 ||
        uuid->context_id != 0) {
        printf("failure 6_1\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 1 ||
        tx->opnum != 27 ||
        tx->stub_len[0] != 40 ||
        tx->stub_len[1] != 24) {
        printf("failure 6_2\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x367abb81 ||
         *((uint16_t *)tx->iface.uuid + 2) != 0x9844 ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x35f1 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0xad32 ||
         tx->iface.uuid[10] != 0x98 || tx->iface.uuid[11] != 0xf0 ||
         tx->iface.uuid[12] != 0x38 || tx->iface.uuid[13] != 0x00 ||
         tx->iface.uuid[14] != 0x10 || tx->iface.uuid[15] != 0x03)) {
        printf("failure 6_3\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(1, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 2 ||
        tx->opnum != 26 ||
        tx->stub_len[0] != 40 ||
        tx->stub_len[1] != 60) {
        printf("failure 6_4\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x367abb81 ||
         *((uint16_t *)tx->iface.uuid + 2) != 0x9844 ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x35f1 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0xad32 ||
         tx->iface.uuid[10] != 0x98 || tx->iface.uuid[11] != 0xf0 ||
         tx->iface.uuid[12] != 0x38 || tx->iface.uuid[13] != 0x00 ||
         tx->iface.uuid[14] != 0x10 || tx->iface.uuid[15] != 0x03)) {
        printf("failure 6_5\n");
        goto end;
    }

    for (i = 0; i < request3_len; i++) {
        r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER, request3 + i, 1);
        if (r != 0) {
            printf("failure parsing request2 - %lu\n", i);
            goto end;
        }
    }
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 0 ||
        state->connp[0].pfc_flags != 0x03 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 64 ||
        state->connp[0].call_id != 3 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[0].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 3) {
        printf("failure7\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x367abb81 ||
         *((uint16_t *)uuid->uuid + 2) != 0x9844 ||
         *((uint16_t *)uuid->uuid + 3) != 0x35f1 ||
         *((uint16_t *)uuid->uuid + 4) != 0xad32 ||
         uuid->uuid[10] != 0x98 || uuid->uuid[11] != 0xf0 ||
         uuid->uuid[12] != 0x38 || uuid->uuid[13] != 0x00 ||
         uuid->uuid[14] != 0x10 || uuid->uuid[15] != 0x03) ||
        uuid->accepted != 1 ||
        uuid->iv != 2 ||
        uuid->context_id != 0) {
        printf("failure 7_1\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 1 ||
        tx->opnum != 27 ||
        tx->stub_len[0] != 40 ||
        tx->stub_len[1] != 24) {
        printf("failure 7_2\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x367abb81 ||
         *((uint16_t *)tx->iface.uuid + 2) != 0x9844 ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x35f1 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0xad32 ||
         tx->iface.uuid[10] != 0x98 || tx->iface.uuid[11] != 0xf0 ||
         tx->iface.uuid[12] != 0x38 || tx->iface.uuid[13] != 0x00 ||
         tx->iface.uuid[14] != 0x10 || tx->iface.uuid[15] != 0x03)) {
        printf("failure 7_3\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(1, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 2 ||
        tx->opnum != 26 ||
        tx->stub_len[0] != 40 ||
        tx->stub_len[1] != 60) {
        printf("failure 7_4\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x367abb81 ||
         *((uint16_t *)tx->iface.uuid + 2) != 0x9844 ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x35f1 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0xad32 ||
         tx->iface.uuid[10] != 0x98 || tx->iface.uuid[11] != 0xf0 ||
         tx->iface.uuid[12] != 0x38 || tx->iface.uuid[13] != 0x00 ||
         tx->iface.uuid[14] != 0x10 || tx->iface.uuid[15] != 0x03)) {
        printf("failure 7_5\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(2, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 3 ||
        tx->opnum != 26 ||
        tx->stub_len[0] != 40 ||
        tx->stub_len[1] != 0) {
        printf("failure 7_6\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x367abb81 ||
         *((uint16_t *)tx->iface.uuid + 2) != 0x9844 ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x35f1 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0xad32 ||
         tx->iface.uuid[10] != 0x98 || tx->iface.uuid[11] != 0xf0 ||
         tx->iface.uuid[12] != 0x38 || tx->iface.uuid[13] != 0x00 ||
         tx->iface.uuid[14] != 0x10 || tx->iface.uuid[15] != 0x03)) {
        printf("failure 7_7\n");
        goto end;
    }

    result = 1;

end:
    StreamTcpFreeConfig(TRUE);
    FLOW_DESTROY(&f);
    return result;
}

/**
 * \test Same as Test08, but we send all app data as 1 byte frags(tcp frags).
 */
int DCERPCParserTest18(void)
{
    int result = 0;

    uint8_t bind[] = {
        0x05, 0x00, 0x0b, 0x03, 0x10, 0x00, 0x00, 0x00,
        0xdc, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0xd0, 0x16, 0xd0, 0x16, 0x00, 0x00, 0x00, 0x00,
        0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00,
        0x7e, 0x6f, 0x8e, 0xd6, 0xb0, 0x97, 0xde, 0x71,
        0x8c, 0x44, 0x78, 0x3c, 0x54, 0x60, 0x97, 0xf1,
        0x05, 0x00, 0x02, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x01, 0x00, 0x18, 0xc4, 0x7e, 0xf1,
        0xd2, 0x10, 0x02, 0x6b, 0x0e, 0x0c, 0xf6, 0x0b,
        0x02, 0x95, 0xae, 0xa1, 0x03, 0x00, 0x02, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x70, 0xe4, 0x3d, 0x31, 0x26, 0xf9, 0x94, 0xfe,
        0x3c, 0x90, 0x8b, 0x6a, 0x51, 0xa9, 0xbb, 0x95,
        0x01, 0x00, 0x02, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
        0x03, 0x00, 0x01, 0x00, 0xe8, 0xed, 0xf1, 0xd5,
        0xa6, 0x82, 0xc5, 0x76, 0xce, 0x2d, 0xd8, 0x7c,
        0x6c, 0x11, 0x6f, 0xa0, 0x01, 0x00, 0x01, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00, 0x04, 0x00, 0x01, 0x00,
        0x09, 0x61, 0x07, 0x86, 0xef, 0xb1, 0x05, 0xb8,
        0xd3, 0xd5, 0xfa, 0x2d, 0x04, 0x6c, 0x90, 0x5e,
        0x00, 0x00, 0x00, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
        0x05, 0x00, 0x01, 0x00, 0x8f, 0xed, 0x01, 0xb4,
        0xdc, 0x4b, 0x55, 0x86, 0x99, 0xa7, 0x6a, 0x64,
        0x7f, 0x32, 0xe9, 0x2f, 0x03, 0x00, 0x00, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00, 0x06, 0x00, 0x01, 0x00,
        0xec, 0xc5, 0xe7, 0x53, 0xae, 0x20, 0xc3, 0x34,
        0x97, 0x14, 0x77, 0xf0, 0xfe, 0x68, 0x05, 0xa8,
        0x03, 0x00, 0x00, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
        0x07, 0x00, 0x01, 0x00, 0xd7, 0x92, 0x02, 0xb5,
        0xcd, 0xbd, 0x35, 0x35, 0x1e, 0x94, 0x88, 0x3d,
        0x79, 0x63, 0x2c, 0x10, 0x00, 0x00, 0x03, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00, 0x08, 0x00, 0x01, 0x00,
        0xb9, 0x33, 0x65, 0x7e, 0xd9, 0xcd, 0x03, 0x1a,
        0xa9, 0xb8, 0xfc, 0x12, 0x9b, 0x0d, 0xb9, 0x8b,
        0x02, 0x00, 0x01, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
        0x09, 0x00, 0x01, 0x00, 0xe7, 0xf1, 0x0e, 0x3d,
        0x1a, 0xb1, 0x4d, 0xb0, 0xaa, 0x43, 0x65, 0x58,
        0x48, 0xad, 0xf2, 0xf4, 0x01, 0x00, 0x02, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00, 0x0a, 0x00, 0x01, 0x00,
        0x09, 0x29, 0x3e, 0xf7, 0x45, 0x32, 0xf5, 0x10,
        0x28, 0x68, 0xc7, 0x39, 0xef, 0x17, 0x8a, 0xfc,
        0x03, 0x00, 0x00, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
        0x0b, 0x00, 0x01, 0x00, 0x46, 0xea, 0xcc, 0x19,
        0x76, 0x04, 0xf4, 0x0c, 0x9c, 0x2f, 0x17, 0xb2,
        0x72, 0xf4, 0x84, 0x4f, 0x02, 0x00, 0x00, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00, 0x0c, 0x00, 0x01, 0x00,
        0x6a, 0x28, 0x19, 0x39, 0x0c, 0xb1, 0xd0, 0x11,
        0x9b, 0xa8, 0x00, 0xc0, 0x4f, 0xd9, 0x2e, 0xf5,
        0x00, 0x00, 0x00, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
        0x0d, 0x00, 0x01, 0x00, 0x8d, 0x42, 0x65, 0xbd,
        0x57, 0x32, 0x4d, 0x06, 0x10, 0x1c, 0x01, 0x75,
        0x78, 0x9c, 0x8d, 0xf5, 0x01, 0x00, 0x01, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00, 0x0e, 0x00, 0x01, 0x00,
        0x72, 0xd8, 0xa0, 0x14, 0xa6, 0xb2, 0xf7, 0xaf,
        0x59, 0x09, 0x3b, 0x93, 0xcd, 0x86, 0xa5, 0xf4,
        0x00, 0x00, 0x01, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
        0x0f, 0x00, 0x01, 0x00, 0x65, 0x51, 0xbd, 0x9d,
        0x21, 0x1e, 0x2e, 0x7d, 0x5e, 0x2a, 0x71, 0x4b,
        0x66, 0xe9, 0xf0, 0xde, 0x03, 0x00, 0x03, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00,
    };
    uint32_t bind_len = sizeof(bind);

    uint8_t bindack[] = {
        0x05, 0x00, 0x0c, 0x03, 0x10, 0x00, 0x00, 0x00,
        0xac, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0xb8, 0x10, 0xb8, 0x10, 0xe3, 0x43, 0x00, 0x00,
        0x0c, 0x00, 0x5c, 0x50, 0x49, 0x50, 0x45, 0x5c,
        0x6c, 0x73, 0x61, 0x73, 0x73, 0x00, 0x00, 0x0c,
        0x10, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00,
    };
    uint32_t bindack_len = sizeof(bindack);

    uint8_t request1[] = {
        0x05, 0x00, 0x00, 0x01, 0x10, 0x00, 0x00, 0x00,
        0x97, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x7f, 0x00, 0x00, 0x00, 0x0c, 0x00, 0x09, 0x00,
        0xad, 0x0d, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0xad, 0x0d, 0x00, 0x00, 0x4c, 0x00, 0x66, 0x00,
        0x31, 0x00, 0x78, 0x00, 0x58, 0x00, 0x63, 0x00,
        0x4b, 0x00, 0x48, 0x00, 0x6d, 0x00, 0x70, 0x00,
        0x73, 0x00, 0x58, 0x00, 0x59, 0x00, 0x5a, 0x00,
        0x48, 0x00, 0x70, 0x00, 0x7a, 0x00, 0x62, 0x00,
        0x34, 0x00, 0x53, 0x00, 0x7a, 0x00, 0x4e, 0x00,
        0x61, 0x00, 0x78, 0x00, 0x30, 0x00, 0x75, 0x00,
        0x71, 0x00, 0x69, 0x00, 0x42, 0x00, 0x45, 0x00,
        0x4e, 0x00, 0x44, 0x00, 0x74, 0x00, 0x47, 0x00,
        0x4b, 0x00, 0x49, 0x00, 0x36, 0x00, 0x75, 0x00,
        0x36, 0x00, 0x4c, 0x00, 0x5a, 0x00, 0x74, 0x00,
        0x54, 0x00, 0x49, 0x00, 0x45, 0x00, 0x4f, 0x00,
        0x30, 0x00, 0x4e, 0x00, 0x6c, 0x00, 0x4a, 0x00,
        0x6d, 0x00, 0x6f, 0x00, 0x33, 0x00, 0x73, 0x00,
        0x68, 0x00, 0x6f, 0x00, 0x4b, 0x00, 0x6a,
    };

    uint32_t request1_len = sizeof(request1);

    uint8_t request2[] = {
        0x05, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00,
        0x97, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x7f, 0x00, 0x00, 0x00, 0x0c, 0x00, 0x09, 0x00,
        0x00, 0x39, 0x00, 0x6e, 0x00, 0x65, 0x00, 0x71,
        0x00, 0x38, 0x00, 0x69, 0x00, 0x4d, 0x00, 0x71,
        0x00, 0x5a, 0x00, 0x4d, 0x00, 0x33, 0x00, 0x36,
        0x00, 0x77, 0x00, 0x72, 0x00, 0x47, 0x00, 0x38,
        0x00, 0x71, 0x00, 0x43, 0x00, 0x44, 0x00, 0x52,
        0x00, 0x39, 0x00, 0x33, 0x00, 0x54, 0x00, 0x45,
        0x00, 0x63, 0x00, 0x4c, 0x00, 0x79, 0x00, 0x74,
        0x00, 0x62, 0x00, 0x52, 0x00, 0x32, 0x00, 0x4f,
        0x00, 0x4e, 0x00, 0x65, 0x00, 0x7a, 0x00, 0x37,
        0x00, 0x57, 0x00, 0x39, 0x00, 0x4b, 0x00, 0x71,
        0x00, 0x4c, 0x00, 0x35, 0x00, 0x67, 0x00, 0x41,
        0x00, 0x68, 0x00, 0x67, 0x00, 0x6c, 0x00, 0x38,
        0x00, 0x42, 0x00, 0x30, 0x00, 0x53, 0x00, 0x38,
        0x00, 0x53, 0x00, 0x7a, 0x00, 0x42, 0x00, 0x66,
        0x00, 0x63, 0x00, 0x4a, 0x00, 0x77, 0x00, 0x75,
        0x00, 0x52, 0x00, 0x48, 0x00, 0x35, 0x00,
    };

    uint32_t request2_len = sizeof(request2);

    DCERPCState *state;
    Flow f;
    TcpSession ssn;
    int r;
    UUID *uuid = NULL;
    DCERPCTx *tx = NULL;
    size_t i = 0;

    memset(&f, 0, sizeof(f));
    memset(&ssn, 0, sizeof(ssn));
    FLOW_INITIALIZE(&f);
    f.protoctx = (void *)&ssn;

    StreamTcpInitConfig(TRUE);

    for (i = 0 ; i < bind_len; i++) {
        r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER | STREAM_START, bind + i, 1);
        if (r != 0) {
            printf("failure parsing bind - %lu\n", i);
            goto end;
        }
    }
    state = f.alstate;
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 11 ||
        state->connp[0].pfc_flags != 0x03 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 732 ||
        state->connp[0].call_id != 0 ||
        state->connp[0].assoc_group_id != 0 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[0].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 16 ||
        DCERPCListSize(&state->transactions) != 0) {
        printf("failure1\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xd68e6f7e ||
         *((uint16_t *)uuid->uuid + 2) != 0x97b0 ||
         *((uint16_t *)uuid->uuid + 3) != 0x71de ||
         *((uint16_t *)uuid->uuid + 4) != 0x8c44 ||
         uuid->uuid[10] != 0x78 || uuid->uuid[11] != 0x3c ||
         uuid->uuid[12] != 0x54 || uuid->uuid[13] != 0x60 ||
         uuid->uuid[14] != 0x97 || uuid->uuid[15] != 0xf1) ||
        uuid->accepted != 0 ||
        uuid->iv != 5 ||
        uuid->context_id != 0) {
        printf("failure 1_0\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(1, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xf17ec418 ||
         *((uint16_t *)uuid->uuid + 2) != 0x10d2 ||
         *((uint16_t *)uuid->uuid + 3) != 0x6b02 ||
         *((uint16_t *)uuid->uuid + 4) != 0x0e0c ||
         uuid->uuid[10] != 0xf6 || uuid->uuid[11] != 0x0b ||
         uuid->uuid[12] != 0x02 || uuid->uuid[13] != 0x95 ||
         uuid->uuid[14] != 0xae || uuid->uuid[15] != 0xa1) ||
        uuid->accepted != 0 ||
        uuid->iv != 3 ||
        uuid->context_id != 1) {
        printf("failure 1_1\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(2, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x313de470 ||
         *((uint16_t *)uuid->uuid + 2) != 0xf926 ||
         *((uint16_t *)uuid->uuid + 3) != 0xfe94 ||
         *((uint16_t *)uuid->uuid + 4) != 0x3c90 ||
         uuid->uuid[10] != 0x8b || uuid->uuid[11] != 0x6a ||
         uuid->uuid[12] != 0x51 || uuid->uuid[13] != 0xa9 ||
         uuid->uuid[14] != 0xbb || uuid->uuid[15] != 0x95) ||
        uuid->accepted != 0 ||
        uuid->iv != 1 ||
        uuid->context_id != 2) {
        printf("failure 1_2\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(3, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xd5f1ede8 ||
         *((uint16_t *)uuid->uuid + 2) != 0x82a6 ||
         *((uint16_t *)uuid->uuid + 3) != 0x76c5 ||
         *((uint16_t *)uuid->uuid + 4) != 0xce2d ||
         uuid->uuid[10] != 0xd8 || uuid->uuid[11] != 0x7c ||
         uuid->uuid[12] != 0x6c || uuid->uuid[13] != 0x11 ||
         uuid->uuid[14] != 0x6f || uuid->uuid[15] != 0xa0) ||
        uuid->accepted != 0 ||
        uuid->iv != 1 ||
        uuid->context_id != 3) {
        printf("failure 1_3\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(4, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x86076109 ||
         *((uint16_t *)uuid->uuid + 2) != 0xb1ef ||
         *((uint16_t *)uuid->uuid + 3) != 0xb805 ||
         *((uint16_t *)uuid->uuid + 4) != 0xd3d5 ||
         uuid->uuid[10] != 0xfa || uuid->uuid[11] != 0x2d ||
         uuid->uuid[12] != 0x04 || uuid->uuid[13] != 0x6c ||
         uuid->uuid[14] != 0x90 || uuid->uuid[15] != 0x5e) ||
        uuid->accepted != 0 ||
        uuid->iv != 0 ||
        uuid->context_id != 4) {
        printf("failure 1_4\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(5, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xb401ed8f ||
         *((uint16_t *)uuid->uuid + 2) != 0x4bdc ||
         *((uint16_t *)uuid->uuid + 3) != 0x8655 ||
         *((uint16_t *)uuid->uuid + 4) != 0x99a7 ||
         uuid->uuid[10] != 0x6a || uuid->uuid[11] != 0x64 ||
         uuid->uuid[12] != 0x7f || uuid->uuid[13] != 0x32 ||
         uuid->uuid[14] != 0xe9 || uuid->uuid[15] != 0x2f) ||
        uuid->accepted != 0 ||
        uuid->iv != 3 ||
        uuid->context_id != 5) {
        printf("failure 1_5\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(6, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x53e7c5ec ||
         *((uint16_t *)uuid->uuid + 2) != 0x20ae ||
         *((uint16_t *)uuid->uuid + 3) != 0x34c3 ||
         *((uint16_t *)uuid->uuid + 4) != 0x9714 ||
         uuid->uuid[10] != 0x77 || uuid->uuid[11] != 0xf0 ||
         uuid->uuid[12] != 0xfe || uuid->uuid[13] != 0x68 ||
         uuid->uuid[14] != 0x05 || uuid->uuid[15] != 0xa8) ||
        uuid->accepted != 0 ||
        uuid->iv != 3 ||
        uuid->context_id != 6) {
        printf("failure 1_6\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(7, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xb50292d7 ||
         *((uint16_t *)uuid->uuid + 2) != 0xbdcd ||
         *((uint16_t *)uuid->uuid + 3) != 0x3535 ||
         *((uint16_t *)uuid->uuid + 4) != 0x1e94 ||
         uuid->uuid[10] != 0x88 || uuid->uuid[11] != 0x3d ||
         uuid->uuid[12] != 0x79 || uuid->uuid[13] != 0x63 ||
         uuid->uuid[14] != 0x2c || uuid->uuid[15] != 0x10) ||
        uuid->accepted != 0 ||
        uuid->iv != 0 ||
        uuid->context_id != 7) {
        printf("failure 1_7\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(8, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x7e6533b9 ||
         *((uint16_t *)uuid->uuid + 2) != 0xcdd9 ||
         *((uint16_t *)uuid->uuid + 3) != 0x1a03 ||
         *((uint16_t *)uuid->uuid + 4) != 0xa9b8 ||
         uuid->uuid[10] != 0xfc || uuid->uuid[11] != 0x12 ||
         uuid->uuid[12] != 0x9b || uuid->uuid[13] != 0x0d ||
         uuid->uuid[14] != 0xb9 || uuid->uuid[15] != 0x8b) ||
        uuid->accepted != 0 ||
        uuid->iv != 2 ||
        uuid->context_id != 8) {
        printf("failure 1_8\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(9, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x3d0ef1e7 ||
         *((uint16_t *)uuid->uuid + 2) != 0xb11a ||
         *((uint16_t *)uuid->uuid + 3) != 0xb04d ||
         *((uint16_t *)uuid->uuid + 4) != 0xaa43 ||
         uuid->uuid[10] != 0x65 || uuid->uuid[11] != 0x58 ||
         uuid->uuid[12] != 0x48 || uuid->uuid[13] != 0xad ||
         uuid->uuid[14] != 0xf2 || uuid->uuid[15] != 0xf4) ||
        uuid->accepted != 0 ||
        uuid->iv != 1 ||
        uuid->context_id != 9) {
        printf("failure 1_9\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(10, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xf73e2909 ||
         *((uint16_t *)uuid->uuid + 2) != 0x3245 ||
         *((uint16_t *)uuid->uuid + 3) != 0x10f5 ||
         *((uint16_t *)uuid->uuid + 4) != 0x2868 ||
         uuid->uuid[10] != 0xc7 || uuid->uuid[11] != 0x39 ||
         uuid->uuid[12] != 0xef || uuid->uuid[13] != 0x17 ||
         uuid->uuid[14] != 0x8a || uuid->uuid[15] != 0xfc) ||
        uuid->accepted != 0 ||
        uuid->iv != 3 ||
        uuid->context_id != 10) {
        printf("failure 1_10\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(11, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x19ccea46 ||
         *((uint16_t *)uuid->uuid + 2) != 0x0476 ||
         *((uint16_t *)uuid->uuid + 3) != 0x0cf4 ||
         *((uint16_t *)uuid->uuid + 4) != 0x9c2f ||
         uuid->uuid[10] != 0x17 || uuid->uuid[11] != 0xb2 ||
         uuid->uuid[12] != 0x72 || uuid->uuid[13] != 0xf4 ||
         uuid->uuid[14] != 0x84 || uuid->uuid[15] != 0x4f) ||
        uuid->accepted != 0 ||
        uuid->iv != 2 ||
        uuid->context_id != 11) {
        printf("failure 1_11\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(12, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x3919286a ||
         *((uint16_t *)uuid->uuid + 2) != 0xb10c ||
         *((uint16_t *)uuid->uuid + 3) != 0x11d0 ||
         *((uint16_t *)uuid->uuid + 4) != 0x9ba8 ||
         uuid->uuid[10] != 0x00 || uuid->uuid[11] != 0xc0 ||
         uuid->uuid[12] != 0x4f || uuid->uuid[13] != 0xd9 ||
         uuid->uuid[14] != 0x2e || uuid->uuid[15] != 0xf5) ||
        uuid->accepted != 0 ||
        uuid->iv != 0 ||
        uuid->context_id != 12) {
        printf("failure 1_12\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(13, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xbd65428d ||
         *((uint16_t *)uuid->uuid + 2) != 0x3257 ||
         *((uint16_t *)uuid->uuid + 3) != 0x064d ||
         *((uint16_t *)uuid->uuid + 4) != 0x101c ||
         uuid->uuid[10] != 0x01 || uuid->uuid[11] != 0x75 ||
         uuid->uuid[12] != 0x78 || uuid->uuid[13] != 0x9c ||
         uuid->uuid[14] != 0x8d || uuid->uuid[15] != 0xf5) ||
        uuid->accepted != 0 ||
        uuid->iv != 1 ||
        uuid->context_id != 13) {
        printf("failure 1_13\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(14, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x14a0d872 ||
         *((uint16_t *)uuid->uuid + 2) != 0xb2a6 ||
         *((uint16_t *)uuid->uuid + 3) != 0xaff7 ||
         *((uint16_t *)uuid->uuid + 4) != 0x5909 ||
         uuid->uuid[10] != 0x3b || uuid->uuid[11] != 0x93 ||
         uuid->uuid[12] != 0xcd || uuid->uuid[13] != 0x86 ||
         uuid->uuid[14] != 0xa5 || uuid->uuid[15] != 0xf4) ||
        uuid->accepted != 0 ||
        uuid->iv != 0 ||
        uuid->context_id != 14) {
        printf("failure 1_14\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(15, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x9dbd5165 ||
         *((uint16_t *)uuid->uuid + 2) != 0x1e21 ||
         *((uint16_t *)uuid->uuid + 3) != 0x7d2e ||
         *((uint16_t *)uuid->uuid + 4) != 0x5e2a ||
         uuid->uuid[10] != 0x71 || uuid->uuid[11] != 0x4b ||
         uuid->uuid[12] != 0x66 || uuid->uuid[13] != 0xe9 ||
         uuid->uuid[14] != 0xf0 || uuid->uuid[15] != 0xde) ||
        uuid->accepted != 0 ||
        uuid->iv != 3 ||
        uuid->context_id != 15) {
        printf("failure 1_15\n");
        goto end;
    }

    for (i = 0; i < bindack_len; i++) {
        r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, bindack + i, 1);
        if (r != 0) {
            printf("failure parsing bindack - %lu\n", i);
            goto end;
        }
    }
    if (state->connp[1].rpc_vers_minor != 0 ||
        state->connp[1].ptype != 12 ||
        state->connp[1].pfc_flags != 0x03 ||
        state->connp[1].auth_length != 0 ||
        state->connp[1].frag_length != 428 ||
        state->connp[1].call_id != 0 ||
        state->connp[1].assoc_group_id != 0x000043e3 ||
        state->connp[1].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 16 ||
        DCERPCListSize(&state->transactions) != 0) {
        printf("failure2\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xd68e6f7e ||
         *((uint16_t *)uuid->uuid + 2) != 0x97b0 ||
         *((uint16_t *)uuid->uuid + 3) != 0x71de ||
         *((uint16_t *)uuid->uuid + 4) != 0x8c44 ||
         uuid->uuid[10] != 0x78 || uuid->uuid[11] != 0x3c ||
         uuid->uuid[12] != 0x54 || uuid->uuid[13] != 0x60 ||
         uuid->uuid[14] != 0x97 || uuid->uuid[15] != 0xf1) ||
        uuid->accepted != 0 ||
        uuid->iv != 5 ||
        uuid->context_id != 0) {
        printf("failure 2_0\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(1, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xf17ec418 ||
         *((uint16_t *)uuid->uuid + 2) != 0x10d2 ||
         *((uint16_t *)uuid->uuid + 3) != 0x6b02 ||
         *((uint16_t *)uuid->uuid + 4) != 0x0e0c ||
         uuid->uuid[10] != 0xf6 || uuid->uuid[11] != 0x0b ||
         uuid->uuid[12] != 0x02 || uuid->uuid[13] != 0x95 ||
         uuid->uuid[14] != 0xae || uuid->uuid[15] != 0xa1) ||
        uuid->accepted != 0 ||
        uuid->iv != 3 ||
        uuid->context_id != 1) {
        printf("failure 2_1\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(2, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x313de470 ||
         *((uint16_t *)uuid->uuid + 2) != 0xf926 ||
         *((uint16_t *)uuid->uuid + 3) != 0xfe94 ||
         *((uint16_t *)uuid->uuid + 4) != 0x3c90 ||
         uuid->uuid[10] != 0x8b || uuid->uuid[11] != 0x6a ||
         uuid->uuid[12] != 0x51 || uuid->uuid[13] != 0xa9 ||
         uuid->uuid[14] != 0xbb || uuid->uuid[15] != 0x95) ||
        uuid->accepted != 0 ||
        uuid->iv != 1 ||
        uuid->context_id != 2) {
        printf("failure 2_2\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(3, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xd5f1ede8 ||
         *((uint16_t *)uuid->uuid + 2) != 0x82a6 ||
         *((uint16_t *)uuid->uuid + 3) != 0x76c5 ||
         *((uint16_t *)uuid->uuid + 4) != 0xce2d ||
         uuid->uuid[10] != 0xd8 || uuid->uuid[11] != 0x7c ||
         uuid->uuid[12] != 0x6c || uuid->uuid[13] != 0x11 ||
         uuid->uuid[14] != 0x6f || uuid->uuid[15] != 0xa0) ||
        uuid->accepted != 0 ||
        uuid->iv != 1 ||
        uuid->context_id != 3) {
        printf("failure 2_3\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(4, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x86076109 ||
         *((uint16_t *)uuid->uuid + 2) != 0xb1ef ||
         *((uint16_t *)uuid->uuid + 3) != 0xb805 ||
         *((uint16_t *)uuid->uuid + 4) != 0xd3d5 ||
         uuid->uuid[10] != 0xfa || uuid->uuid[11] != 0x2d ||
         uuid->uuid[12] != 0x04 || uuid->uuid[13] != 0x6c ||
         uuid->uuid[14] != 0x90 || uuid->uuid[15] != 0x5e) ||
        uuid->accepted != 0 ||
        uuid->iv != 0 ||
        uuid->context_id != 4) {
        printf("failure 2_4\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(5, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xb401ed8f ||
         *((uint16_t *)uuid->uuid + 2) != 0x4bdc ||
         *((uint16_t *)uuid->uuid + 3) != 0x8655 ||
         *((uint16_t *)uuid->uuid + 4) != 0x99a7 ||
         uuid->uuid[10] != 0x6a || uuid->uuid[11] != 0x64 ||
         uuid->uuid[12] != 0x7f || uuid->uuid[13] != 0x32 ||
         uuid->uuid[14] != 0xe9 || uuid->uuid[15] != 0x2f) ||
        uuid->accepted != 0 ||
        uuid->iv != 3 ||
        uuid->context_id != 5) {
        printf("failure 2_5\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(6, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x53e7c5ec ||
         *((uint16_t *)uuid->uuid + 2) != 0x20ae ||
         *((uint16_t *)uuid->uuid + 3) != 0x34c3 ||
         *((uint16_t *)uuid->uuid + 4) != 0x9714 ||
         uuid->uuid[10] != 0x77 || uuid->uuid[11] != 0xf0 ||
         uuid->uuid[12] != 0xfe || uuid->uuid[13] != 0x68 ||
         uuid->uuid[14] != 0x05 || uuid->uuid[15] != 0xa8) ||
        uuid->accepted != 0 ||
        uuid->iv != 3 ||
        uuid->context_id != 6) {
        printf("failure 2_6\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(7, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xb50292d7 ||
         *((uint16_t *)uuid->uuid + 2) != 0xbdcd ||
         *((uint16_t *)uuid->uuid + 3) != 0x3535 ||
         *((uint16_t *)uuid->uuid + 4) != 0x1e94 ||
         uuid->uuid[10] != 0x88 || uuid->uuid[11] != 0x3d ||
         uuid->uuid[12] != 0x79 || uuid->uuid[13] != 0x63 ||
         uuid->uuid[14] != 0x2c || uuid->uuid[15] != 0x10) ||
        uuid->accepted != 0 ||
        uuid->iv != 0 ||
        uuid->context_id != 7) {
        printf("failure 2_7\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(8, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x7e6533b9 ||
         *((uint16_t *)uuid->uuid + 2) != 0xcdd9 ||
         *((uint16_t *)uuid->uuid + 3) != 0x1a03 ||
         *((uint16_t *)uuid->uuid + 4) != 0xa9b8 ||
         uuid->uuid[10] != 0xfc || uuid->uuid[11] != 0x12 ||
         uuid->uuid[12] != 0x9b || uuid->uuid[13] != 0x0d ||
         uuid->uuid[14] != 0xb9 || uuid->uuid[15] != 0x8b) ||
        uuid->accepted != 0 ||
        uuid->iv != 2 ||
        uuid->context_id != 8) {
        printf("failure 2_8\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(9, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x3d0ef1e7 ||
         *((uint16_t *)uuid->uuid + 2) != 0xb11a ||
         *((uint16_t *)uuid->uuid + 3) != 0xb04d ||
         *((uint16_t *)uuid->uuid + 4) != 0xaa43 ||
         uuid->uuid[10] != 0x65 || uuid->uuid[11] != 0x58 ||
         uuid->uuid[12] != 0x48 || uuid->uuid[13] != 0xad ||
         uuid->uuid[14] != 0xf2 || uuid->uuid[15] != 0xf4) ||
        uuid->accepted != 0 ||
        uuid->iv != 1 ||
        uuid->context_id != 9) {
        printf("failure 2_9\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(10, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xf73e2909 ||
         *((uint16_t *)uuid->uuid + 2) != 0x3245 ||
         *((uint16_t *)uuid->uuid + 3) != 0x10f5 ||
         *((uint16_t *)uuid->uuid + 4) != 0x2868 ||
         uuid->uuid[10] != 0xc7 || uuid->uuid[11] != 0x39 ||
         uuid->uuid[12] != 0xef || uuid->uuid[13] != 0x17 ||
         uuid->uuid[14] != 0x8a || uuid->uuid[15] != 0xfc) ||
        uuid->accepted != 0 ||
        uuid->iv != 3 ||
        uuid->context_id != 10) {
        printf("failure 2_10\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(11, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x19ccea46 ||
         *((uint16_t *)uuid->uuid + 2) != 0x0476 ||
         *((uint16_t *)uuid->uuid + 3) != 0x0cf4 ||
         *((uint16_t *)uuid->uuid + 4) != 0x9c2f ||
         uuid->uuid[10] != 0x17 || uuid->uuid[11] != 0xb2 ||
         uuid->uuid[12] != 0x72 || uuid->uuid[13] != 0xf4 ||
         uuid->uuid[14] != 0x84 || uuid->uuid[15] != 0x4f) ||
        uuid->accepted != 0 ||
        uuid->iv != 2 ||
        uuid->context_id != 11) {
        printf("failure 2_11\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(12, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x3919286a ||
         *((uint16_t *)uuid->uuid + 2) != 0xb10c ||
         *((uint16_t *)uuid->uuid + 3) != 0x11d0 ||
         *((uint16_t *)uuid->uuid + 4) != 0x9ba8 ||
         uuid->uuid[10] != 0x00 || uuid->uuid[11] != 0xc0 ||
         uuid->uuid[12] != 0x4f || uuid->uuid[13] != 0xd9 ||
         uuid->uuid[14] != 0x2e || uuid->uuid[15] != 0xf5) ||
        uuid->accepted != 1 ||
        uuid->iv != 0 ||
        uuid->context_id != 12) {
        printf("failure 2_12\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(13, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xbd65428d ||
         *((uint16_t *)uuid->uuid + 2) != 0x3257 ||
         *((uint16_t *)uuid->uuid + 3) != 0x064d ||
         *((uint16_t *)uuid->uuid + 4) != 0x101c ||
         uuid->uuid[10] != 0x01 || uuid->uuid[11] != 0x75 ||
         uuid->uuid[12] != 0x78 || uuid->uuid[13] != 0x9c ||
         uuid->uuid[14] != 0x8d || uuid->uuid[15] != 0xf5) ||
        uuid->accepted != 0 ||
        uuid->iv != 1 ||
        uuid->context_id != 13) {
        printf("failure 2_13\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(14, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x14a0d872 ||
         *((uint16_t *)uuid->uuid + 2) != 0xb2a6 ||
         *((uint16_t *)uuid->uuid + 3) != 0xaff7 ||
         *((uint16_t *)uuid->uuid + 4) != 0x5909 ||
         uuid->uuid[10] != 0x3b || uuid->uuid[11] != 0x93 ||
         uuid->uuid[12] != 0xcd || uuid->uuid[13] != 0x86 ||
         uuid->uuid[14] != 0xa5 || uuid->uuid[15] != 0xf4) ||
        uuid->accepted != 0 ||
        uuid->iv != 0 ||
        uuid->context_id != 14) {
        printf("failure 2_14\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(15, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x9dbd5165 ||
         *((uint16_t *)uuid->uuid + 2) != 0x1e21 ||
         *((uint16_t *)uuid->uuid + 3) != 0x7d2e ||
         *((uint16_t *)uuid->uuid + 4) != 0x5e2a ||
         uuid->uuid[10] != 0x71 || uuid->uuid[11] != 0x4b ||
         uuid->uuid[12] != 0x66 || uuid->uuid[13] != 0xe9 ||
         uuid->uuid[14] != 0xf0 || uuid->uuid[15] != 0xde) ||
        uuid->accepted != 0 ||
        uuid->iv != 3 ||
        uuid->context_id != 15) {
        printf("failure 2_15\n");
        goto end;
    }

    for (i = 0; i < request1_len; i++) {
        r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER, request1 + i, 1);
        if (r != 0) {
            printf("failure parsing request1 - %lu\n", i);
            goto end;
        }
    }
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 0 ||
        state->connp[0].pfc_flags != 0x01 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 151 ||
        state->connp[0].call_id != 0 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[0].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 16 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure3\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xd68e6f7e ||
         *((uint16_t *)uuid->uuid + 2) != 0x97b0 ||
         *((uint16_t *)uuid->uuid + 3) != 0x71de ||
         *((uint16_t *)uuid->uuid + 4) != 0x8c44 ||
         uuid->uuid[10] != 0x78 || uuid->uuid[11] != 0x3c ||
         uuid->uuid[12] != 0x54 || uuid->uuid[13] != 0x60 ||
         uuid->uuid[14] != 0x97 || uuid->uuid[15] != 0xf1) ||
        uuid->accepted != 0 ||
        uuid->iv != 5 ||
        uuid->context_id != 0) {
        printf("failure 3_0\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(1, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xf17ec418 ||
         *((uint16_t *)uuid->uuid + 2) != 0x10d2 ||
         *((uint16_t *)uuid->uuid + 3) != 0x6b02 ||
         *((uint16_t *)uuid->uuid + 4) != 0x0e0c ||
         uuid->uuid[10] != 0xf6 || uuid->uuid[11] != 0x0b ||
         uuid->uuid[12] != 0x02 || uuid->uuid[13] != 0x95 ||
         uuid->uuid[14] != 0xae || uuid->uuid[15] != 0xa1) ||
        uuid->accepted != 0 ||
        uuid->iv != 3 ||
        uuid->context_id != 1) {
        printf("failure 3_1\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(2, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x313de470 ||
         *((uint16_t *)uuid->uuid + 2) != 0xf926 ||
         *((uint16_t *)uuid->uuid + 3) != 0xfe94 ||
         *((uint16_t *)uuid->uuid + 4) != 0x3c90 ||
         uuid->uuid[10] != 0x8b || uuid->uuid[11] != 0x6a ||
         uuid->uuid[12] != 0x51 || uuid->uuid[13] != 0xa9 ||
         uuid->uuid[14] != 0xbb || uuid->uuid[15] != 0x95) ||
        uuid->accepted != 0 ||
        uuid->iv != 1 ||
        uuid->context_id != 2) {
        printf("failure 3_2\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(3, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xd5f1ede8 ||
         *((uint16_t *)uuid->uuid + 2) != 0x82a6 ||
         *((uint16_t *)uuid->uuid + 3) != 0x76c5 ||
         *((uint16_t *)uuid->uuid + 4) != 0xce2d ||
         uuid->uuid[10] != 0xd8 || uuid->uuid[11] != 0x7c ||
         uuid->uuid[12] != 0x6c || uuid->uuid[13] != 0x11 ||
         uuid->uuid[14] != 0x6f || uuid->uuid[15] != 0xa0) ||
        uuid->accepted != 0 ||
        uuid->iv != 1 ||
        uuid->context_id != 3) {
        printf("failure 3_3\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(4, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x86076109 ||
         *((uint16_t *)uuid->uuid + 2) != 0xb1ef ||
         *((uint16_t *)uuid->uuid + 3) != 0xb805 ||
         *((uint16_t *)uuid->uuid + 4) != 0xd3d5 ||
         uuid->uuid[10] != 0xfa || uuid->uuid[11] != 0x2d ||
         uuid->uuid[12] != 0x04 || uuid->uuid[13] != 0x6c ||
         uuid->uuid[14] != 0x90 || uuid->uuid[15] != 0x5e) ||
        uuid->accepted != 0 ||
        uuid->iv != 0 ||
        uuid->context_id != 4) {
        printf("failure 3_4\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(5, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xb401ed8f ||
         *((uint16_t *)uuid->uuid + 2) != 0x4bdc ||
         *((uint16_t *)uuid->uuid + 3) != 0x8655 ||
         *((uint16_t *)uuid->uuid + 4) != 0x99a7 ||
         uuid->uuid[10] != 0x6a || uuid->uuid[11] != 0x64 ||
         uuid->uuid[12] != 0x7f || uuid->uuid[13] != 0x32 ||
         uuid->uuid[14] != 0xe9 || uuid->uuid[15] != 0x2f) ||
        uuid->accepted != 0 ||
        uuid->iv != 3 ||
        uuid->context_id != 5) {
        printf("failure 3_5\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(6, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x53e7c5ec ||
         *((uint16_t *)uuid->uuid + 2) != 0x20ae ||
         *((uint16_t *)uuid->uuid + 3) != 0x34c3 ||
         *((uint16_t *)uuid->uuid + 4) != 0x9714 ||
         uuid->uuid[10] != 0x77 || uuid->uuid[11] != 0xf0 ||
         uuid->uuid[12] != 0xfe || uuid->uuid[13] != 0x68 ||
         uuid->uuid[14] != 0x05 || uuid->uuid[15] != 0xa8) ||
        uuid->accepted != 0 ||
        uuid->iv != 3 ||
        uuid->context_id != 6) {
        printf("failure 3_6\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(7, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xb50292d7 ||
         *((uint16_t *)uuid->uuid + 2) != 0xbdcd ||
         *((uint16_t *)uuid->uuid + 3) != 0x3535 ||
         *((uint16_t *)uuid->uuid + 4) != 0x1e94 ||
         uuid->uuid[10] != 0x88 || uuid->uuid[11] != 0x3d ||
         uuid->uuid[12] != 0x79 || uuid->uuid[13] != 0x63 ||
         uuid->uuid[14] != 0x2c || uuid->uuid[15] != 0x10) ||
        uuid->accepted != 0 ||
        uuid->iv != 0 ||
        uuid->context_id != 7) {
        printf("failure 3_7\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(8, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x7e6533b9 ||
         *((uint16_t *)uuid->uuid + 2) != 0xcdd9 ||
         *((uint16_t *)uuid->uuid + 3) != 0x1a03 ||
         *((uint16_t *)uuid->uuid + 4) != 0xa9b8 ||
         uuid->uuid[10] != 0xfc || uuid->uuid[11] != 0x12 ||
         uuid->uuid[12] != 0x9b || uuid->uuid[13] != 0x0d ||
         uuid->uuid[14] != 0xb9 || uuid->uuid[15] != 0x8b) ||
        uuid->accepted != 0 ||
        uuid->iv != 2 ||
        uuid->context_id != 8) {
        printf("failure 3_8\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(9, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x3d0ef1e7 ||
         *((uint16_t *)uuid->uuid + 2) != 0xb11a ||
         *((uint16_t *)uuid->uuid + 3) != 0xb04d ||
         *((uint16_t *)uuid->uuid + 4) != 0xaa43 ||
         uuid->uuid[10] != 0x65 || uuid->uuid[11] != 0x58 ||
         uuid->uuid[12] != 0x48 || uuid->uuid[13] != 0xad ||
         uuid->uuid[14] != 0xf2 || uuid->uuid[15] != 0xf4) ||
        uuid->accepted != 0 ||
        uuid->iv != 1 ||
        uuid->context_id != 9) {
        printf("failure 3_9\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(10, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xf73e2909 ||
         *((uint16_t *)uuid->uuid + 2) != 0x3245 ||
         *((uint16_t *)uuid->uuid + 3) != 0x10f5 ||
         *((uint16_t *)uuid->uuid + 4) != 0x2868 ||
         uuid->uuid[10] != 0xc7 || uuid->uuid[11] != 0x39 ||
         uuid->uuid[12] != 0xef || uuid->uuid[13] != 0x17 ||
         uuid->uuid[14] != 0x8a || uuid->uuid[15] != 0xfc) ||
        uuid->accepted != 0 ||
        uuid->iv != 3 ||
        uuid->context_id != 10) {
        printf("failure 3_10\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(11, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x19ccea46 ||
         *((uint16_t *)uuid->uuid + 2) != 0x0476 ||
         *((uint16_t *)uuid->uuid + 3) != 0x0cf4 ||
         *((uint16_t *)uuid->uuid + 4) != 0x9c2f ||
         uuid->uuid[10] != 0x17 || uuid->uuid[11] != 0xb2 ||
         uuid->uuid[12] != 0x72 || uuid->uuid[13] != 0xf4 ||
         uuid->uuid[14] != 0x84 || uuid->uuid[15] != 0x4f) ||
        uuid->accepted != 0 ||
        uuid->iv != 2 ||
        uuid->context_id != 11) {
        printf("failure 3_11\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(12, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x3919286a ||
         *((uint16_t *)uuid->uuid + 2) != 0xb10c ||
         *((uint16_t *)uuid->uuid + 3) != 0x11d0 ||
         *((uint16_t *)uuid->uuid + 4) != 0x9ba8 ||
         uuid->uuid[10] != 0x00 || uuid->uuid[11] != 0xc0 ||
         uuid->uuid[12] != 0x4f || uuid->uuid[13] != 0xd9 ||
         uuid->uuid[14] != 0x2e || uuid->uuid[15] != 0xf5) ||
        uuid->accepted != 1 ||
        uuid->iv != 0 ||
        uuid->context_id != 12) {
        printf("failure 3_12\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(13, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xbd65428d ||
         *((uint16_t *)uuid->uuid + 2) != 0x3257 ||
         *((uint16_t *)uuid->uuid + 3) != 0x064d ||
         *((uint16_t *)uuid->uuid + 4) != 0x101c ||
         uuid->uuid[10] != 0x01 || uuid->uuid[11] != 0x75 ||
         uuid->uuid[12] != 0x78 || uuid->uuid[13] != 0x9c ||
         uuid->uuid[14] != 0x8d || uuid->uuid[15] != 0xf5) ||
        uuid->accepted != 0 ||
        uuid->iv != 1 ||
        uuid->context_id != 13) {
        printf("failure 3_13\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(14, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x14a0d872 ||
         *((uint16_t *)uuid->uuid + 2) != 0xb2a6 ||
         *((uint16_t *)uuid->uuid + 3) != 0xaff7 ||
         *((uint16_t *)uuid->uuid + 4) != 0x5909 ||
         uuid->uuid[10] != 0x3b || uuid->uuid[11] != 0x93 ||
         uuid->uuid[12] != 0xcd || uuid->uuid[13] != 0x86 ||
         uuid->uuid[14] != 0xa5 || uuid->uuid[15] != 0xf4) ||
        uuid->accepted != 0 ||
        uuid->iv != 0 ||
        uuid->context_id != 14) {
        printf("failure 3_14\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(15, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x9dbd5165 ||
         *((uint16_t *)uuid->uuid + 2) != 0x1e21 ||
         *((uint16_t *)uuid->uuid + 3) != 0x7d2e ||
         *((uint16_t *)uuid->uuid + 4) != 0x5e2a ||
         uuid->uuid[10] != 0x71 || uuid->uuid[11] != 0x4b ||
         uuid->uuid[12] != 0x66 || uuid->uuid[13] != 0xe9 ||
         uuid->uuid[14] != 0xf0 || uuid->uuid[15] != 0xde) ||
        uuid->accepted != 0 ||
        uuid->iv != 3 ||
        uuid->context_id != 15) {
        printf("failure 3_15\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 0 ||
        tx->opnum != 9 ||
        tx->stub_len[0] != 127 ||
        tx->stub_len[1] != 0) {
        printf("failure 3_16\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x3919286a ||
         *((uint16_t *)tx->iface.uuid + 2) != 0xb10c ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x11d0 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0x9ba8 ||
         tx->iface.uuid[10] != 0x00 || tx->iface.uuid[11] != 0xc0 ||
         tx->iface.uuid[12] != 0x4f || tx->iface.uuid[13] != 0xd9 ||
         tx->iface.uuid[14] != 0x2e || tx->iface.uuid[15] != 0xf5)) {
        printf("failure 3_17\n");
        goto end;
    }

    for (i = 0; i < request2_len; i++) {
        r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER, request2 + i, 1);
        if (r != 0) {
            printf("failure parsing request2 - %lu\n", i);
            goto end;
        }
    }
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 0 ||
        state->connp[0].pfc_flags != 0x00 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 151 ||
        state->connp[0].call_id != 0 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[0].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 16 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure4\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xd68e6f7e ||
         *((uint16_t *)uuid->uuid + 2) != 0x97b0 ||
         *((uint16_t *)uuid->uuid + 3) != 0x71de ||
         *((uint16_t *)uuid->uuid + 4) != 0x8c44 ||
         uuid->uuid[10] != 0x78 || uuid->uuid[11] != 0x3c ||
         uuid->uuid[12] != 0x54 || uuid->uuid[13] != 0x60 ||
         uuid->uuid[14] != 0x97 || uuid->uuid[15] != 0xf1) ||
        uuid->accepted != 0 ||
        uuid->iv != 5 ||
        uuid->context_id != 0) {
        printf("failure 4_0\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(1, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xf17ec418 ||
         *((uint16_t *)uuid->uuid + 2) != 0x10d2 ||
         *((uint16_t *)uuid->uuid + 3) != 0x6b02 ||
         *((uint16_t *)uuid->uuid + 4) != 0x0e0c ||
         uuid->uuid[10] != 0xf6 || uuid->uuid[11] != 0x0b ||
         uuid->uuid[12] != 0x02 || uuid->uuid[13] != 0x95 ||
         uuid->uuid[14] != 0xae || uuid->uuid[15] != 0xa1) ||
        uuid->accepted != 0 ||
        uuid->iv != 3 ||
        uuid->context_id != 1) {
        printf("failure 4_1\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(2, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x313de470 ||
         *((uint16_t *)uuid->uuid + 2) != 0xf926 ||
         *((uint16_t *)uuid->uuid + 3) != 0xfe94 ||
         *((uint16_t *)uuid->uuid + 4) != 0x3c90 ||
         uuid->uuid[10] != 0x8b || uuid->uuid[11] != 0x6a ||
         uuid->uuid[12] != 0x51 || uuid->uuid[13] != 0xa9 ||
         uuid->uuid[14] != 0xbb || uuid->uuid[15] != 0x95) ||
        uuid->accepted != 0 ||
        uuid->iv != 1 ||
        uuid->context_id != 2) {
        printf("failure 4_2\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(3, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xd5f1ede8 ||
         *((uint16_t *)uuid->uuid + 2) != 0x82a6 ||
         *((uint16_t *)uuid->uuid + 3) != 0x76c5 ||
         *((uint16_t *)uuid->uuid + 4) != 0xce2d ||
         uuid->uuid[10] != 0xd8 || uuid->uuid[11] != 0x7c ||
         uuid->uuid[12] != 0x6c || uuid->uuid[13] != 0x11 ||
         uuid->uuid[14] != 0x6f || uuid->uuid[15] != 0xa0) ||
        uuid->accepted != 0 ||
        uuid->iv != 1 ||
        uuid->context_id != 3) {
        printf("failure 4_3\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(4, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x86076109 ||
         *((uint16_t *)uuid->uuid + 2) != 0xb1ef ||
         *((uint16_t *)uuid->uuid + 3) != 0xb805 ||
         *((uint16_t *)uuid->uuid + 4) != 0xd3d5 ||
         uuid->uuid[10] != 0xfa || uuid->uuid[11] != 0x2d ||
         uuid->uuid[12] != 0x04 || uuid->uuid[13] != 0x6c ||
         uuid->uuid[14] != 0x90 || uuid->uuid[15] != 0x5e) ||
        uuid->accepted != 0 ||
        uuid->iv != 0 ||
        uuid->context_id != 4) {
        printf("failure 4_4\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(5, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xb401ed8f ||
         *((uint16_t *)uuid->uuid + 2) != 0x4bdc ||
         *((uint16_t *)uuid->uuid + 3) != 0x8655 ||
         *((uint16_t *)uuid->uuid + 4) != 0x99a7 ||
         uuid->uuid[10] != 0x6a || uuid->uuid[11] != 0x64 ||
         uuid->uuid[12] != 0x7f || uuid->uuid[13] != 0x32 ||
         uuid->uuid[14] != 0xe9 || uuid->uuid[15] != 0x2f) ||
        uuid->accepted != 0 ||
        uuid->iv != 3 ||
        uuid->context_id != 5) {
        printf("failure 4_5\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(6, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x53e7c5ec ||
         *((uint16_t *)uuid->uuid + 2) != 0x20ae ||
         *((uint16_t *)uuid->uuid + 3) != 0x34c3 ||
         *((uint16_t *)uuid->uuid + 4) != 0x9714 ||
         uuid->uuid[10] != 0x77 || uuid->uuid[11] != 0xf0 ||
         uuid->uuid[12] != 0xfe || uuid->uuid[13] != 0x68 ||
         uuid->uuid[14] != 0x05 || uuid->uuid[15] != 0xa8) ||
        uuid->accepted != 0 ||
        uuid->iv != 3 ||
        uuid->context_id != 6) {
        printf("failure 4_6\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(7, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xb50292d7 ||
         *((uint16_t *)uuid->uuid + 2) != 0xbdcd ||
         *((uint16_t *)uuid->uuid + 3) != 0x3535 ||
         *((uint16_t *)uuid->uuid + 4) != 0x1e94 ||
         uuid->uuid[10] != 0x88 || uuid->uuid[11] != 0x3d ||
         uuid->uuid[12] != 0x79 || uuid->uuid[13] != 0x63 ||
         uuid->uuid[14] != 0x2c || uuid->uuid[15] != 0x10) ||
        uuid->accepted != 0 ||
        uuid->iv != 0 ||
        uuid->context_id != 7) {
        printf("failure 4_7\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(8, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x7e6533b9 ||
         *((uint16_t *)uuid->uuid + 2) != 0xcdd9 ||
         *((uint16_t *)uuid->uuid + 3) != 0x1a03 ||
         *((uint16_t *)uuid->uuid + 4) != 0xa9b8 ||
         uuid->uuid[10] != 0xfc || uuid->uuid[11] != 0x12 ||
         uuid->uuid[12] != 0x9b || uuid->uuid[13] != 0x0d ||
         uuid->uuid[14] != 0xb9 || uuid->uuid[15] != 0x8b) ||
        uuid->accepted != 0 ||
        uuid->iv != 2 ||
        uuid->context_id != 8) {
        printf("failure 4_8\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(9, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x3d0ef1e7 ||
         *((uint16_t *)uuid->uuid + 2) != 0xb11a ||
         *((uint16_t *)uuid->uuid + 3) != 0xb04d ||
         *((uint16_t *)uuid->uuid + 4) != 0xaa43 ||
         uuid->uuid[10] != 0x65 || uuid->uuid[11] != 0x58 ||
         uuid->uuid[12] != 0x48 || uuid->uuid[13] != 0xad ||
         uuid->uuid[14] != 0xf2 || uuid->uuid[15] != 0xf4) ||
        uuid->accepted != 0 ||
        uuid->iv != 1 ||
        uuid->context_id != 9) {
        printf("failure 4_9\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(10, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xf73e2909 ||
         *((uint16_t *)uuid->uuid + 2) != 0x3245 ||
         *((uint16_t *)uuid->uuid + 3) != 0x10f5 ||
         *((uint16_t *)uuid->uuid + 4) != 0x2868 ||
         uuid->uuid[10] != 0xc7 || uuid->uuid[11] != 0x39 ||
         uuid->uuid[12] != 0xef || uuid->uuid[13] != 0x17 ||
         uuid->uuid[14] != 0x8a || uuid->uuid[15] != 0xfc) ||
        uuid->accepted != 0 ||
        uuid->iv != 3 ||
        uuid->context_id != 10) {
        printf("failure 4_10\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(11, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x19ccea46 ||
         *((uint16_t *)uuid->uuid + 2) != 0x0476 ||
         *((uint16_t *)uuid->uuid + 3) != 0x0cf4 ||
         *((uint16_t *)uuid->uuid + 4) != 0x9c2f ||
         uuid->uuid[10] != 0x17 || uuid->uuid[11] != 0xb2 ||
         uuid->uuid[12] != 0x72 || uuid->uuid[13] != 0xf4 ||
         uuid->uuid[14] != 0x84 || uuid->uuid[15] != 0x4f) ||
        uuid->accepted != 0 ||
        uuid->iv != 2 ||
        uuid->context_id != 11) {
        printf("failure 4_11\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(12, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x3919286a ||
         *((uint16_t *)uuid->uuid + 2) != 0xb10c ||
         *((uint16_t *)uuid->uuid + 3) != 0x11d0 ||
         *((uint16_t *)uuid->uuid + 4) != 0x9ba8 ||
         uuid->uuid[10] != 0x00 || uuid->uuid[11] != 0xc0 ||
         uuid->uuid[12] != 0x4f || uuid->uuid[13] != 0xd9 ||
         uuid->uuid[14] != 0x2e || uuid->uuid[15] != 0xf5) ||
        uuid->accepted != 1 ||
        uuid->iv != 0 ||
        uuid->context_id != 12) {
        printf("failure 4_12\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(13, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0xbd65428d ||
         *((uint16_t *)uuid->uuid + 2) != 0x3257 ||
         *((uint16_t *)uuid->uuid + 3) != 0x064d ||
         *((uint16_t *)uuid->uuid + 4) != 0x101c ||
         uuid->uuid[10] != 0x01 || uuid->uuid[11] != 0x75 ||
         uuid->uuid[12] != 0x78 || uuid->uuid[13] != 0x9c ||
         uuid->uuid[14] != 0x8d || uuid->uuid[15] != 0xf5) ||
        uuid->accepted != 0 ||
        uuid->iv != 1 ||
        uuid->context_id != 13) {
        printf("failure 4_13\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(14, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x14a0d872 ||
         *((uint16_t *)uuid->uuid + 2) != 0xb2a6 ||
         *((uint16_t *)uuid->uuid + 3) != 0xaff7 ||
         *((uint16_t *)uuid->uuid + 4) != 0x5909 ||
         uuid->uuid[10] != 0x3b || uuid->uuid[11] != 0x93 ||
         uuid->uuid[12] != 0xcd || uuid->uuid[13] != 0x86 ||
         uuid->uuid[14] != 0xa5 || uuid->uuid[15] != 0xf4) ||
        uuid->accepted != 0 ||
        uuid->iv != 0 ||
        uuid->context_id != 14) {
        printf("failure 4_14\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(15, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x9dbd5165 ||
         *((uint16_t *)uuid->uuid + 2) != 0x1e21 ||
         *((uint16_t *)uuid->uuid + 3) != 0x7d2e ||
         *((uint16_t *)uuid->uuid + 4) != 0x5e2a ||
         uuid->uuid[10] != 0x71 || uuid->uuid[11] != 0x4b ||
         uuid->uuid[12] != 0x66 || uuid->uuid[13] != 0xe9 ||
         uuid->uuid[14] != 0xf0 || uuid->uuid[15] != 0xde) ||
        uuid->accepted != 0 ||
        uuid->iv != 3 ||
        uuid->context_id != 15) {
        printf("failure 4_15\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 0 ||
        tx->opnum != 9 ||
        tx->stub_len[0] != 254 ||
        tx->stub_len[1] != 0) {
        printf("failure 4_16\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x3919286a ||
         *((uint16_t *)tx->iface.uuid + 2) != 0xb10c ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x11d0 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0x9ba8 ||
         tx->iface.uuid[10] != 0x00 || tx->iface.uuid[11] != 0xc0 ||
         tx->iface.uuid[12] != 0x4f || tx->iface.uuid[13] != 0xd9 ||
         tx->iface.uuid[14] != 0x2e || tx->iface.uuid[15] != 0xf5)) {
        printf("failure 4_17\n");
        goto end;
    }

    result = 1;

end:
    StreamTcpFreeConfig(TRUE);
    FLOW_DESTROY(&f);
    return result;
}

/**
 * \test Same as Test09, but we send all app data as 1 byte frags(tcp frags).
 */
int DCERPCParserTest19(void)
{
    int result = 0;

    uint8_t bind[] = {
        0x05, 0x00, 0x0b, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x94, 0x04, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0xd0, 0x16, 0xd0, 0x16, 0x00, 0x00, 0x00, 0x00,
        0x1a, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00,
        0x7d, 0x2a, 0x4b, 0xd6, 0xdc, 0x2e, 0x35, 0x59,
        0x22, 0x45, 0xea, 0x5a, 0x7a, 0xd4, 0xf9, 0xe3,
        0x04, 0x00, 0x00, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x01, 0x00, 0xdc, 0x60, 0x84, 0x6c,
        0x45, 0x7f, 0xb2, 0xd2, 0x1d, 0x2a, 0x4a, 0x3e,
        0x1a, 0x44, 0xa4, 0x0b, 0x04, 0x00, 0x00, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x21, 0x39, 0xd4, 0x82, 0x3d, 0xb4, 0xda, 0x58,
        0x0e, 0x57, 0x89, 0xc9, 0x61, 0x24, 0x22, 0x04,
        0x02, 0x00, 0x00, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
        0x03, 0x00, 0x01, 0x00, 0xa9, 0x7a, 0x85, 0x47,
        0x0c, 0xef, 0xa1, 0xac, 0xaf, 0x09, 0x2f, 0x47,
        0x62, 0x02, 0xb4, 0xd2, 0x01, 0x00, 0x03, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00, 0x04, 0x00, 0x01, 0x00,
        0x9f, 0x4a, 0x48, 0x69, 0x3c, 0xa2, 0x3a, 0x8a,
        0xe6, 0x65, 0xb4, 0x83, 0xf7, 0xad, 0x91, 0xd4,
        0x04, 0x00, 0x00, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
        0x05, 0x00, 0x01, 0x00, 0x75, 0xcb, 0x02, 0xda,
        0x7a, 0xb0, 0x47, 0x22, 0xc5, 0xfd, 0x96, 0x7e,
        0xfb, 0x18, 0xee, 0xe5, 0x02, 0x00, 0x03, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00, 0x06, 0x00, 0x01, 0x00,
        0x1e, 0x12, 0x21, 0xae, 0xa0, 0x05, 0x2e, 0x47,
        0x2c, 0x23, 0xaa, 0x64, 0x91, 0x16, 0x04, 0xcf,
        0x03, 0x00, 0x00, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
        0x07, 0x00, 0x01, 0x00, 0xb7, 0x2e, 0xb4, 0x74,
        0xb5, 0x74, 0xab, 0x00, 0xe7, 0xd5, 0x55, 0x74,
        0xc5, 0x23, 0x36, 0xf0, 0x03, 0x00, 0x02, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00, 0x08, 0x00, 0x01, 0x00,
        0x4f, 0xe4, 0x65, 0x59, 0x74, 0xfa, 0x67, 0x04,
        0x89, 0x77, 0xca, 0x6b, 0x90, 0x8f, 0x9a, 0x73,
        0x06, 0x00, 0x00, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
        0x09, 0x00, 0x01, 0x00, 0xfc, 0x36, 0xe0, 0x68,
        0x31, 0x3c, 0xb2, 0x8b, 0x2e, 0x51, 0xc1, 0xff,
        0xc7, 0x93, 0xbf, 0x3b, 0x03, 0x00, 0x01, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00, 0x0a, 0x00, 0x01, 0x00,
        0x10, 0xd4, 0x24, 0xfe, 0x7c, 0xbc, 0xdc, 0x28,
        0x08, 0xac, 0xd9, 0x01, 0xdd, 0x65, 0x49, 0xfb,
        0x02, 0x00, 0x02, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
        0x0b, 0x00, 0x01, 0x00, 0xb1, 0x1f, 0x2d, 0xb7,
        0x23, 0xad, 0x03, 0x1d, 0xdb, 0x63, 0x0a, 0x9b,
        0xb2, 0x98, 0x90, 0x8c, 0x04, 0x00, 0x00, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00, 0x0c, 0x00, 0x01, 0x00,
        0xf2, 0x2b, 0x43, 0xe1, 0xdb, 0x89, 0x97, 0xc9,
        0x81, 0x66, 0xa7, 0x1c, 0x0d, 0x95, 0x66, 0x62,
        0x05, 0x00, 0x03, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
        0x0d, 0x00, 0x01, 0x00, 0x87, 0x23, 0x12, 0x5a,
        0xc3, 0x1a, 0xe8, 0xc8, 0x06, 0xc5, 0x01, 0x7b,
        0xd2, 0xdc, 0xa3, 0xde, 0x05, 0x00, 0x03, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00, 0x0e, 0x00, 0x01, 0x00,
        0x6a, 0x28, 0x19, 0x39, 0x0c, 0xb1, 0xd0, 0x11,
        0x9b, 0xa8, 0x00, 0xc0, 0x4f, 0xd9, 0x2e, 0xf5,
        0x00, 0x00, 0x00, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
        0x0f, 0x00, 0x01, 0x00, 0xe6, 0x0f, 0x30, 0xe0,
        0x02, 0xe7, 0xe5, 0xed, 0x78, 0x6d, 0x2d, 0xbe,
        0x04, 0x18, 0x4b, 0xde, 0x04, 0x00, 0x00, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00, 0x10, 0x00, 0x01, 0x00,
        0xa8, 0x6b, 0x8a, 0xd7, 0x87, 0x8f, 0x4a, 0x60,
        0xfb, 0x79, 0xbb, 0xcd, 0xdd, 0xdd, 0xdf, 0xfe,
        0x03, 0x00, 0x01, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
        0x11, 0x00, 0x01, 0x00, 0xbc, 0x4f, 0x78, 0x2d,
        0xad, 0xc3, 0xfd, 0x7b, 0x37, 0xde, 0xd7, 0xaa,
        0xec, 0xec, 0x5e, 0xcb, 0x03, 0x00, 0x00, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00, 0x12, 0x00, 0x01, 0x00,
        0x79, 0xcc, 0x10, 0x72, 0x28, 0xe7, 0x59, 0x3e,
        0xcf, 0x14, 0xf4, 0xc9, 0x80, 0xa0, 0xda, 0x70,
        0x02, 0x00, 0x00, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
        0x13, 0x00, 0x01, 0x00, 0x7b, 0xed, 0x22, 0x89,
        0x47, 0x6a, 0x8a, 0x8d, 0x89, 0xd3, 0x12, 0x8e,
        0xf2, 0x06, 0x36, 0xda, 0x05, 0x00, 0x00, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00, 0x14, 0x00, 0x01, 0x00,
        0xf1, 0xaa, 0xab, 0x3b, 0xae, 0x04, 0xa8, 0xb4,
        0x96, 0x71, 0xba, 0xf8, 0xc6, 0x86, 0x09, 0xed,
        0x06, 0x00, 0x02, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
        0x15, 0x00, 0x01, 0x00, 0x0c, 0x6e, 0xc6, 0x1f,
        0x6f, 0xdf, 0xa0, 0x92, 0x7d, 0x29, 0xd3, 0x45,
        0x12, 0x96, 0x97, 0xc6, 0x02, 0x00, 0x01, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00, 0x16, 0x00, 0x01, 0x00,
        0x7b, 0x48, 0x71, 0xba, 0x08, 0xda, 0x91, 0xf5,
        0x70, 0xd3, 0x6e, 0xc6, 0xb4, 0x71, 0xd5, 0x43,
        0x01, 0x00, 0x00, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
        0x17, 0x00, 0x01, 0x00, 0xf1, 0x32, 0xff, 0xfe,
        0xbe, 0xdc, 0xf9, 0x54, 0xf8, 0xe3, 0x6e, 0x61,
        0xcc, 0xee, 0x74, 0x4e, 0x04, 0x00, 0x02, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00, 0x18, 0x00, 0x01, 0x00,
        0x1a, 0xdc, 0xdf, 0xea, 0x1a, 0xa4, 0xa4, 0xbe,
        0x85, 0x9f, 0xdc, 0x2b, 0xb2, 0xc7, 0xc3, 0xc8,
        0x02, 0x00, 0x02, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
        0x19, 0x00, 0x01, 0x00, 0x97, 0xfd, 0x6a, 0xeb,
        0xaf, 0xf5, 0x10, 0x8d, 0xa4, 0xa7, 0x3e, 0xf2,
        0x52, 0x62, 0x90, 0x83, 0x01, 0x00, 0x03, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00,
    };
    uint32_t bind_len = sizeof(bind);

    uint8_t bindack[] = {
        0x05, 0x00, 0x0c, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x9c, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0xb8, 0x10, 0xb8, 0x10, 0xd3, 0x47, 0x00, 0x00,
        0x0c, 0x00, 0x5c, 0x50, 0x49, 0x50, 0x45, 0x5c,
        0x6c, 0x73, 0x61, 0x73, 0x73, 0x00, 0x35, 0x59,
        0x1a, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x04, 0x5d, 0x88, 0x8a, 0xeb, 0x1c, 0xc9, 0x11,
        0x9f, 0xe8, 0x08, 0x00, 0x2b, 0x10, 0x48, 0x60,
        0x02, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00,
    };
    uint32_t bindack_len = sizeof(bindack);

    uint8_t request1[] = {
        0x05, 0x00, 0x00, 0x01, 0x10, 0x00, 0x00, 0x00,
        0x19, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x0e, 0x00, 0x09, 0x00,
        0xad,
    };
    uint32_t request1_len = sizeof(request1);

    uint8_t request2[] = {
        0x05, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00,
        0x19, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x0e, 0x00, 0x09, 0x00,
        0x0d,
    };
    uint32_t request2_len = sizeof(request2);

    uint8_t request3[] = {
        0x05, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00,
        0x19, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x0e, 0x00, 0x09, 0x00,
        0x00,
    };
    uint32_t request3_len = sizeof(request3);

    uint8_t request4[] = {
        0x05, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00,
        0x19, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x0e, 0x00, 0x09, 0x00,
        0x00,
    };
    uint32_t request4_len = sizeof(request4);

    uint8_t request5[] = {
        0x05, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00,
        0x19, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x0e, 0x00, 0x09, 0x00,
        0x00,
    };
    uint32_t request5_len = sizeof(request5);

    uint8_t request6[] = {
        0x05, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00,
        0x19, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x0e, 0x00, 0x09, 0x00,
        0x00,
    };
    uint32_t request6_len = sizeof(request6);

    uint8_t request7[] = {
        0x05, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00,
        0x19, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x0e, 0x00, 0x09, 0x00,
        0x00,
    };
    uint32_t request7_len = sizeof(request7);

    uint8_t request8[] = {
        0x05, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00,
        0x19, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x0e, 0x00, 0x09, 0x00,
        0x00,
    };
    uint32_t request8_len = sizeof(request8);

    uint8_t request9[] = {
        0x05, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00,
        0x19, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x0e, 0x00, 0x09, 0x00,
        0xad,
    };
    uint32_t request9_len = sizeof(request9);

    uint8_t request10[] = {
        0x05, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00,
        0x19, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x0e, 0x00, 0x09, 0x00,
        0x0d,
    };
    uint32_t request10_len = sizeof(request10);

    DCERPCState *state;
    Flow f;
    TcpSession ssn;
    int r;
    DCERPCTx *tx = NULL;
    size_t i = 0;

    memset(&f, 0, sizeof(f));
    memset(&ssn, 0, sizeof(ssn));
    FLOW_INITIALIZE(&f);
    f.protoctx = (void *)&ssn;

    StreamTcpInitConfig(TRUE);

    for (i = 0; i < bind_len; i++) {
        r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER | STREAM_START, bind + i, 1);
        if (r != 0) {
            printf("failure parsing bind - %lu\n", i);
            goto end;
        }
    }
    state = f.alstate;
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 11 ||
        state->connp[0].pfc_flags != 0x03 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 1172 ||
        state->connp[0].call_id != 0 ||
        state->connp[0].assoc_group_id != 0 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[0].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 26 ||
        DCERPCListSize(&state->transactions) != 0) {
        printf("failure1\n");
        goto end;
    }

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOCLIENT, bindack, bindack_len);
    if (r != 0) {
        printf("failure parsing bindack\n");
        goto end;
    }
    if (state->connp[1].rpc_vers_minor != 0 ||
        state->connp[1].ptype != 12 ||
        state->connp[1].pfc_flags != 0x03 ||
        state->connp[1].auth_length != 0 ||
        state->connp[1].frag_length != 668 ||
        state->connp[1].call_id != 0 ||
        state->connp[1].assoc_group_id != 0x000047d3 ||
        state->connp[1].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 26 ||
        DCERPCListSize(&state->transactions) != 0) {
        printf("failure2\n");
        goto end;
    }

    for (i = 0; i < request1_len; i++) {
        r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER, request1 + i, 1);
        if (r != 0) {
            printf("failure parsing request1 - %lu\n", i);
            goto end;
        }
    }
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 0 ||
        state->connp[0].pfc_flags != 0x01 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 25 ||
        state->connp[0].call_id != 0 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 26 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure3\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 0 ||
        tx->opnum != 9 ||
        tx->stub_len[0] != 1 ||
        tx->stub_len[1] != 0) {
        printf("failure 3_1\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x3919286a ||
         *((uint16_t *)tx->iface.uuid + 2) != 0xb10c ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x11d0 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0x9ba8 ||
         tx->iface.uuid[10] != 0x00 || tx->iface.uuid[11] != 0xc0 ||
         tx->iface.uuid[12] != 0x4f || tx->iface.uuid[13] != 0xd9 ||
         tx->iface.uuid[14] != 0x2e || tx->iface.uuid[15] != 0xf5)) {
        printf("failure 3_2\n");
        goto end;
    }

    for (i = 0; i < request2_len; i++) {
        r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER, request2 + i, 1);
        if (r != 0) {
            printf("failure parsing request2 - %lu\n", i);
            goto end;
        }
    }
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 0 ||
        state->connp[0].pfc_flags != 0x00 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 25 ||
        state->connp[0].call_id != 0 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 26 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure4\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 0 ||
        tx->opnum != 9 ||
        tx->stub_len[0] != 2 ||
        tx->stub_len[1] != 0) {
        printf("failure 4_1\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x3919286a ||
         *((uint16_t *)tx->iface.uuid + 2) != 0xb10c ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x11d0 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0x9ba8 ||
         tx->iface.uuid[10] != 0x00 || tx->iface.uuid[11] != 0xc0 ||
         tx->iface.uuid[12] != 0x4f || tx->iface.uuid[13] != 0xd9 ||
         tx->iface.uuid[14] != 0x2e || tx->iface.uuid[15] != 0xf5)) {
        printf("failure 4_2\n");
        goto end;
    }

    for (i = 0; i < request3_len; i++) {
        r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER, request3 + i, 1);
        if (r != 0) {
            printf("failure parsing request3 - %lu\n", i);
            goto end;
        }
    }
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 0 ||
        state->connp[0].pfc_flags != 0x00 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 25 ||
        state->connp[0].call_id != 0 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 26 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure5\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 0 ||
        tx->opnum != 9 ||
        tx->stub_len[0] != 3 ||
        tx->stub_len[1] != 0) {
        printf("failure 5_1\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x3919286a ||
         *((uint16_t *)tx->iface.uuid + 2) != 0xb10c ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x11d0 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0x9ba8 ||
         tx->iface.uuid[10] != 0x00 || tx->iface.uuid[11] != 0xc0 ||
         tx->iface.uuid[12] != 0x4f || tx->iface.uuid[13] != 0xd9 ||
         tx->iface.uuid[14] != 0x2e || tx->iface.uuid[15] != 0xf5)) {
        printf("failure 5_2\n");
        goto end;
    }

    for (i = 0; i < request4_len; i++) {
        r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER, request4 + i, 1);
        if (r != 0) {
            printf("failure parsing request4 - %lu\n", i);
            goto end;
        }
    }
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 0 ||
        state->connp[0].pfc_flags != 0x00 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 25 ||
        state->connp[0].call_id != 0 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 26 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure6\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 0 ||
        tx->opnum != 9 ||
        tx->stub_len[0] != 4 ||
        tx->stub_len[1] != 0) {
        printf("failure 6_1\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x3919286a ||
         *((uint16_t *)tx->iface.uuid + 2) != 0xb10c ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x11d0 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0x9ba8 ||
         tx->iface.uuid[10] != 0x00 || tx->iface.uuid[11] != 0xc0 ||
         tx->iface.uuid[12] != 0x4f || tx->iface.uuid[13] != 0xd9 ||
         tx->iface.uuid[14] != 0x2e || tx->iface.uuid[15] != 0xf5)) {
        printf("failure 6_2\n");
        goto end;
    }

    for (i = 0; i < request5_len; i++) {
        r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER, request5 + i, 1);
        if (r != 0) {
            printf("failure parsing request5 - %lu\n", i);
            goto end;
        }
    }
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 0 ||
        state->connp[0].pfc_flags != 0x00 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 25 ||
        state->connp[0].call_id != 0 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 26 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure7\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 0 ||
        tx->opnum != 9 ||
        tx->stub_len[0] != 5 ||
        tx->stub_len[1] != 0) {
        printf("failure 7_1\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x3919286a ||
         *((uint16_t *)tx->iface.uuid + 2) != 0xb10c ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x11d0 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0x9ba8 ||
         tx->iface.uuid[10] != 0x00 || tx->iface.uuid[11] != 0xc0 ||
         tx->iface.uuid[12] != 0x4f || tx->iface.uuid[13] != 0xd9 ||
         tx->iface.uuid[14] != 0x2e || tx->iface.uuid[15] != 0xf5)) {
        printf("failure 7_2\n");
        goto end;
    }

    for (i = 0; i < request6_len; i++) {
        r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER, request6 + i, 1);
        if (r != 0) {
            printf("failure parsing request6 - %lu\n", i);
            goto end;
        }
    }
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 0 ||
        state->connp[0].pfc_flags != 0x00 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 25 ||
        state->connp[0].call_id != 0 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 26 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure8\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 0 ||
        tx->opnum != 9 ||
        tx->stub_len[0] != 6 ||
        tx->stub_len[1] != 0) {
        printf("failure 8_1\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x3919286a ||
         *((uint16_t *)tx->iface.uuid + 2) != 0xb10c ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x11d0 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0x9ba8 ||
         tx->iface.uuid[10] != 0x00 || tx->iface.uuid[11] != 0xc0 ||
         tx->iface.uuid[12] != 0x4f || tx->iface.uuid[13] != 0xd9 ||
         tx->iface.uuid[14] != 0x2e || tx->iface.uuid[15] != 0xf5)) {
        printf("failure 8_2\n");
        goto end;
    }

    for (i = 0; i < request7_len; i++) {
        r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER, request7 + i, 1);
        if (r != 0) {
            printf("failure parsing request7 - %lu\n", i);
            goto end;
        }
    }
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 0 ||
        state->connp[0].pfc_flags != 0x00 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 25 ||
        state->connp[0].call_id != 0 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 26 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure9\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 0 ||
        tx->opnum != 9 ||
        tx->stub_len[0] != 7 ||
        tx->stub_len[1] != 0) {
        printf("failure 9_1\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x3919286a ||
         *((uint16_t *)tx->iface.uuid + 2) != 0xb10c ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x11d0 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0x9ba8 ||
         tx->iface.uuid[10] != 0x00 || tx->iface.uuid[11] != 0xc0 ||
         tx->iface.uuid[12] != 0x4f || tx->iface.uuid[13] != 0xd9 ||
         tx->iface.uuid[14] != 0x2e || tx->iface.uuid[15] != 0xf5)) {
        printf("failure 9_2\n");
        goto end;
    }

    for (i = 0; i < request8_len; i++) {
        r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER, request8 + i, 1);
        if (r != 0) {
            printf("failure parsing request8 - %lu\n", i);
            goto end;
        }
    }
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 0 ||
        state->connp[0].pfc_flags != 0x00 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 25 ||
        state->connp[0].call_id != 0 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 26 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure10\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 0 ||
        tx->opnum != 9 ||
        tx->stub_len[0] != 8 ||
        tx->stub_len[1] != 0) {
        printf("failure 10_1\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x3919286a ||
         *((uint16_t *)tx->iface.uuid + 2) != 0xb10c ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x11d0 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0x9ba8 ||
         tx->iface.uuid[10] != 0x00 || tx->iface.uuid[11] != 0xc0 ||
         tx->iface.uuid[12] != 0x4f || tx->iface.uuid[13] != 0xd9 ||
         tx->iface.uuid[14] != 0x2e || tx->iface.uuid[15] != 0xf5)) {
        printf("failure 10_2\n");
        goto end;
    }

    for (i = 0; i < request9_len; i++) {
        r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER, request9 + i, 1);
        if (r != 0) {
            printf("failure parsing request9 - %lu\n", i);
            goto end;
        }
    }
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 0 ||
        state->connp[0].pfc_flags != 0x00 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 25 ||
        state->connp[0].call_id != 0 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 26 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure11\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 0 ||
        tx->opnum != 9 ||
        tx->stub_len[0] != 9 ||
        tx->stub_len[1] != 0) {
        printf("failure 11_1\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x3919286a ||
         *((uint16_t *)tx->iface.uuid + 2) != 0xb10c ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x11d0 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0x9ba8 ||
         tx->iface.uuid[10] != 0x00 || tx->iface.uuid[11] != 0xc0 ||
         tx->iface.uuid[12] != 0x4f || tx->iface.uuid[13] != 0xd9 ||
         tx->iface.uuid[14] != 0x2e || tx->iface.uuid[15] != 0xf5)) {
        printf("failure 11_2\n");
        goto end;
    }

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER, request10, request10_len);
    if (r != 0) {
        printf("failure parsing request10\n");
        goto end;
    }
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 0 ||
        state->connp[0].pfc_flags != 0x00 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 25 ||
        state->connp[0].call_id != 0 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[1].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 26 ||
        DCERPCListSize(&state->transactions) != 1) {
        printf("failure12\n");
        goto end;
    }
    tx = DCERPCListGetAtIndex(0, &state->transactions);
    if (tx == NULL ||
        tx->call_id != 0 ||
        tx->opnum != 9 ||
        tx->stub_len[0] != 10 ||
        tx->stub_len[1] != 0) {
        printf("failure 12_1\n");
        goto end;
    }
    if ((*((uint32_t *)tx->iface.uuid) != 0x3919286a ||
         *((uint16_t *)tx->iface.uuid + 2) != 0xb10c ||
         *((uint16_t *)tx->iface.uuid + 3) != 0x11d0 ||
         *((uint16_t *)tx->iface.uuid + 4) != 0x9ba8 ||
         tx->iface.uuid[10] != 0x00 || tx->iface.uuid[11] != 0xc0 ||
         tx->iface.uuid[12] != 0x4f || tx->iface.uuid[13] != 0xd9 ||
         tx->iface.uuid[14] != 0x2e || tx->iface.uuid[15] != 0xf5)) {
        printf("failure 12_2\n");
        goto end;
    }

    result = 1;

end:
    StreamTcpFreeConfig(TRUE);
    FLOW_DESTROY(&f);
    return result;
}

/**
 * \test 2 binds with minor version 0.
 *       The first bind is picked from private_3314-0-false-1.pcap.
 *       The second bind is the same as the first with the uuid modified.
 *
 *       The pfc flags for both the pdus is 0.
 */
int DCERPCParserTest20(void)
{
    int result = 0;

    uint8_t bind1[] = {
        0x05, 0x00, 0x0b, 0x00, 0x10, 0x00, 0x00, 0x00,
        0x48, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x30, 0x16, 0x30, 0x16, 0x00, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00,
        0xc8, 0x4f, 0x32, 0x4b, 0x70, 0x16, 0xd3, 0x01,
        0x12, 0x78, 0x5a, 0x47, 0xbf, 0x6e, 0xe1, 0x88,
        0x03, 0x00, 0x00, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
    };
    uint32_t bind1_len = sizeof(bind1);

    uint8_t bind2[] = {
        0x05, 0x00, 0x0b, 0x00, 0x10, 0x00, 0x00, 0x00,
        0x48, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x30, 0x16, 0x30, 0x16, 0x00, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00,
        0x04, 0x03, 0x02, 0x01, 0x06, 0x05, 0x08, 0x07,
        0x09, 0x0a, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06,
        0x03, 0x00, 0x00, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
    };
    uint32_t bind2_len = sizeof(bind2);

    DCERPCState *state;
    Flow f;
    TcpSession ssn;
    int r;
    UUID *uuid = NULL;

    memset(&f, 0, sizeof(f));
    memset(&ssn, 0, sizeof(ssn));
    FLOW_INITIALIZE(&f);
    f.protoctx = (void *)&ssn;

    StreamTcpInitConfig(TRUE);

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER | STREAM_START, bind1, bind1_len);
    if (r != 0) {
        printf("failure parsing bind1\n");
        goto end;
    }
    state = f.alstate;
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 11 ||
        state->connp[0].pfc_flags != 0x00 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 72 ||
        state->connp[0].call_id != 1 ||
        state->connp[0].assoc_group_id != 0 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[0].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 0) {
        printf("failure1\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x4b324fc8 ||
         *((uint16_t *)uuid->uuid + 2) != 0x1670 ||
         *((uint16_t *)uuid->uuid + 3) != 0x01d3 ||
         *((uint16_t *)uuid->uuid + 4) != 0x1278 ||
         uuid->uuid[10] != 0x5a || uuid->uuid[11] != 0x47 ||
         uuid->uuid[12] != 0xbf || uuid->uuid[13] != 0x6e ||
         uuid->uuid[14] != 0xe1 || uuid->uuid[15] != 0x88) ||
        uuid->accepted != 0 ||
        uuid->iv != 3 ||
        uuid->context_id != 0) {
        printf("failure 1_1\n");
        goto end;
    }

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER | STREAM_START, bind2, bind2_len);
    if (r != 0) {
        printf("failure parsing bind2\n");
        goto end;
    }
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 11 ||
        state->connp[0].pfc_flags != 0x00 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 72 ||
        state->connp[0].call_id != 1 ||
        state->connp[0].assoc_group_id != 0 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[0].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 0) {
        printf("failure2\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x01020304 ||
         *((uint16_t *)uuid->uuid + 2) != 0x0506 ||
         *((uint16_t *)uuid->uuid + 3) != 0x0708 ||
         *((uint16_t *)uuid->uuid + 4) != 0x090a ||
         uuid->uuid[10] != 0x01 || uuid->uuid[11] != 0x02 ||
         uuid->uuid[12] != 0x03 || uuid->uuid[13] != 0x04 ||
         uuid->uuid[14] != 0x05 || uuid->uuid[15] != 0x06) ||
        uuid->accepted != 0 ||
        uuid->iv != 3 ||
        uuid->context_id != 0) {
        printf("failure 2_1\n");
        goto end;
    }

    result = 1;

end:
    StreamTcpFreeConfig(TRUE);
    FLOW_DESTROY(&f);
    return result;
}

/**
 * \test 2 binds with the first one having minor version 0 and second having 1.
 *       The first bind is picked from private_3314-0-false-1.pcap.
 *       The second bind is the crafted.
 *
 *       The pfc flags for the first bind is 0 and for the second is 0x03.
 */
int DCERPCParserTest21(void)
{
    int result = 0;

    uint8_t bind1[] = {
        0x05, 0x00, 0x0b, 0x00, 0x10, 0x00, 0x00, 0x00,
        0x48, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x30, 0x16, 0x30, 0x16, 0x00, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00,
        0xc8, 0x4f, 0x32, 0x4b, 0x70, 0x16, 0xd3, 0x01,
        0x12, 0x78, 0x5a, 0x47, 0xbf, 0x6e, 0xe1, 0x88,
        0x03, 0x00, 0x00, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
    };
    uint32_t bind1_len = sizeof(bind1);

    uint8_t bind2[] = {
        0x05, 0x00, 0x0b, 0x03, 0x10, 0x00, 0x00, 0x00,
        0x48, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x30, 0x16, 0x30, 0x16, 0x00, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00,
        0x04, 0x03, 0x02, 0x01, 0x06, 0x05, 0x08, 0x07,
        0x09, 0x0a, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06,
        0x03, 0x00, 0x00, 0x00, 0x04, 0x5d, 0x88, 0x8a,
        0xeb, 0x1c, 0xc9, 0x11, 0x9f, 0xe8, 0x08, 0x00,
        0x2b, 0x10, 0x48, 0x60, 0x02, 0x00, 0x00, 0x00,
    };
    uint32_t bind2_len = sizeof(bind2);

    DCERPCState *state;
    Flow f;
    TcpSession ssn;
    int r;
    UUID *uuid = NULL;

    memset(&f, 0, sizeof(f));
    memset(&ssn, 0, sizeof(ssn));
    FLOW_INITIALIZE(&f);
    f.protoctx = (void *)&ssn;

    StreamTcpInitConfig(TRUE);

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER | STREAM_START, bind1, bind1_len);
    if (r != 0) {
        printf("failure parsing bind1\n");
        goto end;
    }
    state = f.alstate;
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 11 ||
        state->connp[0].pfc_flags != 0x00 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 72 ||
        state->connp[0].call_id != 1 ||
        state->connp[0].assoc_group_id != 0 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[0].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 0) {
        printf("failure1\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x4b324fc8 ||
         *((uint16_t *)uuid->uuid + 2) != 0x1670 ||
         *((uint16_t *)uuid->uuid + 3) != 0x01d3 ||
         *((uint16_t *)uuid->uuid + 4) != 0x1278 ||
         uuid->uuid[10] != 0x5a || uuid->uuid[11] != 0x47 ||
         uuid->uuid[12] != 0xbf || uuid->uuid[13] != 0x6e ||
         uuid->uuid[14] != 0xe1 || uuid->uuid[15] != 0x88) ||
        uuid->accepted != 0 ||
        uuid->iv != 3 ||
        uuid->context_id != 0) {
        printf("failure 1_1\n");
        goto end;
    }

    r = AppLayerParse(NULL, &f, ALPROTO_DCERPC, STREAM_TOSERVER | STREAM_START, bind2, bind2_len);
    if (r != 0) {
        printf("failure parsing bind2\n");
        goto end;
    }
    if (state->connp[0].rpc_vers_minor != 0 ||
        state->connp[0].ptype != 11 ||
        state->connp[0].pfc_flags != 0x03 ||
        state->connp[0].auth_length != 0 ||
        state->connp[0].frag_length != 72 ||
        state->connp[0].call_id != 1 ||
        state->connp[0].assoc_group_id != 0 ||
        state->connp[0].CurrState != DCERPCStatePDUStart ||
        state->connp[0].pdu_bytes_processed != 0 ||
        DCERPCListSize(&state->uuids) != 1 ||
        DCERPCListSize(&state->transactions) != 0) {
        printf("failure2\n");
        goto end;
    }
    uuid = DCERPCListGetAtIndex(0, &state->uuids);
    if ((*((uint32_t *)uuid->uuid) != 0x01020304 ||
         *((uint16_t *)uuid->uuid + 2) != 0x0506 ||
         *((uint16_t *)uuid->uuid + 3) != 0x0708 ||
         *((uint16_t *)uuid->uuid + 4) != 0x090a ||
         uuid->uuid[10] != 0x01 || uuid->uuid[11] != 0x02 ||
         uuid->uuid[12] != 0x03 || uuid->uuid[13] != 0x04 ||
         uuid->uuid[14] != 0x05 || uuid->uuid[15] != 0x06) ||
        uuid->accepted != 0 ||
        uuid->iv != 3 ||
        uuid->context_id != 0) {
        printf("failure 2_1\n");
        goto end;
    }

    result = 1;

end:
    StreamTcpFreeConfig(TRUE);
    FLOW_DESTROY(&f);
    return result;
}

#endif /* UNITTESTS */

void DCERPCParserRegisterTests(void)
{
#ifdef UNITTESTS
    UtRegisterTest("DCERPCParserTest01", DCERPCParserTest01, 1);
    UtRegisterTest("DCERPCParserTest02", DCERPCParserTest02, 1);
    UtRegisterTest("DCERPCParserTest03", DCERPCParserTest03, 1);
    UtRegisterTest("DCERPCParserTest04", DCERPCParserTest04, 1);
    UtRegisterTest("DCERPCParserTest05", DCERPCParserTest05, 1);
    UtRegisterTest("DCERPCParserTest06", DCERPCParserTest06, 1);
    UtRegisterTest("DCERPCParserTest07", DCERPCParserTest07, 1);
    UtRegisterTest("DCERPCParserTest08", DCERPCParserTest08, 1);
    UtRegisterTest("DCERPCParserTest09", DCERPCParserTest09, 1);
    UtRegisterTest("DCERPCParserTest10", DCERPCParserTest10, 1);
    UtRegisterTest("DCERPCParserTest11", DCERPCParserTest11, 1);
    UtRegisterTest("DCERPCParserTest12", DCERPCParserTest12, 1);
    UtRegisterTest("DCERPCParserTest13", DCERPCParserTest13, 1);
    UtRegisterTest("DCERPCParserTest14", DCERPCParserTest14, 1);
    UtRegisterTest("DCERPCParserTest15", DCERPCParserTest15, 1);
    UtRegisterTest("DCERPCParserTest16", DCERPCParserTest16, 1);
    UtRegisterTest("DCERPCParserTest17", DCERPCParserTest17, 1);
    UtRegisterTest("DCERPCParserTest18", DCERPCParserTest18, 1);
    UtRegisterTest("DCERPCParserTest19", DCERPCParserTest19, 1);
    UtRegisterTest("DCERPCParserTest20", DCERPCParserTest20, 1);
    UtRegisterTest("DCERPCParserTest21", DCERPCParserTest21, 1);
#endif

    return;
}
